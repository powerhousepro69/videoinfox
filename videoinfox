#!/bin/bash

#  file : videoinfox							         
#  github and reddit: powerhousepro69
#  GNU General Public License v2.0
#  reddit:  /videoinfox

ver="Videoinfox v5.5.19"  # Version Number: no blinking dot
der=$(echo -e "Videoinfox v5\033[5m.\033m\033[0m\033[5m\033[5m\033[0m5.19")  # Version Number: with blinking dot
vn="v5.5.19" #V!  update help files on update

##################################################################################################################################################
#  DEPENDENCIES REQUIRED:  #######################################################################################################################
################################################################################################################################################## 

# - xclip needed for autopaste feature.  xclip only works with Xsession  
# - ffmpeg is used to extrat Duration in <hrs:min:sec> format
# - ffprobe is used to extract Codec, Resolution and Duration in floating seconds format (x.xxxxxx)
# - ffplay is used to play videos (mp4, webm, mkxv, avi, divx).                                          
# - bc needed to do floating point math.  
# - notifysend needed to display gui notifications.
 
##########  Videoinfox runs a dependency check at startup. If any dependencies are Not Found, the script will exit. 
##########  Missing dependencies will be displayed.

# YT-DLP is not on the dependeny list becuase Videoinfox will dowload it to:   ~/.config/videoinfox   All calls to yt-dlp are pointed to:   
# ~/.config/videoinfox/yt-dlp   There is an update option in:   <Set>  Settings to update yt-dlp   (just the copy in ~/.config/videoinfox)
# I didn't want to overwrite anyones copy of:   /user/local/bin/yt-dlp     Also, I wanted to make sure all new Videoinfox script installs
# included the most recent version of Yt-dlp

##################################################################################################################################################
#  START COMMAND LINE OPTIONS  ###################################################################################################################
##################################################################################################################################################

# Note: Command Line Options won't run except for -v  until First Run (setup):  videoinfox  with no command line options.

#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -v     DISPLAY VERSION NUMBER THEN EXIT  
#-------------------------------------------------------------------------------------------------------------------------------------------------

if [ "$1" = "-v" ]
  then
      echo "$ver"
      exit

  else
      :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -l     ADD CLIPBOARD CONTENT ON THE FLY TO:   USER SET LIST   THEN EXIT
#-------------------------------------------------------------------------------------------------------------------------------------------------

# Create a gui keyboard shortcut for:   videoinfox -l
# It isn't necessary to have the Videoinfox running while using this feature.
# Build your set user list on the fly without leaving the gui
# COPY THE URL TO THE BROWSER. THEN USE YOUR SHORTCUT TO WRITE URL TO THE USER SET LIST. Rinse and repeat to keep adding to the list. 


if [ "$1" = "-l" ]
   then
       pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
       grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character
       direxist="$HOME/.config/videoinfox/tmp"

       if [ -d "$direxist" ]  #  if directoty exists goto  <then>
         then
             read -r grabuserlist < ~/.config/videoinfox/videoinfox.set-user-list

                 if [ -f "$grabuserlist" ]  # if file exists then 
                   then                      
                          
                       if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
                         then
                             pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                             echo "$pasteclip" >> "$grabuserlist"  # write url to the user set list             
                             notify-send "Videoinfox Message: ADDED LINK TO USER LIST" "$grabuserlist"
                             cat -n "$grabuserlist" | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfox.ulistfly.tmp  # REMOVE DUPLICATES
                             sed -i '/^$/d' ~/.config/videoinfox/videoinfox.ulistfly.tmp  # remove any blank lines in the list
                             sed -i '/http/!d' ~/.config/videoinfox/videoinfox.ulistfly.tmp  # remove all lines not starting with  http
                             mv ~/.config/videoinfox/videoinfox.ulistfly.tmp "$grabuserlist"
                             echo "" | xclip -sel clip  # clearing out the clipboard
                             exit

                         else
                             notify-send "Videoinfox -l Error . . ." "Clipboard content didn't start wit http."
                             exit
                       fi
                   else
                       notify-send "Videoinfox -l Error . . ." "No user list has been set for this feature.  Set User List in Videoinfox first."
                       exit
                 fi
   else
       echo
       echo "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
       echo
       notify-send "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
       exit
    fi       

   else
       :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -a     ADD CLIPBOARD CONTENT  ON THE FLY TO:   DEFAULT LIST   THEN EXIT
#-------------------------------------------------------------------------------------------------------------------------------------------------

# Create a gui keyboard shortcut for:   videoinfox -a
# It isn't necessary to have the Videoinfox running while using this feature.
# Build your default list on the fly without leaving the gui
# COPY THE URL TO THE BROWSER. THEN USE YOUR SHORTCUT TO WRITE URL TO THE DEFAULT DOWNLOAD LIST. Rinse and repeat to keep adding to the Default List. 

if [ "$1" = "-a" ]
   then
       pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
       grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character
       direxist="$HOME/.config/videoinfox/tmp"

if [ -d "$direxist" ]  #  if directoty exists goto  <then>
then
    if [ -f ~/.config/videoinfox/videoinfox-dl-Default ]  # if file exists then 
      then
          :
      else # This file should always exist:   ~/.config/videoinfox/videoinfox-dl-Default   if it doesn't, it will be created
           # CREATING EMPTY DEFAULT DOWNLOAD LIST WITH LIST EMPTY MESSAGE
           echo > ~/.config/videoinfox/videoinfox-dl-Default
           echo "Default Download List Empty" >> ~/.config/videoinfox/videoinfox-dl-Default
    fi


if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
then
# ADD TO DEFAULT LIST  <DEFAULT LIST>
echo "$pasteclip" >> ~/.config/videoinfox/videoinfox-dl-Default  # write url to the default download list
notify-send "Videoinfox Message: ADDED LINK TO DEFAULT LIST"

# REMOVE DUPLICATES
cat -n ~/.config/videoinfox/videoinfox-dl-Default | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfox-dl-Default.tmp
mv ~/.config/videoinfox/videoinfox-dl-Default.tmp ~/.config/videoinfox/videoinfox-dl-Default

sed -i '/^$/d' ~/.config/videoinfox/videoinfox-dl-Default 2>/dev/null  # remove any blank lines in the list
sed -i '/http/!d' ~/.config/videoinfox/videoinfox-dl-Default  # remove all lines not starting with  http

echo "" | xclip -sel clip  # clearing out the clipboard
exit

else
notify-send "Videoinfox -a Error . . ." "Clipboard content didn't start wit http."
exit
fi

else
    echo
    echo "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
    echo
    notify-send "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
    exit
fi


    else
        :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -h     DISPLAY HELP THEN EXIT  
#-------------------------------------------------------------------------------------------------------------------------------------------------

if [ "$1" = "-h" ]
  then

      direxist="$HOME/.config/videoinfox/tmp"

      if [ -d "$direxist" ]  #  if directoty exists goto  <then>
        then
       clear
       echo
       echo "___________________________________________________________________________________________________________________"
       echo  
       echo " ""$ver"" >>> COMMAND LINE OPTIONS >>> HELP   Where video download and play is a clipboard copy away . ."    
       echo "___________________________________________________________________________________________________________________" 
       echo
       echo " Note: Videoinfox won't accept multiple options. Only one option per instance."
       echo
       echo
       echo "   -h  This help screen."
       echo
       echo "   -v  Display the version number."
       echo
       echo "   -a  Write video URL in the clipboard to the Default List. Instructions: Yt-dlp >>> Download List >>> Help"
       echo
       echo "   -l  Write video URL in the clipboard to the User Set List. Instructions: Yt-dlp >>> Download List >>> Help"
       echo
       echo "   -d  Play Directory. Autoplay video files in the current directory. Change intermission time in Settings"
       echo
       echo "   -z  Make a playlist from a recursive video listing in the current directory. The Playlist will be saved in"
       echo "       ~/.config/videoinfox/playlists which makes the playlist/index available to videoinfox's feature set."
       echo
       echo "   -u  This option can be used with your own ready to download url list that can be any name. Videos will be"
       echo "       downloaded to the directory of the list's location. Example: videoinfox -u mylist  Only enter the list"
       echo "       filename. No Paths. The list must be recursively reachable from the current directory. THE FIRST LINE"
       echo "       IN THE LIST MUST BEGIN WITH  http  TO BE PROCESSED. Any files processed with this option will delete all"
       echo "       lines that don't start with http, all blank lines and all duplicate lines."
       echo -e "\n"     
       exit
  
      else
          echo
          echo "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
          echo
          exit
      fi

   else
      :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -u     DOWNLOAD ANY LIST THAT IS RECURSIVELY REACHABLE FROM THE CURRENT DIRECORY. ENTER FULL FILENAME ONLY. NO WILDCARD
#-------------------------------------------------------------------------------------------------------------------------------------------------

if [ "$1" = "-u" ]
  then   
  direxist="$HOME/.config/videoinfox/tmp"
  if [ -d "$direxist" ]  #  if directoty exists goto  <then>
  then
     read -r vnotify < ~/.config/videoinfox/vnotify  
     clear
     echo
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " ""$ver"" >>> Load a recursively reachable Download List for processing . . ."
     echo "___________________________________________________________________________________________________________________"    
        

     if echo "$2" | grep "/" > /dev/null  # if any slashehes were entered, exit
       then
            echo
            echo " error: No directories. Only a filename. List must be recursively reachable from the current directory."
            echo 
            exit    

       else
            :
     fi


     if echo "$2" | grep "*" > /dev/null  # if any wildcards * were entered, exit
       then
            echo
            echo " error: No wildcards. Only a filename. List must be recursively reachable from the current directory."
            echo 
            exit    

       else
            :
     fi


        filecount=$(find "$PWD" -type f \( -iname "$2" \) | wc -l)
       
        if [ "$filecount" = 1 ]  # IF THE FILE IS FOUND THE COUNT WILL BE: 1
           then
                chkforhttp=$(find "$PWD" -type f \( -iname "$2" \))  # getting list name to check the first line for http
                read chkforhttp2 < "$chkforhttp"  # reading first line into varible $chkforhhtp2
                chkforhttp=$(echo "$chkforhttp2" | cut -c-4)   # cut everything after the 4th character

                if [ "$chkforhttp" = "http" ]  # if the first 4 characters = <http> go then
                   then
                        :
                   else
                        echo
                        echo -e "\033[5m error\033m\033[0m:   The first 4 characters on the first line don't start with http"
                        echo "          This is a safety feature to prevent accidental deletion of a file that is not a Download List."
                        echo
                        echo "          If this file was processed, The following lines would have been removed:"
                        echo
                        echo "          - All lines that don't begin with: http"
                        echo "          - All duplicate lines"
                        echo "          - All blank lines"
                        echo
                        echo "          ** The first line of all Download Lists must begin with http to be processed with: videoinfox -u"
                        echo 
                        exit
                fi


                ##### GRAB THE PATH FROM THE DOWNLOAD LIST TO CHANGE THE WORKING DIRECTORY TO THAT PATH #####

                find "$PWD" -type f \( -iname "$2" \) > videoinfox-u-option-grabdir.tmp #2> /dev/null # find the list to grab the full path with filename
                sed -i 's%/[^/]*$%%' videoinfox-u-option-grabdir.tmp  # remove last slash and filename from the path for the cd command
                read -r < videoinfox-u-option-grabdir.tmp whatsthepath  # read the path into the varible: $whatsthepath 
                rm videoinfox-u-option-grabdir.tmp  # download list location is no longer needed. so it will be removed
                cd "$whatsthepath"  # cd to the download list location.

     
                #####  ERROR CORRECTION FOR THE USER'S LIST BEFORE DOWNLOAD.  #####

                cat -n "$2" | sort -uk2 | sort -n | cut -f2- > videoinfox-u-option.tmp  # remove duplicates from the user's list
                sed -i '/^$/d' videoinfox-u-option.tmp  # remove all blank lines from the user's list
                sed -i '/http/!d' videoinfox-u-option.tmp  # remove all lines not starting with: http from the user's list
                mv videoinfox-u-option.tmp "$2"  
               

                #####  TAGGING .log ONTO THE USER'S LIST FILENAME TO CREATE A LOG FILE OF THE DOWNLOAD  #####
            
                ulogfile="$2".log  # tag  .log  onto the filename for log creation
                echo "$ver" ">>> videoinfox -u" "$2" ">>> Logfile" > "$ulogfile"  # create the log file header Line 1
                echo >> "$ulogfile"
                echo "Download list:" "$PWD/""$2" >> "$ulogfile"  # create the log file header Line 2
                echo >> "$ulogfile"  # create the log file header Line 3 (blank line)
                echo >> "$ulogfile"  # create the log file header Line 4 (blank line)

                echo
                echo "Processing list:" "$PWD/""$2"

                read -r dlargue 2>/dev/null < ~/.config/videoinfox/dlargue
             
                #####  DOWNLOAD LIST  #####
                
                input="$2"  # INPUT FOR THE DOWNLOAD LOOP (the download list)


                #####  DOWNLOAD LOOP START  #####

                while read -r line  # read line by line until end of file
                do

                echo
                ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line"  # download url
                echo
                echo "Logging URL and Filename to:" "$PWD/""$ulogfile" 

                # logging yt-dlp output to the log file

                echo "$line" >> "$ulogfile" 
                ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line" | tee >> "$PWD/""$ulogfile"
                echo >> "$ulogfile" 

                done < "$input"

                #####  DOWNLOAD LOOP END  #####


                #####  REMOVE UNWANTED LOG INFO  ##### 

                sed -i '/\[youtube\]/d' "$2".log &> /dev/null  # removing lines that start with  [youtube]
                sed -i '/\[info\]/d' "$2".log &> /dev/null  # removing lines that start with  [info]
                sed -i 's/\[download\]//' "$2".log &> /dev/null  # remove   [download]   from the end of the line.
                sed -i 's/has already been downloaded//' "$2".log &> /dev/null  # remove   has already been downloaded   from the end of the line.
                sed -i -e 's/^[ \t]*//' "$2".log &> /dev/null  # remove spaces at beginning of line.


                #####  DISPLAY AFTER THE LIST IS DONE DOWNLOADING  #####

                echo
                echo
                echo -e "$ver" "\033[5mdone processing download list . . .\033m\033[0m"                 
                echo
                echo "List:" "$PWD/""$2"  # display list filename with full path
                echo "Log :" "$PWD/""$ulogfile"  # display log filename with full path
                echo
                
                "$vnotify" "Videoinfox -u messsage: Done Processing Download List . . ." "$PWD/""$2"
                exit  # exit videoinfox

           else
                echo
                echo " Videoinfox Error: List not found. List must be recursively reachable from the current directory."
                echo
                exit
           fi    

  else
  echo
  echo "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
  echo
  "$vnotify" "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup." 2>/dev/null
  exit
  fi
   
   else
        :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -d     @PLAY DIRECTORY.  AUTOPLAY VIDEO FILES IN THE CURRENT DIRECTORY
#-------------------------------------------------------------------------------------------------------------------------------------------------

if [ "$1" = "-d" ]
   then
       direxist="$HOME/.config/videoinfox/tmp"
       if [ -d "$direxist" ]  #  if directoty exists goto  <then>
         then

read -r vnotify < ~/.config/videoinfox/vnotify

if [ -f ~/.config/videoinfox/videoinfox.intermission ]  # if file exists goto then
  then
      :
  else
      echo "10" > ~/.config/videoinfox/videoinfox.intermission
fi
read -r vto < ~/.config/videoinfox/videoinfox.intermission

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-optiond-play-directory-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.numbered-optiond-play-directory-list 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa-work 2>/dev/null    
fi


clear

if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-optiond-play-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-optiond-play-directory-list 2>/dev/null
   


linenumber=1

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa 2>/dev/null

read -r vplaym < ~/.config/videoinfox/videoinfox.video-player
if [[ "$vplaym" = 1 ]]
  then
      defplayer=(ffplay)
      defplayargu=(-fs -autoexit -loglevel quiet) 
elif [[ "$vplaym" = 2 ]]
  then
      defplayer=(mpv)
      defplayargu=(--fs --no-terminal --sid=no --save-position-on-quit)
elif [[ "$vplaym" = 3 ]]
  then
      read -r cplayer1 < ~/.config/videoinfox/videoinfox.customplayer.1 
      read -r cplayer2 < ~/.config/videoinfox/videoinfox.customplayer.2 
      defplayer=($cplayer1)
      defplayargu=($cplayer2)
fi

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> Command Line Option -d >>> PLAY DIRECTORY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line"
      
i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox.optiond-play-directory-apa-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done
 
IFS=$OLDIFS
clear

else
        echo
        echo
        echo "$ver  No playable content in the current directory . . ."
        echo
fi


exit

else
  echo
  echo "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
  echo
  "$vnotify" "Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup." 2>/dev/null
  exit
  fi

else
    :
fi


#-------------------------------------------------------------------------------------------------------------------------------------------------
#  videoinfox -z     MAKE RECURSIVE PLAYLIST FROM THE CURRENT DIRECTORY
#-------------------------------------------------------------------------------------------------------------------------------------------------

if [ "$1" = "-z" ]
   then
       direxist="$HOME/.config/videoinfox/tmp"
clear
echo
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$ver"" >>> Make a recursive playlist from the current directory."
echo "___________________________________________________________________________________________________________________"    

if [ -d "$direxist" ]  #  if directoty exists goto  <then>
then
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox-u.work 2>/dev/null
sort -u ~/.config/videoinfox/tmp/videoinfox-u.work > ~/.config/videoinfox/tmp/videoinfox-u

read -r isempty < ~/.config/videoinfox/tmp/videoinfox-u
if [ -z "$isempty" ]
  then
      echo
      echo " No video files found . . ."
      echo
      exit

  else
      echo
      echo " $PWD"
      echo
      echo " If any dots are entered, they will be stripped from the playlist name."
      echo " Spaces can be used after the first character of the playlist name."
      echo
      read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

      # Strip out any dots from user entry
      echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot-u.tmp
      sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot-u.tmp
      read createpl < ~/.config/videoinfox/tmp/plremovedot-u.tmp
      rm ~/.config/videoinfox/tmp/plremovedot-u.tmp

      plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

      if [ -z "$createpl" ]
        then
            echo
            echo " Nothing was entered . . ."
            echo
            exit

        else
            if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
              then
                  function ovewritesr {
                  clear
                  echo
                  echo " File already exists . . ."
                  echo
                  echo " Overwrite playlist "$createpl1"?"
                  echo
                  echo " y - Yes     n - No"  
                  echo 
                  echo -en " Enter Option: "
                  read -r -n1 optiondelq
                  echo
                  }

                  while true
                  do
	            ovewritesr
	            case $optiondelq in

	            y)  # YES
                  if [[ "$setplaylist" = "$createpl1" ]]
                    then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
                        cat ~/.config/videoinfox/tmp/videoinfox-u > "$plname"
                        cat ~/.config/videoinfox/tmp/videoinfox-u > ~/.config/videoinfox/videoinfo.playlist
                        echo
                        echo " Playlist Overwritten: ""$plname"
                        echo
                        exit
                        
                    else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
                        cat ~/.config/videoinfox/tmp/videoinfox-u > "$plname"
                        echo
                        echo " Playlist Overwritten: ""$plname"
                        echo
                        exit
                  fi        
                  exit
                  ;;

                  n)  # NO
                  echo
                  exit
                  ;;

                  *)        
                  esac
                  done  

              else
                  cat ~/.config/videoinfox/tmp/videoinfox-u > "$plname"
                  echo
                  echo " Playlist Created: "$plname""
                  echo
                  exit
fi
fi
fi

else
    echo
    echo " Videoinfox error: Config directory not found. Run videoinfox first with no command line options to setup."
    echo
    exit
fi

else
    :
fi

##################################################################################################################################################
#  END COMMAND LINE OPTIONS  #####################################################################################################################
##################################################################################################################################################



##################################################################################################################################################
##################################################################################################################################################

#  THE BELOW 8 FUNCTIONS RUN ONCE ON EVERY STARTUP THEN INTO THE MAIN LOOP.

#  1. Dependency Check. If any dependencies are not found, the scipt will exit. Script will run when all dependencies are found.
#  2. Start from root check and change to home dir if started from the root directory.   
#  3. Configuration directory check and file creation. If  ~/.config/videoinfox  doesn't exist, directory will be crated along with config files.
#  4. Check for help files update. If an update is needed, delete help files.
#  5. Check for Videoinfox update and notify on the home screen if an update is available.
#  6. Create empty Default Download List if it doesn't exist.
#  7. Created Download List Help file if it doesn't exist.
#  8. Create Main Help file if it doesn't exist.
#  9. Create Version History file if it doesn't exist.

##################################################################################################################################################
##################################################################################################################################################



##################################################################################################################################################
#####  1. DEPENDENCY CHECK  ###################################################################################################################### 
##################################################################################################################################################

clear
echo
echo
echo
echo "___________________________________________________________________________________________________________________"
echo  
echo " $ver >>> DEPENDENCY CHECK"
echo "___________________________________________________________________________________________________________________"
echo

####### Check for <notify-send> ########
if ! command -v notify-send &> /dev/null  # if <notify-send> isnt found goto then
then
    echo " notify-send .......... Not Found"
    echo
    d1=1  # Not Found = 1
else
    #echo " notify-send .......... Found"
    #echo
    d1=0  # Found = 0
fi

####### Check for <bc> ########
if ! command -v bc &> /dev/null  # if <bc> isnt found goto then
then
    echo " bc ................... Not Found"
    echo
    d2=1  # Not Found = 1
else
    #echo " bc ................... Found"
    #echo
    d2=0  # Found = 0
fi

####### Check for <ffmpeg> ########
if ! command -v ffmpeg &> /dev/null  # if <ffmpeg> isnt found goto then
then
    echo " ffmpeg ............... Not Found"
    echo
    d3=1  # Not Found = 1
else
    #echo " ffmpeg ............... Found"
    #echo
    d3=0  # Found = 0
fi

####### Check for <ffprobe> ########
if ! command -v ffprobe &> /dev/null  # if <ffprobe> isnt found goto then
then
    echo " ffprobe .............. Not Found"
    echo
    d4=1  # Not Found = 1
else
    #echo " ffprobe .............. Found"
    #echo
    d4=0  # Found = 0
fi

####### Check for <ffplay> ########
if ! command -v ffplay &> /dev/null  # if <ffplay> isnt found goto then
then
    echo " ffplay ............... Not Found"
    echo
    d5=1  # Not Found = 1
else
    #echo " ffplay ............... Found"
    #echo
    d5=0  # Found = 0
fi

####### Check for <xclip> ########
if ! command -v xclip &> /dev/null  # if <xclip> isnt found goto then
then
    echo " xclip ................ Not Found"
    echo
    d6=1  # Not Found = 1
else
    #echo " xclip ................ Found"
    #echo
    d6=0  # Found = 0
fi

##########  Each Dependency:   Found = 0   Not Found = 1  ##########################
#
#   All dependency results are added:  - All dependencies Found = 0
#                                      - One or more dependencies Not Found = Not 0 
####################################################################################
depcount=$((d1 + d2 + d3 + +d4 + d5 + d6))


if [ $depcount == 0 ]  # if all dependencies = 0 (All Found) goto then
  then
      :
      #echo
      #echo " All dependencies are satisfied."  # sript runs
      #echo -e "\n"
  else
      echo
      echo -e " One or more dependencies: \033[5mNot Found\033[5m\033[0m"  # script exits
      echo
      echo " If a dependency isn't Found:  App isn't installed or App is installed and not in the path."
      echo
      echo " When all dependencies are Found, the script will run."
      echo
      echo "__________________________________________________________________________________________________________________"  
      echo
      echo " $ver >>> EXIT"
      echo "__________________________________________________________________________________________________________________" 
      echo -e "\n"
      exit
fi


##################################################################################################################################################
#####  2. START FROM ROOT CHECK  ################################################################################################################# 
##################################################################################################################################################

whatdir=$PWD  #  current working directory
thisdir="/" #  root directory

if [ "$whatdir" == $thisdir ]  # If the directory the script was run from: / <root> goto then 
  then
      cd "$HOME"   
fi


##################################################################################################################################################
#####  3. DIRECTORY CHECK & FILE CREATION  ####################################################################################################### 
##################################################################################################################################################

# The below check: Does the directory <~/.config/videoinfox> exist ?
# If it doesn't exist, directory is created. Empty files are created to avoid error when running Videoinfo for the first time.

direxist="$HOME/.config/videoinfox"

if [ -d "$direxist" ]  #  if directoty exists goto  <then>
  then
      :  #  goto CHECK FOR  (VIDEOINFOX NOTIFICATION UPDATE)
  else
      
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo  
      echo " $ver >>> FIRST RUN >>> SETUP"
      echo " Created config directory: "$HOME"/.config/videoinfox and required files"
      echo "___________________________________________________________________________________________________________________"
      echo "___________________________________________________________________________________________________________________"
      echo         
      echo " Don't use paste on any screen with the dot blinking in the version number and Videoinfox will work as intended."
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " * VIDEOINFOX WILL KEEP CLEARING OUT INVALID CONTENT FROM THE CLIPBOARD. ANYTHING THAT ISN'T A VIDEO URL OR FILE *"
      echo "___________________________________________________________________________________________________________________"
      echo

if ! command -v mpv &> /dev/null
  then # ffplay
      echo " Mpv not found . . . Ffplay will be set as the default video player."
      echo " Mpv will keep a marker of last play position of every video played. Ffplay will not."
  else # mpv
      echo " Mpv found . . . Mpv will be set as the default video player."
      echo " Mpv will keep a marker of last play position of every video played. This feature can be turned off in Settings."
fi  
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " A sample video url was copied to the clipboard to show how the Play Clipboard feature works."
      echo " Press  p  when Videoinfox starts up. That will download the video url that is in the clipboard and autoplay it."
      echo
      echo " Video playing:  [ f - toggle fullscreen ]   [ spacebar - play/pause ]   [ l/r arrows - fwd/rew ]   [ q -quit ]"
      echo "__________________________________________________________________________________________________________________"
      echo
      echo " Yt-dlp will be downloaded to: "$HOME"/.config/videoinfox"
      echo "__________________________________________________________________________________________________________________"
      echo -e "\n" 
      echo " Setup for the first run or if the videoinfox directory gets deleted anytime after the first run."
     
      #####################
      # CREATE DIRECTORIES
      ####################
      mkdir ~/.config/videoinfox
      mkdir ~/.config/videoinfox/tmp
      mkdir ~/.config/videoinfox/playlists

      # SET DEFAULT  LAST SEARCH  to <2> Never Save
      echo "2" > ~/.config/videoinfox/videoinfo.lastsearch-set

      # CHECK FOR  ~/Downloads  If it doesn't exist, create it 
      direxist2="$HOME/Downloads"

      if [ -d "$direxist2" ]  #  if directoty exists goto  <then>
        then
             : 
        else
             mkdir ~/Downloads
      fi


      # SET DEFAULT  yt-dlp  DOWNLOAD DIRECTORY TO  ~/Downloads    It can be changed in the <set> menu
      echo "$HOME"/Downloads > ~/.config/videoinfox/videoinfo.yt-download-dir

      # SET DIR AT EXIT TO THE DEFAULT DOWNLOAD DIRECTORY SO DEFAULT DIR DISPLAY #3 LIGHTS UP ON FIRST RUN 
      echo "$HOME"/Downloads > ~/.config/videoinfox/videoinfo.dir-at-exit
      read -r diratexit < ~/.config/videoinfox/videoinfo.dir-at-exit
      cd "$diratexit" 2>/dev/null 

          
      ###############
      # CREATE FILES
      ###############

      # CREATING EMPTY FILES SO NO ERRORS ARE PRODUCED ON FIRST RUN
      echo > ~/.config/videoinfox/playlists/vplaylist.Default
      echo > ~/.config/videoinfox/videoinfo.findwork
      echo > ~/.config/videoinfox/videoinfo.findwork2
      echo > ~/.config/videoinfox/videoinfo.findwork3
      echo > ~/.config/videoinfox/videoinfo.lastfindtime    
      echo > ~/.config/videoinfox/videoinfo.lastsearchtotal
      echo > ~/.config/videoinfox/videoinfo.lastsearchtotal2
      echo > ~/.config/videoinfox/videoinfo.playedlist
      echo > ~/.config/videoinfox/videoinfo.tv-dir
      echo > ~/.config/videoinfox/videoinfo.movies-dir
      echo > ~/.config/videoinfox/videoinfo.parent-dir
      echo > ~/.config/videoinfox/videoinfo.lastdownload
      echo > ~/.config/videoinfox/videoinfo.lastfindstring
      echo > ~/.config/videoinfox/videoinfo.lastfinddir
      echo > ~/.config/videoinfox/videoinfo.lastsearchtotal
      echo > ~/.config/videoinfox/videoinfox.set-user-list

      # If mpv is found set to mpv. If mpv isn't found set to ffplay
      if ! command -v mpv &> /dev/null
        then # set ffplay
            echo "1" > ~/.config/videoinfox/videoinfox.video-player
        else # set mpv
            echo "2" > ~/.config/videoinfox/videoinfox.video-player
      fi
     
      echo "1" > ~/.config/videoinfox/mpvmarker # Set mpv to save play position on quit to true

      echo "notify-send" > ~/.config/videoinfox/vnotify # Set notification on
      read -r vnotify < ~/.config/videoinfox/vnotify      
  
      # SAMPLE URL DOWLOAD LIST BEING CREATED WITH 3 VIDEO URL'S
      echo "https://www.youtube.com/watch?v=d59H0UxhyaY" > $HOME/Downloads/videoinfox-dl-sample-list
      echo "https://www.youtube.com/watch?v=5tSAKS8LRj0" >> $HOME/Downloads/videoinfox-dl-sample-list
      echo "https://www.youtube.com/watch?v=DAPkOxRnh4c" >> $HOME/Downloads/videoinfox-dl-sample-list

      echo
      read -p " Press enter to continue . . ."
                        
 
# Yt-dlp initial download attempt on the first run. If it fails, download will be re-attempted when you select the Yt-dlp Menu.
clear
echo
echo 
echo 
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> Attempting to download the most recent version of Yt-dlp . . ."
echo "___________________________________________________________________________________________________________________" 
echo
echo " If Yt-dlp can't be downloaded, the download attempt will be aborted."
echo
echo " If the download fails, it is most likely due to at least 1 of the following reasons:"
echo
echo "    - Your internet connection is down."
echo
echo "    - Github isn't reachable due to technical issues on their end."
echo
echo "    - There is no Yt-dlp release available in:  https://github.com/yt-dlp/yt-dlp/releases/latest/download"
echo
echo
echo " If this download fails, the download attempt will be tried again when you select the Yt-dlp Menu in Videoinfox."
echo
echo
echo " Note: The Yt-dlp Menu will not work until there is a copy of yt-dlp in:"
echo
echo " "$HOME"/.config/videoinfox"
echo
echo

dirtemp="$PWD"  # save dir for restore after ty-dlp download
cd ~/.config/videoinfox
  
wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp 2>/dev/null  # download and rename 
 
if [ -f ~/.config/videoinfox/yt-dlp ]  # if yt-dlp exists goto then
   then
        chmod a+rx ~/.config/videoinfox/yt-dlp  # set <yt-dlp-fetched> execute bit
        ~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version # write yt-dlp ver number to file: yt-dlp.version 
        echo
        echo " Yt-dlp Downloaded . . ."
        echo
        # SAMPLE VIDEO URL BEING COPIED TO CLIPBOARD
        echo "https://www.youtube.com/watch?v=rNWPqfCJDnc" | xclip -sel clip 

        sec=3           
        while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>                       
             echo -ne " $ver starting in: $sec\033[0K\r"
             let "sec=sec-1"
             sleep 1
        done
        
        rm ~/.config/videoinfox/wget-* 2> /dev/null          


   else
       
        echo
        echo " Yt-dlp Download Failure . . ."
        echo

        sec=15           
        while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>                       
             echo -ne " $ver starting in: $sec\033[0K\r"
             let "sec=sec-1"
             sleep 1
        done 

        rm ~/.config/videoinfox/wget-* 2> /dev/null    

cd "$dirtemp"  # restore directory

fi

fi

##################################################################################################################################################
#####  You will only see FIRST RUN >>> SETUP again if the  ~/.config/videoinfox directory doesn't exist.  ######################################## 
##################################################################################################################################################

if [ -f ~/.config/videoinfox/vnotify ]
  then
      :
  else
      echo "notify-send" > ~/.config/videoinfox/vnotify  # Set notification on
fi
read -r vnotify < ~/.config/videoinfox/vnotify # Set gui notification on/off

direxist3="$HOME/.config/videoinfox/tmp"
if [ -d "$direxist3" ]  #  if directoty exists goto  <then>
  then
      :
  else
      mkdir ~/.config/videoinfox/tmp
fi


direxist5="$HOME/.config/videoinfox/playlists"

if [ -d "$direxist5" ]  #  if directoty exists goto  <then>
  then
      :
  else
      mkdir ~/.config/videoinfox/playlists
fi

##################################################################################################################################################
##### 4. UPDATE 3 HELP FILES WITH VERSION NUMBER AND ANY CONTENT CHANGES AFTER AN UPDATE #########################################################
##################################################################################################################################################

if [ -f ~/.config/videoinfox/videoinfox.download-list-help ] # Yt-dlp >>> Download List >>> Help
  then
      echo ~/.config/videoinfox/videoinfox.download-list-help | xargs -d '\n' grep -i -h "$vn" > ~/.config/videoinfox/tmp/videoinfox.download-list-help.flag
      read -r downloadlisthelp < ~/.config/videoinfox/tmp/videoinfox.download-list-help.flag

      if [ -z "$downloadlisthelp" ] 
        then
            rm ~/.config/videoinfox/videoinfox.download-list-help
        else
            :
      fi  
else
    :
fi

if [ -f ~/.config/videoinfox/videoinfo.help ] # Home >>> Help
  then
      echo ~/.config/videoinfox/videoinfo.help | xargs -d '\n' grep -i -h "$vn" > ~/.config/videoinfox/tmp/videoinfo.help.flag
      read -r homehelp < ~/.config/videoinfox/tmp/videoinfo.help.flag

      if [ -z "$homehelp" ] 
        then
            rm ~/.config/videoinfox/videoinfo.help
        else
            :
      fi  
else
    :
fi

if [ -f ~/.config/videoinfox/videoinfo-ver-history ] # Set >>> Version History
  then
      echo ~/.config/videoinfox/videoinfo-ver-history | xargs -d '\n' grep -i -h "$vn" > ~/.config/videoinfox/tmp/videoinfo-ver-history.flag
      read -r versionhistory < ~/.config/videoinfox/tmp/videoinfo-ver-history.flag

      if [ -z "$versionhistory" ] 
        then
            rm ~/.config/videoinfox/videoinfo-ver-history
        else
            :
      fi  
else
    :
fi


##################################################################################################################################################
#####  5. CHECK FOR  (VIDEOINFOX NOTIFICATION UPDATE)                         routine to get version number from github          #################
########################################################################      and compare it to this scripts version number      #################

clear  # Display while downloading videoinfox from github on startup
echo
echo
echo
echo "___________________________________________________________________________________________________________________"
echo  
echo " $ver >>> Checking for update . . ."
echo "___________________________________________________________________________________________________________________"
echo

dirtemp="$PWD"  # save directory for restore
cd ~/.config/videoinfox/tmp

# download  videoinfox  from github
wget -q https://raw.githubusercontent.com/powerhousepro69/videoinfox/main/videoinfox 2>/dev/null

# make script executable to get ver number
chmod +x ~/.config/videoinfox/tmp/videoinfox 2> /dev/null

# get ver number of download
viv=$(~/.config/videoinfox/tmp/videoinfox -v 2> /dev/null)  

# download ver: cut the first 13 characters + sed to remove the dot =  version number minus the dot 
viv2=$(echo "$viv" | cut -c13- | sed -e 's/\.//g' 2> /dev/null) # format: whole number  xxxx

# script ver:   cut the first 13 characters + sed to remove the dot =  version number minus the dot 
viv3=$(echo "$ver" | cut -c13- | sed -e 's/\.//g') # format: whole number  xxxx


# Prevent Update Available notifications from displaying if download fails. 
# If download fails, download version = script version

if [ -f ~/.config/videoinfox/tmp/videoinfox ]  # if file exists goto then
   then  # Downloaded
        :

   else # Download Failure
        viv3="$viv2"
fi


# for the notification on the home screen

if [ "$viv2" = "$viv3" ]  # If the downloaded version = this script's version goto then
  then
      # Version numbers are the same
      viv4=$(echo -e \ "               ") # dead space place holder for when there is no Update Available in the display
      #rm ~/.config/videoinfox/tmp/* 2> /dev/null
      cd "$dirtemp"  # restore directory

  else
      # Version numbers are not the same
      viv4="Update Available"   # Update Available   notification on home screen
      "$vnotify" "Videoinfox messsage: Update Available" "$viv" # send gui notification with update ver number
      #rm ~/.config/videoinfox/tmp/* 2> /dev/null
      cd "$dirtemp"  # restore directory
fi

##################################################################################################################################################
#####  6. IF THE DEFAULT LIST DOESN'T EXIST, CREATE IT  ##########################################################################################
##################################################################################################################################################

if [ -f ~/.config/videoinfox/videoinfox-dl-Default ]  # if file exists then 
then
    :
else  # if file doesn't exist one will be created

# CREATING EMPTY DEFAULT DOWNLOAD LIST WITH LIST EMPTY MESSAGE
echo > ~/.config/videoinfox/videoinfox-dl-Default
echo "Default Download List Empty" >> ~/.config/videoinfox/videoinfox-dl-Default

fi

##################################################################################################################################################
#####  7. CREATE DOWNLOAD LIST HELP FILE  ######################################################################################################## 
##################################################################################################################################################

if [ -f ~/.config/videoinfox/videoinfox.download-list-help ]
then
    :
else 
echo "___________________________________________________________________________________________________________________" > ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help

#V!VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV
echo " Videoinfox v5.5.19   Where video download and play is a clipboard copy away . . ." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " Up & Down Arrows or Mouse wheel - scroll                                                             Home - top" >> ~/.config/videoinfox/videoinfox.download-list-help
echo " q - quit                                                                                             End - bottom" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help 
echo " DOWNLOAD LIST HELP" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "   *** The User Lists can be anywhere so lists need to be recursively reachable from the current directory ***" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " There is a Default List and User Created Lists.  If a list is deleted, it's log file will also be deleted." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " DEFAULT LIST:  - There is just one Default List." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - The list resides in Videoinfox's .config directory and is maintained by the script." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - Script Directory location is irrelevant.  The Default List will follow the user." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - Video URL's' are always downloaded to the default Download Directory." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Default List Companion: videoinfox -a" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  TO SETUP:  Make a keyboard shortcut for  videoinfox -a  (no space after the a)" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  The shortcut varies per terminal. I use Mate Terminal and this is my shortcut command:" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  mate-terminal --command=\"videoinfox -a\"" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  TO USE:  Copy a Video URL to the clipboard then use the  videoinfox -a  shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                           That will add the URL to the Default List.  Rinse and repeat until done." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Keep pasting your clipboard copies on the fly to the Default List without leaving the browser." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  When done making the list, start Videoinfox. Load the list and Download." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Note: Clipboard will be cleared every time you run the shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                        Videoinfox doesn't need to be running to use the shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help

echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " USER LISTS:    - Unlimited User Lists." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - Lists can be put anywhere and named." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - Script Directory location is relavant to having access to the User Lists in Videoinfox." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                - Video URL's are always downloaded to the directory of the list's location." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  User Set List Companion: videoinfox -l" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  TO SETUP:  Make a keyboard shortcut for  videoinfox -l  (no space after the l)" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  The shortcut varies per terminal. I use Mate Terminal and this is my shortcut command:" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  mate-terminal --command=\"videoinfox -l\"" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  TO USE:  Copy a Video URL to the clipboard then use the  videoinfox -l  shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                           That will add the URL to the User Set List.  Rinse and repeat until done." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Keep pasting your clipboard copies on the fly to the User Set List without leaving the browser." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  When done making the list, start Videoinfox. Load the list and Download." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  *** A User List must be set first for the  videoinfox -l  shortcut to work ***" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Create an empty User List.  Select: Create User List.  Give the list a name." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  The new list will be displayed at the top of the screen." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Then select: Set User List.  Your all set and ready to go.  You can exit Videoinfox if you want." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Note: Clipboard will be cleared every time you run the shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                        Videoinfox doesn't need to be running to use the shortcut." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  When a User List is set, it will be cleared after download" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  You can also make a list with your preferred text editor." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  The download list name always has to beigin with: videoinfox-dl-  to be accessed by Videoinfox." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Add anything to the end of the filename." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  Sample download list name: videoinfox-dl-funny-videos" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                  One video URL per line starting at line 1. No Spaces." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " COMMAND LINE OPTION: videoinfox -u" >> ~/.config/videoinfox/videoinfox.download-list-help       
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " This option can be used with your own ready to download url list that can be any name and location. Videos will" >> ~/.config/videoinfox/videoinfox.download-list-help 
echo " be downloaded to the directory of the list location. Example: videoinfox -u mylist  Only enter the list filename." >> ~/.config/videoinfox/videoinfox.download-list-help 
echo " No paths. The list must be recursively reachable from the current directory. The first line in the list must" >> ~/.config/videoinfox/videoinfox.download-list-help       
echo " begin with http to be processed." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " videoinfox -h  will also display the above instuctions for: videoinfox -u" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " Erorr correction on all Download Lists:  - remove all lines that don't start with  http" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                                          - remove all duplicate lines." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                                          - remove all empty lines." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                                          * Download lists will be edited if they contain any of the above errors." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " DOWNLOAD QUEUE: Batch download multiple Videoinfox Created User Lists." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                 When done adding User Lists to the queue, select Download Queue." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                 If there is a User Set List and it gets processed by Download Queue, It will be cleared after" >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                 download. The list will be left untouched. It will just be cleard from User Set List." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "                 User Lists will always be downloaded to the directory of the list's location." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " CREATE/CHANGE DIRECTORY for Download Lists with Navigate Tree & Default Dirs Interface." >> ~/.config/videoinfox/videoinfox.download-list-help
echo " After directory creation, Change to directory. Then Create User List." >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo " Note: There are 2 ways to change the treetop. Default Dirs and Change Treetop." >> ~/.config/videoinfox/videoinfox.download-list-help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
echo >> ~/.config/videoinfox/videoinfox.download-list-help
fi

#####  DOWNLOAD LIST HELP COMPLETED  ############################################################################################################# 
##################################################################################################################################################


##################################################################################################################################################
#####  8. CREATE HELP FILE  ###################################################################################################################### 
##################################################################################################################################################

if [ -f ~/.config/videoinfox/videoinfo.help ]
then
    :
else
echo "___________________________________________________________________________________________________________________" > ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
#V!VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV
echo " Videoinfox v5.5.19   Where video download and play is a clipboard copy away . . ." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Up & Down Arrows or Mouse wheel - scroll                                                             Home - top" >> ~/.config/videoinfox/videoinfo.help
echo " q - quit                                                                                             End - bottom" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo  >> ~/.config/videoinfox/videoinfo.help
echo " Find your videos fast. Powerful playlist building and editing. A play queue to load up unlimited playlists for" >> ~/.config/videoinfox/videoinfo.help
echo " autoplay with last video played marker to pick up where you left off. Played List that keeps track of everything" >> ~/.config/videoinfox/videoinfo.help
echo " played by Play Clipboard, Last Download and Play. Index unlimited video libraries and find videos by keyword from" >> ~/.config/videoinfox/videoinfo.help
echo " the path or file. Yt-dlp integration. Download list building without leaving your web browser and a download" >> ~/.config/videoinfox/videoinfo.help
echo " queue to load up unlimited download lists for batch processing." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " VIDEOINFOX WILL KEEP CLEARING OUT INVALID CONTENT FROM THE CLIPBOARD. ANYTHING THAT ISN'T A VIDEO URL OR FILE." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " File types searched for: mp4, webm, mkv, avi, divx, 3gp" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Getting Started: Set Default Directories located in -Set. Enter the parent directories of your video libraries." >> ~/.config/videoinfox/videoinfo.help
echo "                  Then run -Index Default Directories This will build a searchable recursive list of all 4 default" >> ~/.config/videoinfox/videoinfo.help
echo "                  directories for -Playlist Find. Find a video(s) with a keyword from the path or file." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Watch videos with mpv, ffplay or any video player. Home Screen: -Set -Video Player" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " If MPV is used, it will keep track of last play position on all videos played on Mpv quit(q)" >> ~/.config/videoinfox/videoinfo.help
echo " Mpv will only save a play position marker when Mpv quit(q) is used while playing a video." >> ~/.config/videoinfox/videoinfo.help
echo " If Mpv is quit(q) when a video is paused, it will restart the video paused." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Option  2 - mpv  in Settings >>> Video Player there is an option to toggle on/off save play position on mpv quit." >> ~/.config/videoinfox/videoinfo.help
echo " Also, an option to erase all mpv markers." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " mpv save  notification on the home screen under -Help is displayed when mpv is set as the video player and" >> ~/.config/videoinfox/videoinfo.help
echo "           the mpv option  --save-position-on-quit  is active." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Change to a parent directory of a video library and select:  - Find Video  or  - Show All  on the home screen." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " - Find Video  Recursive search in the current directory." >> ~/.config/videoinfox/videoinfo.help
echo " - Show All    Recursive listing of all files in the current directory." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Searching for a video named:   The Reunion Show   and what searches would find it." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " the*      would find files starting with:  the" >> ~/.config/videoinfox/videoinfo.help     
echo >> ~/.config/videoinfox/videoinfo.help
echo " *ion*     would find files with:  ion  anywhere in the file name from the beginning to the end." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " *show     would find files ending with:  show" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " With search results on the screen, available options are: Play, Autoplay, Playlist Add, Make Playlist or Info  " >> ~/.config/videoinfox/videoinfo.help  
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " 1 2 3 4 5 - Default Dirs  One keypress to change default directories. - Set to set default directories 1-4" >> ~/.config/videoinfox/videoinfo.help     
echo >> ~/.config/videoinfox/videoinfo.help
echo " Default 1-4 have display priority over 5. So if the directory on last exit (5) equals 1-4,  1-4 gets the display.  " >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Set default directories first then -Index Default Directories located in settings." >> ~/.config/videoinfox/videoinfo.help
echo " Every time a default directory is changed or removed in settings, or if any content has been added or removed" >> ~/.config/videoinfox/videoinfo.help
echo " from any of the default directories, Index Default Directories will need to be run again to update the changes." >> ~/.config/videoinfox/videoinfo.help
echo " The above also applies if any videos are renamed in any of the default directories. A date and time stamp is" >> ~/.config/videoinfox/videoinfo.help
echo " displayed in settings of the last time Index Default Directories was run." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Indexing more directories in addition to the 4 default directories is a simple process." >> ~/.config/videoinfox/videoinfo.help
echo " Change to a parent directory of a video library. Then -Show All on the home screen and select -Make Playlist" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Note:   -Show All on the Home Screen is recursive.   -Show all in -Navigate Tree is one level deep." >> ~/.config/videoinfox/videoinfo.help        
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Last Search  <set>  If search results are not manually cleared (-Clear Results) before exit. Default set to 2" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                     Three Choices:     1 - Always Save     2 - Never Save     3 - Ask on Exit" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " To use Play Clipboard: Works with a video url or a video file with full path." >> ~/.config/videoinfox/videoinfo.help 
echo >> ~/.config/videoinfox/videoinfo.help 
echo " Copy a video url to the clipboard and press enter to verify the clipboard content is valid." >> ~/.config/videoinfox/videoinfo.help  
echo " Then  p  to Download and Autoplay Fullscreen." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Copy a video file with full path to the clipboard and press enter to verify the clipboard content is valid." >> ~/.config/videoinfox/videoinfo.help  
echo " Then  p  to Autoplay Fullscreen.    Note: No quotes for filenames with spaces" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help 
echo " Processing a video url that is in the clipboard is supported by the following 7 options:" >> ~/.config/videoinfox/videoinfo.help 
echo >> ~/.config/videoinfox/videoinfo.help
echo " - Play Clipboard  - Download Only  - Download Choose  - Self Destruct" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help 
echo " - Add to Default List located in: Yt-dlp Menu >>> Download List >>> Default List" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " videoinfox -a and videoinfox -l keyboard shortcuts." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Copy a video url link (entire line) to the clipboard before selecting any of the above options." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Yt-dlp Menu    d - Download Only ..... Yt-dlp with any options set in Yt-dlp Menu -Set." >> ~/.config/videoinfox/videoinfo.help
echo "                c - Download Choose ... Choose video type and quality before download." >> ~/.config/videoinfox/videoinfo.help
echo "                s - Self Destruct ..... Download, auto play then delete when the video player is quit." >> ~/.config/videoinfox/videoinfo.help
echo "                g - Download List ..... Instructions are located in Help on the Download List screen." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " -Last Download works with -Play Clipboard, -Download Only and -Download Choose." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " -Self Destruct isn't written to Last Download because the video is deleted after closing the player."  >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Note: Videoinfox keeps its own yt-dlp copy in:  ~/.config/videoinfox" >> ~/.config/videoinfox/videoinfo.help
echo "       On every start of Videoinfox, it will check for its own update and notify if an update is available." >> ~/.config/videoinfox/videoinfo.help
echo "       No auto update checks are done for Yt-dlp.  To check for a Yt-dlp update and install update: Settings (Set)"  >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Autoplay Features:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Play Directory  Autoplay all videos in the current directory from beginning to end of the directory listing." >> ~/.config/videoinfox/videoinfo.help
echo "                 This option never writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in: Home Screen, Navigate Tree and View Downloads." >> ~/.config/videoinfox/videoinfo.help
echo "                 No Last video played marker is saved." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Autoplay        Autoplay from line number entered to the end of the list." >> ~/.config/videoinfox/videoinfo.help
echo "                 This option never writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in: Home Screen, Navigate Tree, Played List and View Downloads." >> ~/.config/videoinfox/videoinfo.help
echo "                 No Last video played marker is saved." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Start           Start autoplay from line number entered to the end of the list." >> ~/.config/videoinfox/videoinfo.help
echo "                 This option never writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in View Playlist and Play Queue located in Change and Queue." >> ~/.config/videoinfox/videoinfo.help
echo "                 Last video played marker is saved to resume for each playlist. " >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Resume          Resume autoplay with the last video that was playing." >> ~/.config/videoinfox/videoinfo.help
echo "                 This option never writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in View Playlist and Play Queue located in Change and Queue." >> ~/.config/videoinfox/videoinfo.help
echo "                 Last video played marker is saved for each playlist. " >> ~/.config/videoinfox/videoinfo.help
echo "                 *** Note: Options -Resume and -Clear Resume will not be displayed if there is no resume marker." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Play Features:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Play Clipboard  Download and autoplay a video url that is in the clipboard." >> ~/.config/videoinfox/videoinfo.help
echo "                 * This option always writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in: Home Screen, Played List, Playlist, Yt-dlp Menu and View Downloads." >> ~/.config/videoinfox/videoinfo.help
echo "                 Last downloaded video marker is saved for the option -Last Download." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Play            Only play the line number entered." >> ~/.config/videoinfox/videoinfo.help
echo "                 * This option always writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in: Home Screen, Navigate Tree, Played List. Playlist, Play Queue & View Downloads" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Last Download   Play the last download." >> ~/.config/videoinfox/videoinfo.help
echo "                 * This option always writes to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Available in: Home Screen and Yt-dlp Menu" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                 Note: Play Clipboard, Play and Last Download all write to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Playlist Features:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Create, Watch, and Manage playlists and the play queue in View Playlist" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Create" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Create .......... Create an empty playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Playlist Add .... Add an individual video to the loaded playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Make Playlist ... Save the entire video listing as a new playlist." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         * Playlist overwrite prompt for an existing file with options:  -Create and -Make Playlist" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         The following 3 areas support  - Playlist Add  and  - Make Playlist:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Home Screen. Add videos from recursive search results or recursive directory listings." >> ~/.config/videoinfox/videoinfo.help
echo "         - Navigate Tree >>> Show All. Add videos from one level deep directory listings." >> ~/.config/videoinfox/videoinfo.help
echo "         - Played List to Add videos from the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "           Note: Play, Play Clipboard and Last Download all write to the Played List." >> ~/.config/videoinfox/videoinfo.help
echo "                 Play Directory, Autoplay, Start and Resume do not write to the Played list." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         Save the entire list as a new playlist with the following 2 options:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Make Playlist to save the Play Queue as a new playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Playlist Find and search . then - Make Playlist to save all playlists and the default directories index." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Watch" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Start autoplay from anywhere in the playlist." >> ~/.config/videoinfox/videoinfo.help 
echo "         - Resume to start autoplay from the last video that was playing on quit." >> ~/.config/videoinfox/videoinfo.help
echo "         - Play Queue to load up multiple playlists for autoplay with resume." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help 
echo " Manage" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         View Playlist" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Move Line in the playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Move Block in the playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Line from the playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Block from the playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Dupes from the playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Clear Playlist." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         Play Queue" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Move Line in the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Move Block in the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Line from the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Block from the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Dupes from the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Clear Queue  clear out the play queue and the queue list." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         Change and Queue" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Change playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Create empty playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Delete playlist. If the loaded playlist is deleted, the default playlist will be loaded." >> ~/.config/videoinfox/videoinfo.help
echo "         - Rename playlist." >> ~/.config/videoinfox/videoinfo.help
echo "         - Save As to save the loaded playlist as... with file overwrite prompt." >> ~/.config/videoinfox/videoinfo.help
echo "         - Add to Queue to add a playlist to the play queue." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         Queue List" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "         - Move Line in the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Line from the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Remove Dupes from the play queue." >> ~/.config/videoinfox/videoinfo.help
echo "         - Rebuild Queue after one or more of the above 3 options are run." >> ~/.config/videoinfox/videoinfo.help
echo "         - Clear Queue  clear out the queue list and the play queue." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " - Playlist Find to search the text of all playlists and the default directories index with duplicates removed." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Note: Find videos to play or add to a playlist without needing to know the files location." >> ~/.config/videoinfox/videoinfo.help
echo "       Use a keyword from the path or filename to locate videos." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " If video libraries are spread out over many drives and/or different directories, build a recursive playlist" >> ~/.config/videoinfox/videoinfo.help
echo " for each location of videos using -Show All then -Make Playlist. Both located on the home screen." >> ~/.config/videoinfox/videoinfo.help
echo " This will create a searchable index of videos for each location. Then find content without providing a path or" >> ~/.config/videoinfox/videoinfo.help
echo " changing the directory." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Optional: Multiple playlists can be dumped into the play queue with -Add to Queue located in" >> ~/.config/videoinfox/videoinfo.help
echo "           View Playlist >>> Change and Queue. Then use -Make Playlist in -Play Queue to condense the" >> ~/.config/videoinfox/videoinfo.help
echo "           multiple playlists into one playlist. Combining multiple playlists with the play queue is always" >> ~/.config/videoinfox/videoinfo.help
echo "           optional because Playlist Find searches all of Videinfox's playlists." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Navigate Tree: Whatever the directory is when entering Navigate Tree will be set as the Treetop." >> ~/.config/videoinfox/videoinfo.help
echo "                Recursive Navigation from the Treetop. Directory listing is only 1 level deep." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                While in Navigate Tree, there are two ways to change the treetop. Default Dirs and Change Treetop." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " videoinfox -h to see command line options." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " When you use:  Videoinfox Update in Settings (Set), the update will always be applied to: /usr/local/bin" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                Yt-dlp Update in Settings (Set), the update will always be applied to: ~/.config/videoinfox" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Version History is located in: Home Screen: -Set -Vesion History" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Play Clipboard and Download List building from the web browser wouldn't have been possible without XCLIP" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Download feature wouldn't have been possible without YT-DLP" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Privacy Policy: Videoinfox will never collect or attempt to transmit any information on it's users." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                 Internet activity will only happen under the following circumstances:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                 - On First Run, Github will be contacted to download Yt-dlp." >> ~/.config/videoinfox/videoinfo.help
echo "                 - On every start, Github will be contacted to download Videoinfox for Update Available Check." >> ~/.config/videoinfox/videoinfo.help
echo "                 - Every time Videoinfox Update or Yt-dlp Update is selected in Settings, Github will be contacted." >> ~/.config/videoinfox/videoinfo.help
echo "                 - If there isn't a copy of Yt-dlp in Videoinfox's config directory, Github will be contacted" >> ~/.config/videoinfox/videoinfo.help
echo "                   when you select the Yt-dlp Menu to attempt a download of Yt-dlp." >> ~/.config/videoinfox/videoinfo.help
echo "                 - Every time Yt-dlp is used to download a video url." >> ~/.config/videoinfox/videoinfo.help
echo "                   Refer to Yt-dlp's site for their privacy policy. https://github.com/yt-dlp/yt-dlp" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " * When running videoinfox with no command line options:" >> ~/.config/videoinfox/videoinfo.help
echo "   There isn't code in this script to delete or overwrite any files other than Videoinfox created files." >> ~/.config/videoinfox/videoinfo.help
echo "   Exception: There is code in this script to delete all mpv markers in ~/.config/mpv/watch_later" >> ~/.config/videoinfox/videoinfo.help
echo "              Located in: Set >>> Video Player - Mpv" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "   There is code in this script in Yt-dlp Menu >>> Download List to create a directory but not remove a directory." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " * When running videoinfox -u command line option:" >> ~/.config/videoinfox/videoinfo.help
echo "   videoinfox -u will strip out the following 3 errors if they exist and overwrite the download list." >> ~/.config/videoinfox/videoinfo.help
echo "   All lines that don't start with http, all blank lines and all duplicate lines" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Note: Running multiple instances of Vidoeinfox will cause unwanted behavior with autoplay features." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo "                                     Thanks for checking out Videoinfox!" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " If Videoinfox is removed, the directory  ~/.config/videoinfox  will have to be manually deleted." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
fi

#####  HELP COMPLETED  ########################################################################################################################### 
##################################################################################################################################################




##################################################################################################################################################
#####  9. CREATE VERSION HISTORY FILE  ########################################################################################################### ################################################################################################################################################## 

if [ -f ~/.config/videoinfox/videoinfo-ver-history ]
then
    :
else 
echo " _________________________________________________________________________________________________________________________" > ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " Videoinfox   Where video download and play is a clipboard copy away . . .                                VERSION HISTORY" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " Up & Down Arrows or Mouse wheel - scroll                                                                    Home - top" >> ~/.config/videoinfox/videoinfo-ver-history
echo " q - quit                                                                                                    End - bottom" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
#V!
echo " 203 Version Updates" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history


# KNOWN ISSUE
#echo >> ~/.config/videoinfox/videoinfo-ver-history
#echo " KNOWN ISSUES: ." >> ~/.config/videoinfox/videoinfo-ver-history
#echo >> ~/.config/videoinfox/videoinfo-ver-history
#echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history


#V!VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV

echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.5.19 Add: Line number added to Resume: in -View Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Line number added to Resume: in -Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.5.17 Edit: Home Help. Find your videos fast. Powerful playlist building and editing..... section" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.5.16 Change: Moved option -Clrclp below -Play Clipboard in -Played List" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Fix: Had to add 3gp files to -Play Clipboard filter." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.5.14 New: -Set in YT-DLP MENU to use Yt-dlp with no options or custom options." >> ~/.config/videoinfox/videoinfo-ver-history
echo "              Applies to: -Download Only  -Self Destruct  -Download List  -Play Clipboard" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Videoinfox now also looks for: 3gp video files." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: File types searched for: mp4, webm, mkv, avi, divx, 3gp  added to Home Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Fix: Settings >>> Video player >>> Custom -Clear" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Version history only displays the last 40 updates." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.5.00 New: Make Playlist feature is now also a command line option: videoinfox -z" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: The below 2 lines were added to: Videoinfox -h " >> ~/.config/videoinfox/videoinfo-ver-history
echo "              -z  Make a playlist from a recursive video listing in the current directory. The Playlist will be saved in" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                  ~/.config/videoinfox/playlists which makes the playlist/index available to videoinfox's feature set." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: Version History. Everything before v5.0.00 was removed to reduce some bloat. A little over 1,000 lines." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.45 Add: -GUI Notify added to Settings. Turn GUI notifications on or off." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Note: GUI Notifications are always on for videoinfox -a and videoinfox -l keyboard shortcuts." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.44 Add: mpv save notification added to the Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Moved a few options around in the Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.42 Add: mpv save notification added to View Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Moved a few options around in View Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.40 New: -Save As added to change and queue to save the loaded playlist as... with file overwrite prompt." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Moved a few options around in Change and Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.33 Change: -Change Directory in YT-DLP MENU >>> DOWNLOAD LIST >>> Create/Change Directory" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 Change Directory would blink if there was a valid dir in the clipboard. Left over from many versions ago." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.32 Change: Messages in Queue List" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.31 Change: Duplicates in the Played List are no longer auto removed." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: -Remove Dupes option added to the Played List." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.30 Edit: Some edits in View Playlist >>> Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo "               Added line:  Pressing enter with no entry on any of the above edits will cancel the edit." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.29 Fix: Option spacing in View Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.28 Fix: Play Clipboard would try to play any valid file even if it wasn't a video file." >> ~/.config/videoinfox/videoinfo-ver-history
echo "              Now Play Clipboard only processes file extensions: mp4,mkv,avi,webm,divx" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Fix: After clearing the Played List, the display wouldn't update until quit and run Played List again." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.26 Add: Below info added to Home Help in Default Directories section." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " Set default directories first then -Index Default Directories located in settings." >> ~/.config/videoinfox/videoinfo-ver-history
echo " Every time a default directory is changed or removed in settings, or if any content has been added or removed" >> ~/.config/videoinfox/videoinfo-ver-history
echo " from any of the default directories, Index Default Directories will need to be run again to update the changes." >> ~/.config/videoinfox/videoinfo-ver-history
echo " The above also applies if any videos are renamed in any of the default directories. A date and time stamp is" >> ~/.config/videoinfox/videoinfo-ver-history
echo " displayed in settings of the last time Index Default Directories was run." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.25 Add: option -clear in Settings >>> Video Player >>> Custom" >> ~/.config/videoinfox/videoinfo-ver-history
echo "              note: If -custom is cleared, player will default to mpv if available. If not, then ffplay" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: moved options around in Settings >>> Video Player >>> Custom" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.23 Fix: Playlist Add prompt in Played List was not displaying the loaded Playlist." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.22 Update: -Playlist Add on the Home Screen, in Navigate Tree >>> Show All and in -Played List" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                  will update an existing resume list with the added video." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Update: -Add to Queue in Change and Queue will update an existing resume list with the added playlist." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: -Rebuild Queue in View Playlist >>> Change and Queue >>> Queue List will clear the -Resume list" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                  in the Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: View Playlist >>> Help" >> ~/.config/videoinfox/videoinfo-ver-history 
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.06 Move: playlist save loop moved up in the function to correct a display issue on any playlist edits." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Message added to View Playlist that will be displayed on any playlist edits." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         MSG: Saving loaded playlist . . ." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Note: * Every time an edit is made to a playlist, the resume marker will be cleared if one exists." >> ~/.config/videoinfox/videoinfo-ver-history
echo "               This is done because the resume marker and next: on the intermission screen need to be updated with the" >> ~/.config/videoinfox/videoinfo-ver-history
echo "               playlist edit(s). Running -Start will rewrite the resume marker." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "               * Playlist edits are saved on every edit. Resume and Next: are working with a copy of the loaded playlist." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.04 Fix: Renaming the loaded playlist would clear the resume marker if one existed." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Added: Below lines added to Home Help: 1 2 3 4 5 - Default Dirs section" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "                Indexing more directories in addition the 4 default directories is a simple process." >> ~/.config/videoinfox/videoinfo-ver-history
echo "                Change to a parent directory of a video library. Then -Show All on the home screen & select -Make Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "                Note:   -Show All on the Home Screen is recursive.   -Show all in -Navigate Tree is one level deep." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.02 Add: Notification to Home Screen under Help:  mpv save  when mpv is set as video player and" >> ~/.config/videoinfox/videoinfo-ver-history
echo "              mpv option  --save-position-on-quit  is active." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: ~/.config/videoinfox/tmp directory is only cleared on exit." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.4.00 New: Two new features added to -Set >>> Video Player option: 2 - Mpv" >> ~/.config/videoinfox/videoinfo-ver-history
echo "              Toggle on/off mpv save play position on quit and an option to erase all mpv markers." >>  ~/.config/videoinfox/videoinfo-ver-history 
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: New features added to Home Help" >>  ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: all - Find Dir changed from  f  to  g" >>  ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.55 Fix: -Auotplay in Played List wouldn't work if -Play wasn't run first." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Below line added to Home Help" >>  ~/.config/videoinfox/videoinfo-ver-history 
echo "              Note: Running multiple instances of Vidoeinfox will cause unwanted behavior with autoplay features." >>  ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.53 Add: Getting Started: added to Home Help." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.52 Edit: A few edits in Home Help." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.51 Change: Shortened message display time on all messages." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: Find Video Screen" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: Playlist Find Screen" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.48 Change: A few options moved around on the home screen." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Play Clipboard blinking dash changed to  *  on all screens." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: Download List >>> Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: First Run >>> Setup" >> ~/.config/videoinfox/videoinfo-ver-history
echo "               Add: VIDEOINFOX WILL KEEP CLEARING OUT INVALID CONTENT FROM THE CLIPBOARD." >> ~/.config/videoinfox/videoinfo-ver-history
echo "                    ANYTHING THAT ISN'T A VIDEO URL OR FILE." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.44 Fix: Resume in View Playlist was broke in the last update." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.43 Update: Some options moved around on the home screen to group playlist features together." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Play Clipboard and Download Only blinking dash were changed to an  *  on the home screen." >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 Remaining screens with the Play Clipboard blinking dash will be changed to an  *  on the next update." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Header in Playlist Find" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Video files available:  changed to  Indexed video files:  in Playlist Find" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.30 Add: Video files available: display to -Playlist Find" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.29 Change: -Default Directories to Playlist  was renamed to  -Index Default Directories" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "             Run -Index Default Directories then delete playlist: Default Directories because it won't be updated anymore." >> ~/.config/videoinfox/videoinfo-ver-history
echo "             This list has been renamed and no longer shows up as a Playlist. If needed, a playlist can be generated from" >> ~/.config/videoinfox/videoinfo-ver-history
echo "             this index. Select -Playlist Find on the home screen and enter  .  to show all then -Make Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Date and time displayed in settings of the last time  -Index Default Directories  was run." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Confirmation prompt for -Clear User Set List in Yt-dlp Menu >>> Download List " >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: -Clear User Set List option letter changed from  Z  to  z" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.25 Update: The loaded playlist was saved when another playlist was loaded. Now the playlist is saved on every edit." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Any edits to a Playlist or the Play Queue will clear the resume marker if one exists." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Fix: Running Last Download when a video was never downloaded would autoplay the download directory." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         MSG: A video has to be downloaded first for this feature to work." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: View Playlist >>> Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.12 Fix: Script errors in -Rename " >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.3.11 New: -Move Block added to -View Playlist and -Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         New: -Remove Block added to -View Playlist and -Play Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: -Rename added to -Change and Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Note: If there is a playlist resume marker, it will be retained when renaming a playlist." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: Home Help Playlist Features: and View Playlist Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.1.08 Fix: Play Queue -Clear Resume y/n prompt." >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.1.07 Change: Default download directory can't be cleared. It can only be changed. " >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 Videoinfox always needs a download directory set for: -Download Only  -Download Choose  -Self Destruct" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 and for downloading the default list in -Download List" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Options moved around in -View Playlist to make room for the next 2 new options." >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 -Play Queue still needs options moved around for the same next 2 new options." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: View Playlist and Play Queue Option:  B - Clear Resume  changed to  b - Clear Resume" >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Confirmation prompt added to -Clear Resume" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: Played List option:  D - Clear Played List  changed to  d - Clear Played List" >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Confirmation prompt added to -Clear Played List" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.1.01 Edit: Home Help Playlist Features:" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history 
echo " v5.1.00 Fix: Most options were accepting 0 as an entry and processing it as 1. This fix was applied globally." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history 
echo "         Fix: Play Queue. Path was removed from listings in options:  - Remove Line  - Move Line " >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Fix: View Playlist >>> Change and Queue >>> Queue List -Rebuild Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo "              Running rebuild queue produced a script error if a playlist was deleted after it was added to the queue." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: Message added to View Playlist >>> Change and Queue -Delete when a loaded playlist is deleted." >> ~/.config/videoinfox/videoinfo-ver-history
echo "         MSG: Loaded playlist was deleted. Default playlist loaded . . ." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: View Playlist -Change and Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 The word Playlist was removed from options:  -Change Playlist  -Create Playlist  -Delete Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history



##################################
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo " v5.0.34 Update: -Play  -Autoplay  -Start  All hide Videoinfox's display to gain more screen space for listings." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Add: There was no way to clear Default Directories (1-4) once they were set. The only option was to provide a" >> ~/.config/videoinfox/videoinfo-ver-history
echo "              valid path to change it. There is now an option to clear a Default Directory where the directories are set." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Update: View Playlist >>> Change and Queue" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 -Change Playlist  -Delete Playlist  -Add to Queue  -Mpv Playlist" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "                 The above 4 options all hide Videoinfox's display to gain more screen space for listings." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: -Mpv Playlist info added. A message displays every time this option is run.">> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Change: View Playlist >>> Change and Queue -Queue List options condensed to one line." >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         Edit: View Playlist -Help" >> ~/.config/videoinfox/videoinfo-ver-history
echo >> ~/.config/videoinfox/videoinfo-ver-history
echo "         More cleaning up of prompts, messages and headers to provide a more consistent user experience.">> ~/.config/videoinfox/videoinfo-ver-history
echo " _________________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo-ver-history
###################################


fi
###########################  END VERSION HISTORY  ################################################################################################ 
##################################################################################################################################################


read -r diratexit < ~/.config/videoinfox/videoinfo.dir-at-exit
cd "$diratexit" 2>/dev/null 

#   The Line below is what gets the Codec & Resolution from a video file.
codecres="ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1"


if [ -f ~/.config/videoinfox/videoinfo.playlist.current ]
  then
      :
  else
      echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current
fi

if [ -f ~/.config/videoinfox/mpvmarker ]
  then
      :
  else
      echo "1" > ~/.config/videoinfox/mpvmarker
fi

read -r dlargue 2>/dev/null < ~/.config/videoinfox/dlargue

##################################################################################################################################################
###########################  HOME LOOP START #####################################################################################################
##################################################################################################################################################

function menuf {

# if set player is mpv: display for  mpv save  notification on home screen and add --save-position-on-quit to mpv options
read -r vplay < ~/.config/videoinfox/videoinfox.video-player
if [[ "$vplay" = 2 ]]
  then    
      read -r mpvsavestat < ~/.config/videoinfox/mpvmarker

      if [[ "$mpvsavestat" = 1 ]]
        then  # mpv will save play position on quit
            mpvmarker="--save-position-on-quit"
            mpvdisplay1=$(echo -e "\033[2mmpv save\033[0m")
        else
            mpvmarker=" "
            mpvdisplay1=" "
      fi
else
    mpvdisplay1=" "
fi


if [ -f ~/.config/videoinfox/videoinfox.intermission ]  # if file exists goto then
  then
      :
  else
      echo "10" > ~/.config/videoinfox/videoinfox.intermission
fi
read -r vto < ~/.config/videoinfox/videoinfox.intermission

# read current playlist 
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp

if [ -f ~/.config/videoinfox/videoinfox.video-player ]
  then
      :
  else
      echo "1" > ~/.config/videoinfox/videoinfox.video-player
fi

if [ -f ~/.config/videoinfox/videoinfox.customplayer.1 ]
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfox.customplayer.1
      echo > ~/.config/videoinfox/videoinfox.customplayer.2
fi

read -r vplaym < ~/.config/videoinfox/videoinfox.video-player
if [[ "$vplaym" = 1 ]]
  then
      defplayer=(ffplay)
      defplayargu=(-fs -autoexit -loglevel quiet) 
elif [[ "$vplaym" = 2 ]]
  then      
      defplayer=(mpv)
      #defplayargu=(--fs --no-terminal --sid=no --save-position-on-quit)
      defplayargu=(--fs --no-terminal --sid=no "$mpvmarker")
elif [[ "$vplaym" = 3 ]]
  then
      read -r cplayer1 < ~/.config/videoinfox/videoinfox.customplayer.1 
      read -r cplayer2 < ~/.config/videoinfox/videoinfox.customplayer.2 
      defplayer=($cplayer1)
      defplayargu=($cplayer2)
fi


pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                        
dirinhome="$PWD" 

#  Load directory from last exit
echo "$dirinhome" > ~/.config/videoinfox/videoinfo.home.dir

grabdirfornav="$PWD"  # Save tree top before entering  NAVIGATE TREE  loop
echo "$grabdirfornav" > ~/.config/videoinfox/videoinfo.navigate-dir-dat
read -r grabdirfornav2 < ~/.config/videoinfox/videoinfo.navigate-dir-dat

clear

#  read last find total file count
read -r searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal

# save date and time of last find
stat -c %y ~/.config/videoinfox/videoinfo.findwork > ~/.config/videoinfox/videoinfo.lastfindtime

# line below  strip tha last 17 characters from <stat> time of file: ~/.config/videoinfox/videoinfo.lastfindtime
cat ~/.config/videoinfox/videoinfo.lastfindtime | awk '{ print substr( $0, 1, length($0)-17 ) }' | cut -c 4- > ~/.config/videoinfox/videoinfo.time
mv ~/.config/videoinfox/videoinfo.time ~/.config/videoinfox/videoinfo.lastfindtime

#  if search total is any number
if [ "$searchtotal" = "" ]  # if the file <~/.config/videoinfox/videoinfo.lastsearchtotal> is empty goto then
  then
      dashj=$(echo "-")  # don't blink dash on home screen @ Play Number
      rm ~/.config/videoinfox/tmp/videoinfo-findwork.tmp 2>/dev/null
      rm ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp 2>/dev/null

      # clear search results
      echo "" > ~/.config/videoinfox/videoinfo.lastsearchtotal
      echo "" > ~/.config/videoinfox/videoinfo.lastfindstring
      echo "" > ~/.config/videoinfox/videoinfo.lastfinddir

  else
      #####dashj=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")  # blink dash on home screen @ Play Number
      dashj=$(echo "~")

# cat ~/.config/videoinfox/videoinfo.findwork

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.findwork > ~/.config/videoinfox/tmp/videoinfo-findwork.tmp 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed 's/.*\///' ~/.config/videoinfox/tmp/videoinfo-findwork.tmp > ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp2 2>/dev/null

# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp2 2>/dev/null


      cat ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp  # display numbered find results    

      echo      
      echo "Dir: "$(cat ~/.config/videoinfox/videoinfo.lastfinddir 2>/dev/null) # display last directory that last find was run from
      echo "Date: "$(cat ~/.config/videoinfox/videoinfo.lastfindtime 2>/dev/null) # display last find time
      echo "Search: "$(cat ~/.config/videoinfox/videoinfo.lastfindstring 2>/dev/null)  # display last find string that was used
      echo "Results: ""$searchtotal"  # number of files found
      

fi


# LOAD DEFAULT DIRECTORIES
read -r dir1 < ~/.config/videoinfox/videoinfo.tv-dir 2> /dev/null
read -r dir2 < ~/.config/videoinfox/videoinfo.movies-dir 2> /dev/null
read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null
read -r dir4 < ~/.config/videoinfox/videoinfo.parent-dir 2> /dev/null
read -r dir5 < ~/.config/videoinfox/videoinfo.dir-at-exit 2> /dev/null

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content                          

##################################################################################
##########  START   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################## 

# DIRECTORY SELECTED IS NORMAL TEXT AND THE OTHER 4 ARE LESS BOLD. 

# DEFAULT DIR NUMBER 1 FORMAT
dirdisplay1=$(echo -e "1\033[2m 2 3 4 5\033[0m")
# DEFAULT DIR NUMBER 2 FORMAT
dirdisplay2=$(echo -e "\033[2m1 \033[0m2 \033[2m3 4 5\033[0m") 
# DEFAULT DIR NUMBER 3 FORMAT
dirdisplay3=$(echo -e "\033[2m1 2 \033[0m3 \033[2m4 5\033[0m")
# DEFAULT DIR NUMBER 4 FORMAT
dirdisplay4=$(echo -e "\033[2m1 2 3 \033[0m4 \033[2m5\033[0m")
# DEFAULT DIR NUMBER 5 FORMAT
dirdisplay5=$(echo -e "\033[2m1 2 3 4 \033[0m5\033[0m")
# NO MATCH ALL LESS BOLD
dirdisplayno=$(echo -e "\033[2m1 2 3 4 5\033[0m")


# FORMAT PWD NAME FOR COMPARISON
echo "$PWD" > ~/.config/videoinfox/videoinfox.pwd.tmp  # write PWD to a tmp file: videoinfox.pwd.tmp
cat ~/.config/videoinfox/videoinfox.pwd.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.pwd  # remove all froward slashes / write file: videoinfox.pwd
rm  ~/.config/videoinfox/videoinfox.pwd.tmp  # remove tmp file: videoinfox.pwd.tmp
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.pwd  # remove horizontal whitespace write file: videoinfox.pwd

# FORMAT DEFAULT DIR 1 NAME FOR COMPARISON
echo "$dir1" > ~/.config/videoinfox/videoinfox.dir1.tmp  # write dir 1 to a tmp file: videoinfox.dir1.tmp
cat ~/.config/videoinfox/videoinfox.dir1.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir1  # remove all froward slashes / write file: videoinfox.dir1
rm ~/.config/videoinfox/videoinfox.dir1.tmp  # remove tmp file: videoinfox.dir1.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir1  # remove horizontal whitespace write file: videoinfox.dir1

# FORMAT DEFAULT DIR 2 NAME FOR COMPARISON
echo "$dir2" > ~/.config/videoinfox/videoinfox.dir2.tmp  # write dir 2 to a tmp file: videoinfox.dir2.tmp
cat ~/.config/videoinfox/videoinfox.dir2.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir2  # remove all froward slashes / write file: videoinfox.dir2
rm ~/.config/videoinfox/videoinfox.dir2.tmp   # remove tmp file: videoinfox.dir2.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir2 # remove horizontal whitespace write file: videoinfox.dir2

# FORMAT DEFAULT DIR 3 NAME FOR COMPARISON
echo "$dirsaved" > ~/.config/videoinfox/videoinfox.dir3.tmp  # write dir 3 to a tmp file: videoinfox.dir3.tmp
cat ~/.config/videoinfox/videoinfox.dir3.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir3  # remove all froward slashes / write file: videoinfox.dir3
rm ~/.config/videoinfox/videoinfox.dir3.tmp   # remove tmp file: videoinfox.dir3.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir3 # remove horizontal whitespace write file: videoinfox.dir3

# FORMAT DEFAULT DIR 4 NAME FOR COMPARISON
echo "$dir4" > ~/.config/videoinfox/videoinfox.dir4.tmp  # write dir 4 to a tmp file: videoinfox.dir4.tmp
cat ~/.config/videoinfox/videoinfox.dir4.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir4  # remove all froward slashes / write file: videoinfox.dir4
rm ~/.config/videoinfox/videoinfox.dir4.tmp   # remove tmp file: videoinfox.dir4.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir4 # remove horizontal whitespace write file: videoinfox.dir4

# FORMAT DEFAULT DIR 5 NAME FOR COMPARISON
echo "$dir5" > ~/.config/videoinfox/videoinfox.dir5.tmp  # write dir 5 to a tmp file: videoinfox.dir5.tmp
cat ~/.config/videoinfox/videoinfox.dir5.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir5  # remove all froward slashes / write file: videoinfox.dir5
rm ~/.config/videoinfox/videoinfox.dir5.tmp   # remove tmp file: videoinfox.dir5.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir5 # remove horizontal whitespace write file: videoinfox.dir5


# LOAD EDITED PWD AND DEFAULT DIRECTORY NAMES FOR BELOW  IF LOOPS   (all frorward slashes / and white spaces removed from the below directory names)

read -r controldir < ~/.config/videoinfox/videoinfox.pwd    # load reformatted current directory name 
read -r dir1display < ~/.config/videoinfox/videoinfox.dir1  # load reformatted default directory 1 name
read -r dir2display < ~/.config/videoinfox/videoinfox.dir2  # load reformatted default directory 2 name
read -r dir3display < ~/.config/videoinfox/videoinfox.dir3  # load reformatted default directory 3 name
read -r dir4display < ~/.config/videoinfox/videoinfox.dir4  # load reformatted default directory 4 name
read -r dir5display < ~/.config/videoinfox/videoinfox.dir5  # load reformatted default directory 5 name


# DEFAULT DIR 5  DISPLAY     IF DIRECTORY ON EXIT  =  DEFAULT DIRECTORIES 1-4 then Display that directory number.

if [[ "$controldir" = "$dir5display" ]]
  then 

      if [[ "$dir5display" = "$dir1display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 1 then display 1 and not 5
        then
             dirdisp="$dirdisplay1"
      fi

      if [[ "$dir5display" = "$dir2display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 2 then display 2 and not 5
        then
             dirdisp="$dirdisplay2"
      fi

      if [[ "$dir5display" = "$dir3display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 3 then display 3 and not 5
        then
             dirdisp="$dirdisplay3"
      fi

      if [[ "$dir5display" = "$dir4display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 4 then display 4 and not 5
        then
             dirdisp="$dirdisplay4"
      fi
fi



# DEFAULT DIR 5 DISPLAY
if [[ "$controldir" = "$dir5display" ]] 
  then
       dirdisp="$dirdisplay5"  # if directory is changed to  Default Dir 5 :  The number 5 is normal text and the other 4 are less bold.
        
  else
       dirdisp="$dirdisplayno" # if directory doesn't match  Default Dirs 1-5 : All 5 numbers are less bold.  
fi 



# DEFAULT DIR 1  DISPLAY
if [[ "$controldir" = "$dir1display" ]]  # IF PWD = DEFAULT DIR 1 then display 1
  then 
       dirdisp="$dirdisplay1"
fi

# DEFAULT DIR 2  DISPLAY
if [[ "$controldir" = "$dir2display" ]]  # IF PWD = DEFAULT DIR 2 then display 2
  then 
       dirdisp="$dirdisplay2"
fi

# DEFAULT DIR 3  DISPLAY
if [[ "$controldir" = "$dir3display" ]]  # IF PWD = DEFAULT DIR 3 then display 3
  then 
       dirdisp="$dirdisplay3"
fi

# DEFAULT DIR 4  DISPLAY
if [[ "$controldir" = "$dir4display" ]]  # IF PWD = DEFAULT DIR 4 then display 4
  then 
       dirdisp="$dirdisplay4"  # if directory is changed to  Default Dir 4 :  The number 4 is normal text and the other 4 are less bold.
fi

################################################################################
##########  END   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################


# CHECKING FOR VIDEOS IN CURRENT DIRECTORY.  if video(s) exist:  the dash @ Play Directory will blink on the home screen
dovideosexist=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)

if [ $dovideosexist -ne 0 ]  # If the find result doesn't =   0   goto then
  then 
      dash=$(echo "~")  
  else
      dash=$(echo "-")  
fi

echo
echo "Directory: ""$PWD"
echo "Playlist: ""$setplaylist"

##################################################################################################################################################

#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY

##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      echo
      echo "Clipboard: ""$pasteclip"
  else
      :
fi


if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  # if yt-dlp couldn't extract a name goto then
                  then
  
                  echo "" | xclip -sel clip  # clearing out the clipboard
                  pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                
echo "___________________________________________________________________________________________________________________"
echo 
echo " $der $viv4      Enter - Update Clipboard Display                "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________"
echo
echo " f - Find Video        n - Navigate Tree     t - Playlist Find     p - Play Clipboard     y - Yt-dlp      e - Exit"
echo " a - Show All          g - Find Dir          s - View Playlist     r - Download Only      x - Clrclp      u - Set" 
echo " c - Clear Results     l - Last Download     k $dashj Playlist Add      d $dash Play Directory     i $dashj Info        h - Help"
echo -e " m - More Options      v - Played List       z $dashj Make Playlist     o $dashj Autoplay           j $dashj Play        $mpvdisplay1"
echo        
                  
                  else  # yt-dlp extracted a filename
echo "YT-DLP Confirmed: "$ytdlpconfirm""
echo "Download Directory: $dirsaved"  # dislpay default download directory
echo "___________________________________________________________________________________________________________________"
echo 
echo " $der $viv4      Enter - Update Clipboard Display                "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________"
echo
echo " f - Find Video        n - Navigate Tree     t - Playlist Find     p * Play Clipboard     y - Yt-dlp      e - Exit"
echo " a - Show All          g - Find Dir          s - View Playlist     r * Download Only      x - Clrclp      u - Set" 
echo " c - Clear Results     l - Last Download     k $dashj Playlist Add      d $dash Play Directory     i $dashj Info        h - Help"
echo -e " m - More Options      v - Played List       z $dashj Make Playlist     o $dashj Autoplay           j $dashj Play        $mpvdisplay1"
echo                                                        
            fi
    else

if [ -f "$pasteclip" ]  #  if file exists goto <then>
 then
echo      
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo
echo " $der $viv4      Enter - Update Clipboard Display                "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________"
echo
echo " f - Find Video        n - Navigate Tree     t - Playlist Find     p * Play Clipboard     y - Yt-dlp      e - Exit"
echo " a - Show All          g - Find Dir          s - View Playlist     r - Download Only      x - Clrclp      u - Set" 
echo " c - Clear Results     l - Last Download     k $dashj Playlist Add      d $dash Play Directory     i $dashj Info        h - Help"
echo -e " m - More Options      v - Played List       z $dashj Make Playlist     o $dashj Autoplay           j $dashj Play        $mpvdisplay1"
echo                                                                          

  else  # file does not exist

echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

echo "___________________________________________________________________________________________________________________"
echo 
echo " $der $viv4      Enter - Update Clipboard Display                "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________"
echo
echo " f - Find Video        n - Navigate Tree     t - Playlist Find     p - Play Clipboard     y - Yt-dlp      e - Exit"
echo " a - Show All          g - Find Dir          s - View Playlist     r - Download Only      x - Clrclp      u - Set" 
echo " c - Clear Results     l - Last Download     k $dashj Playlist Add      d $dash Play Directory     i $dashj Info        h - Help"
echo -e " m - More Options      v - Played List       z $dashj Make Playlist     o $dashj Autoplay           j $dashj Play        $mpvdisplay1"
echo 

fi
fi

echo -en " Enter Option: "
read -r -n1 optionf

}

     while true
     do
     menuf
     case $optionf in


h)  # HELP
     #clear
     less ~/.config/videoinfox/videoinfo.help  # This help file is recreated on every start
     ;;	


##################################################################################################################################################
t)  ################  @ PLAYLIST FIND ROUTINE - <HOME>  ######################$$$#################################################################
##################################################################################################################################################

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

find ~/.config/videoinfox/playlists -type f -iname "vplaylist.*" | xargs -d '\n' grep -i -h "." > ~/.config/videoinfox/tmp/search-playlist.tmp.display 2> /dev/null
find ~/.config/videoinfox/playlists -type f -iname "v-index.*" | xargs -d '\n' grep -i -h "." >> ~/.config/videoinfox/tmp/search-playlist.tmp.display 2> /dev/null
# REMOVE DUPES
cat -n ~/.config/videoinfox/tmp/search-playlist.tmp.display | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/search-playlist.tmp.display2
totalplvideos=$(wc -l ~/.config/videoinfox/tmp/search-playlist.tmp.display2 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT

    clear
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " ""$ver"" >>> PLAYLIST FIND >>> Indexed files:" "$totalplvideos" 
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " Search all playlists and the default directories index.                                       Enter . to Show All"
    echo " Enter a keyword from a path or file. Case ignored. No wildcard *"
    echo
    read -r -p " Search: " videofind  # waiting fot user input - video file that you want to find

find ~/.config/videoinfox/playlists -type f -iname "vplaylist.*" | xargs -d '\n' grep -i -h "$videofind" > ~/.config/videoinfox/tmp/search-playlist.tmp 2> /dev/null

find ~/.config/videoinfox/playlists -type f -iname "v-index.*" | xargs -d '\n' grep -i -h "$videofind" >> ~/.config/videoinfox/tmp/search-playlist.tmp 2> /dev/null

    # REMOVE DUPES
    cat -n ~/.config/videoinfox/tmp/search-playlist.tmp | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/search-playlist.tmp2
    # COUNT LINES
    searchtotal=$(wc -l < ~/.config/videoinfox/tmp/search-playlist.tmp2)

        if [ -z "$videofind" ]
          then
              echo
              echo " Nothing was entered . . ."
              echo
              sleep .4 
          else                                                                                   	
              if echo "$videofind" | grep "/" > /dev/null
                then
                    echo
                    echo " No directories only filenames . . ."
                    echo
                    sleep .7 
                else
                                
                     if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>      
                       then
                           echo
                           echo " No files found . . ."
                           echo
                           sleep .4 
                       else

                           echo "$videofind" > ~/.config/videoinfox/videoinfo.lastfindstring   # save last find string used                          
                           read -r fterm < ~/.config/videoinfox/videoinfo.lastfindstring

                           # save find results
                           cp ~/.config/videoinfox/tmp/search-playlist.tmp2 ~/.config/videoinfox/videoinfo.findwork
                           echo "Playlists and Default Directories Index" > ~/.config/videoinfox/videoinfo.lastfinddir  #  
                           # write last search total file count
                           echo "$searchtotal" > ~/.config/videoinfox/videoinfo.lastsearchtotal
                           # read last search total file count
                           read -r searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal  
  
                           cp ~/.config/videoinfox/videoinfo.findwork ~/.config/videoinfox/videoinfo.findwork3
                           cp ~/.config/videoinfox/videoinfo.lastsearchtotal ~/.config/videoinfox/videoinfo.lastsearchtotal2                 
                           echo
                           echo " Total files found: " "$searchtotal"  # number of files found
                           "$vnotify" "Videoinfox messsage: Playlist Find Results" "$searchtotal files found using search term: $fterm"
                           sleep .4
    fi
    fi
    fi              
    ;;


r)  # DOWNLOAD ONLY (default)
grabdir="$PWD"
read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
cd "$dirsaved"  # change to download directory
 
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content              
grabpaste3=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabpaste3" = "http" ]  # if the 4 characters = <http> go then
then                  
clear  
~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
# remove first dot and everything after it in filename. file names with dots before the extension were breking find results
sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

# remove first [ and everything after it in filename. this was done because file names with [ 
sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

# rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload
      
read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download video file
              
"$vnotify" "Videoinfox messsage: YT-DLP done downloading . . ." "$lastdownload"
              
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

            
else 
echo
echo
echo " Clipboard is empty or contained invalid video url . . ."
sleep 1
fi
              
cd "$grabdir"
;;


z) # MAKE PLAYLIST

# ARE SEARCH RESULTS EMPTY
read -r isresultsempty < ~/.config/videoinfox/videoinfo.findwork
if [ -z "$isresultsempty" ]
then
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1
else
clear
echo
echo " Save all search results as a Playlist."
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read -r createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp
plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cat ~/.config/videoinfox/videoinfo.findwork > ~/.config/videoinfox/videoinfo.playlist  # WRITE SEARCH RESULTS TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cat ~/.config/videoinfox/videoinfo.findwork > "$plname"  # WRITE SEARCH RESULTS TO THE PLAYLIST DIRECTORY
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: "$plname""
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cat ~/.config/videoinfox/videoinfo.findwork > "$plname"  # WRITE RECURSIVE SEARCH RESULTS TO PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
fi
;; 


g)  # FIND DIRECTORY
clear
echo
echo "Directory: ""$PWD"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$ver"" >>> FIND DIRECTORY                 Enter only to quit                             * - Show All"
echo "___________________________________________________________________________________________________________________" 
echo
echo " The directory enterd must be recursively reachable from the current directory."
echo
read -r -p " Directory Name: " dirfind  # waiting fot user input - dierectory that you want to find
linecount=$(find . -type d -iname "$dirfind" 2>/dev/null | wc -l)   # number of files found
                                                                                    	
if [ -z "$dirfind" ]  # if no input was entered goto  <then>  
then
echo
echo " Nothing was entered . . ."  
sleep .4
else               
     if echo "$dirfind" | grep "/" > /dev/null # if any slashes were entered goto <then>
     then
     echo
     echo " No slashes. Directory name only."
     sleep .7  
     else
     echo
     find . -type d -iname "$dirfind" | sort -u > ~/.config/videoinfox/tmp/finthedir.tmp 2>/dev/null  # directory(s) found

     # CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/finthedir.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/finthedir.numberlist.tmp 2>/dev/null
   
     cat ~/.config/videoinfox/tmp/finthedir.numberlist.tmp
     echo
     echo "Total Directories Found:" "$linecount"  # number of files found
     sleep .4         
	    if [ "$linecount" = 0 ]  # if find returned no results goto <then>
	    then
	        :
	    else
              echo
read -r -p "Enter line number to change directory: " linenumber  # waiting fot user input
              if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
              then
              :
              else
              if [[ $linenumber -gt $linecount ]]
              then 
              echo
              echo " Number out of range . . ."
              sleep .4
              else
tail -n +"$linenumber" ~/.config/videoinfox/tmp/finthedir.tmp > ~/.config/videoinfox/tmp/finthedir.tmp2 2>/dev/null
              OLDIFS=$IFS
              IFS=$'\n'
              read line < ~/.config/videoinfox/tmp/finthedir.tmp2
              cd "$line" 2> /dev/null
              IFS=$OLDIFS
fi
fi
fi
fi
fi              
;;


e)   # EXIT  
     echo "$PWD" > ~/.config/videoinfox/videoinfo.dir-at-exit  # SAVE DIRECTORY AT EXIT
     #rm ~/.config/videoinfox/tmp/* 
     read -r lsearch < ~/.config/videoinfox/videoinfo.lastsearch-set  # load last search setting
     
if [ "$lsearch" = 1 ]  # ALWAYS SAVE
  then
      :
fi


if [ "$lsearch" = 2 ]  # NEVER SAVE
  then     
     # CLEAR FIND RESULTS 
     echo " " > ~/.config/videoinfox/videoinfo.lastsearchtotal
     echo " " > ~/.config/videoinfox/videoinfo.lastfindstring
     echo " " > ~/.config/videoinfox/videoinfo.lastfinddir

     echo > ~/.config/videoinfox/videoinfo.findwork


fi


if [ "$lsearch" = 3 ]  # ASK TO SAVE
  then         
         function menuq {
         clear
         echo -e "\n"
         echo
         echo "___________________________________________________________________________________________________________________"  
         echo
         echo " $der >>> LAST SEARCH"
         echo "___________________________________________________________________________________________________________________" 
         echo        
         echo -en " 1 - Save Search Results     2 - Clear Search Results "
         read -r -n1 optionq
         echo
         }
              
         while true
         do
         menuq
	   case $optionq in
         
  
         1)  # DO NOTHING SEARCH IS ALREADY SAVED
         
         break
         ;;


         2) # CLEAR FIND RESULTS
         echo " " > ~/.config/videoinfox/videoinfo.lastsearchtotal
         echo " " > ~/.config/videoinfox/videoinfo.lastfindstring
         echo " " > ~/.config/videoinfox/videoinfo.lastfinddir

         echo > ~/.config/videoinfox/videoinfo.findwork

         break;;

*)

esac
done

fi

 
clear
echo -e "\n"
echo
echo "___________________________________________________________________________________________________________________"  
echo
echo " $der >>> EXIT"
echo "___________________________________________________________________________________________________________________" 
echo
echo
echo " Directory saved for next run:" "$PWD"
sleep .7
break ;;


o)
##################################################################################################################################################
###########################   AUTOPLAY LINE  o   <HOME>  #########################################################################################
##################################################################################################################################################
read -r vto < ~/.config/videoinfox/videoinfox.intermission  # read intermission setting

if [ -f ~/.config/videoinfox/tmp/videoinfo-findwork.tmp ]
  then
      clear
      cat ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp
      echo
      read -r -p "Autoplay: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else

# write new list starting with selected line   
tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-findwork.tmp > ~/.config/videoinfox/tmp/videoinfo-home-autoplay.tmp 2>/dev/null
input="$HOME""/.config/videoinfox/tmp/videoinfo-home-autoplay.tmp" # video list for play loop
OLDIFS=$IFS
IFS=$'\n'
i=0

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> SEARCH RESULTS >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null # PLAY VIDEO

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo-home-autoplay.tmp > ~/.config/videoinfox/tmp/videoinfox-nextup.tmp 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox-nextup.tmp
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then
      break
fi

done

fi

IFS=$OLDIFS

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1
fi
;;


j)
##################################################################################################################################################
###########################   PLAY LINE  j   <HOME>  #############################################################################################
##################################################################################################################################################

if [ -f ~/.config/videoinfox/tmp/videoinfo-findwork.tmp ]  # if file exists goto then
  then
      clear
      cat ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp
      echo
      read -r -p "Play: " linenumber  # waiting fot user input

      # create file moving selected line number to the top
      tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-findwork.tmp > ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null
      
      # read first line of file for play
      read playnumber < ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp

      if [ -z "$playnumber" ]
          then
              :

          else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> SEARCH RESULTS >>> PLAY" 
      echo
      echo " [PLAYING]>" "$playnumber"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo

      # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$playnumber" |  awk -F '/' '{print $NF}')  
  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"      

      echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$playnumber" 2>/dev/null  # play video
      rm ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null

     fi
     fi

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1

fi

;;


n)
##################################################################################################################################################
###########################   (@NAVIGATE TREE)  n  ###############################################################################################
##################################################################################################################################################

pasteclip2=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content   save to restore on option quit
#echo "" | xclip -sel clip  # clearing the clipboard


function navtree {

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content


clear

# recursive list of directories for the user: enter line number to change to that directory
####find "$PWD" -type d -iname "*" | sort -u 2>/dev/null

find "$PWD" -type d -iname "*" | sort -u > ~/.config/videoinfox/tmp/nt-list.tmp 2>/dev/null


# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/nt-list.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/nt-list-number.tmp 2>/dev/null

cat ~/.config/videoinfox/tmp/nt-list-number.tmp


# recursive number of directories found
ttotal=$(find  "$PWD" -type d -iname "*" 2>/dev/null | wc -l)   

"$vnotify" "Videoinfox is done processing: Directory Tree" "Total Directories Found: "$ttotal" " # GUI Notification.

# recursive number of files found
ttotalnum=$(find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)


##################################################################################
##########  START   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################## 

# DIRECTORY SELECTED IS NORMAL TEXT AND THE OTHER 4 ARE LESS BOLD. 

# DEFAULT DIR NUMBER 1 FORMAT
dirdisplay1=$(echo -e "1\033[2m 2 3 4 5\033[0m")
# DEFAULT DIR NUMBER 2 FORMAT
dirdisplay2=$(echo -e "\033[2m1 \033[0m2 \033[2m3 4 5\033[0m") 
# DEFAULT DIR NUMBER 3 FORMAT
dirdisplay3=$(echo -e "\033[2m1 2 \033[0m3 \033[2m4 5\033[0m")
# DEFAULT DIR NUMBER 4 FORMAT
dirdisplay4=$(echo -e "\033[2m1 2 3 \033[0m4 \033[2m5\033[0m")
# DEFAULT DIR NUMBER 5 FORMAT
dirdisplay5=$(echo -e "\033[2m1 2 3 4 \033[0m5\033[0m")
# NO MATCH ALL LESS BOLD
dirdisplayno=$(echo -e "\033[2m1 2 3 4 5\033[0m")


# FORMAT PWD NAME FOR COMPARISON
echo "$PWD" > ~/.config/videoinfox/videoinfox.pwd.tmp  # write PWD to a tmp file: videoinfox.pwd.tmp
cat ~/.config/videoinfox/videoinfox.pwd.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.pwd  # remove all froward slashes / write file: videoinfox.pwd
rm  ~/.config/videoinfox/videoinfox.pwd.tmp  # remove tmp file: videoinfox.pwd.tmp
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.pwd  # remove horizontal whitespace write file: videoinfox.pwd

# FORMAT DEFAULT DIR 1 NAME FOR COMPARISON
echo "$dir1" > ~/.config/videoinfox/videoinfox.dir1.tmp  # write dir 1 to a tmp file: videoinfox.dir1.tmp
cat ~/.config/videoinfox/videoinfox.dir1.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir1  # remove all froward slashes / write file: videoinfox.dir1
rm ~/.config/videoinfox/videoinfox.dir1.tmp  # remove tmp file: videoinfox.dir1.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir1  # remove horizontal whitespace write file: videoinfox.dir1

# FORMAT DEFAULT DIR 2 NAME FOR COMPARISON
echo "$dir2" > ~/.config/videoinfox/videoinfox.dir2.tmp  # write dir 2 to a tmp file: videoinfox.dir2.tmp
cat ~/.config/videoinfox/videoinfox.dir2.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir2  # remove all froward slashes / write file: videoinfox.dir2
rm ~/.config/videoinfox/videoinfox.dir2.tmp   # remove tmp file: videoinfox.dir2.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir2 # remove horizontal whitespace write file: videoinfox.dir2

# FORMAT DEFAULT DIR 3 NAME FOR COMPARISON
echo "$dirsaved" > ~/.config/videoinfox/videoinfox.dir3.tmp  # write dir 3 to a tmp file: videoinfox.dir3.tmp
cat ~/.config/videoinfox/videoinfox.dir3.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir3  # remove all froward slashes / write file: videoinfox.dir3
rm ~/.config/videoinfox/videoinfox.dir3.tmp   # remove tmp file: videoinfox.dir3.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir3 # remove horizontal whitespace write file: videoinfox.dir3

# FORMAT DEFAULT DIR 4 NAME FOR COMPARISON
echo "$dir4" > ~/.config/videoinfox/videoinfox.dir4.tmp  # write dir 4 to a tmp file: videoinfox.dir4.tmp
cat ~/.config/videoinfox/videoinfox.dir4.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir4  # remove all froward slashes / write file: videoinfox.dir4
rm ~/.config/videoinfox/videoinfox.dir4.tmp   # remove tmp file: videoinfox.dir4.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir4 # remove horizontal whitespace write file: videoinfox.dir4

# FORMAT DEFAULT DIR 5 NAME FOR COMPARISON
echo "$dir5" > ~/.config/videoinfox/videoinfox.dir5.tmp  # write dir 5 to a tmp file: videoinfox.dir5.tmp
cat ~/.config/videoinfox/videoinfox.dir5.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir5  # remove all froward slashes / write file: videoinfox.dir5
rm ~/.config/videoinfox/videoinfox.dir5.tmp   # remove tmp file: videoinfox.dir5.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir5 # remove horizontal whitespace write file: videoinfox.dir5


# LOAD EDITED PWD AND DEFAULT DIRECTORY NAMES FOR BELOW  IF LOOPS   (all frorward slashes / and white spaces removed from the below directory names)

read -r controldir < ~/.config/videoinfox/videoinfox.pwd    # load reformatted current directory name 
read -r dir1display < ~/.config/videoinfox/videoinfox.dir1  # load reformatted default directory 1 name
read -r dir2display < ~/.config/videoinfox/videoinfox.dir2  # load reformatted default directory 2 name
read -r dir3display < ~/.config/videoinfox/videoinfox.dir3  # load reformatted default directory 3 name
read -r dir4display < ~/.config/videoinfox/videoinfox.dir4  # load reformatted default directory 4 name
read -r dir5display < ~/.config/videoinfox/videoinfox.dir5  # load reformatted default directory 5 name


# DEFAULT DIR 5  DISPLAY     IF DIRECTORY ON EXIT  =  DEFAULT DIRECTORIES 1-4 then Display that directory number.

if [[ "$controldir" = "$dir5display" ]]
  then 

      if [[ "$dir5display" = "$dir1display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 1 then display 1 and not 5
        then
             dirdisp="$dirdisplay1"
      fi

      if [[ "$dir5display" = "$dir2display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 2 then display 2 and not 5
        then
             dirdisp="$dirdisplay2"
      fi

      if [[ "$dir5display" = "$dir3display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 3 then display 3 and not 5
        then
             dirdisp="$dirdisplay3"
      fi

      if [[ "$dir5display" = "$dir4display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 4 then display 4 and not 5
        then
             dirdisp="$dirdisplay4"
      fi
fi



# DEFAULT DIR 5 DISPLAY
if [[ "$controldir" = "$dir5display" ]] 
  then
       dirdisp="$dirdisplay5"  # if directory is changed to  Default Dir 5 :  The number 5 is normal text and the other 4 are less bold.
        
  else
       dirdisp="$dirdisplayno" # if directory doesn't match  Default Dirs 1-5 : All 5 numbers are less bold.  
fi 



# DEFAULT DIR 1  DISPLAY
if [[ "$controldir" = "$dir1display" ]]  # IF PWD = DEFAULT DIR 1 then display 1
  then 
       dirdisp="$dirdisplay1"
fi

# DEFAULT DIR 2  DISPLAY
if [[ "$controldir" = "$dir2display" ]]  # IF PWD = DEFAULT DIR 2 then display 2
  then 
       dirdisp="$dirdisplay2"
fi

# DEFAULT DIR 3  DISPLAY
if [[ "$controldir" = "$dir3display" ]]  # IF PWD = DEFAULT DIR 3 then display 3
  then 
       dirdisp="$dirdisplay3"
fi

# DEFAULT DIR 4  DISPLAY
if [[ "$controldir" = "$dir4display" ]]  # IF PWD = DEFAULT DIR 4 then display 4
  then 
       dirdisp="$dirdisplay4"  # if directory is changed to  Default Dir 4 :  The number 4 is normal text and the other 4 are less bold.
fi

################################################################################
##########  END   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################


########## blinking routines for display ##########

# not blinking Play Directory
playdir1=$(echo "Play Directory")
# blinking Play Directory
playdir2=$(echo -e "\033[5mPlay Directory\033m\033[0m\033[5m\033[5m\033[0m")

# not blinking dash
dash0=$(echo "-")
# blinking dash
dash1=$(echo "~")


# get file count of videos one directory deep for blinking   Play Directory
blinkit=$(find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)

# if find results are zero goto then
if [ "$blinkit" = 0 ]
  then
      blinkit2="$playdir1"  # zero files. non bliking  Playdirectory
      bdash="$dash0"
  else
      blinkit2="$playdir2" # not zero files. blinking  Play Directory
      bdash="$dash1"
fi


# not blinking
changedir1=$(echo "Change Directory")
# blinking
changedir2=$(echo -e "\033[5mChange Directory\033m\033[0m\033[5m\033[5m\033[0m")

# if directory exists goto then
if [ -d "$pasteclip" ]
  then
      changedir3="$changedir2"  # if the directory exists, blinking  Change Directory
  else
      changedir3="$changedir1"  # if the directory doesn't exist, non blinking  Change Directory
fi
########## end blinking routines ################## 


echo
echo "Treetop:" "$grabdirfornav2"
echo "Total Directories: "$ttotal" "
echo "Total Video Files:" "$ttotalnum"                                                               	                                         
echo
echo "Current Directory:" "$PWD"
echo "Video Files:" "$blinkit"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$der"" >>> NAVIGATE TREE          Video listing only 1 level deep            "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________" 
echo
echo " c - Change Directory     a "$bdash" Show All     d "$bdash" Play Directory     n - Change Treetop                      q - Quit"
echo " u - Up One Level                                                 g - Find Directory"
echo " t - Treetop                                                                                              h - Help"
echo   
echo -en " Enter Option: "
read -r -n1 option
echo
}
  
         while true
         do
         navtree
	    case $option in
         
         q)  # QUIT
         break
         ;;


         h)
         echo
         echo
         echo " NAVIGATE TREE >>> HELP"        
         echo
         echo " Whatever the directory is when entering Navigate Tree will be set as the Treetop."
         echo " Recursive Navigation from the Treetop. Directory listing is only 1 level deep."
         echo
         echo " While in Navigate Tree, there are two ways to change the treetop. Defaults Dirs and Change Treetop"
         echo 
         echo " *** Directory To Playlist is located in Show All. Add all videos in the current directory to a new playlist."
         echo
         echo
         read -p " Press enter to continue . . ."
         ;;


         g)  # FIND DIRECTORY
clear
echo
echo "Directory: ""$PWD"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$ver"" >>> FIND DIRECTORY                 Enter only to quit                             * - Show All"
echo "___________________________________________________________________________________________________________________"
echo
echo " The directory enterd must be recursively reachable from the current directory."
echo
read -r -p " Directory Name: " dirfind  # waiting fot user input - dierectory that you want to find
linecount=$(find . -type d -iname "$dirfind" 2>/dev/null | wc -l)   # number of files found
                                                                                    	
if [ -z "$dirfind" ]  # if no input was entered goto  <then>  
then
echo
echo " Nothing was entered . . ."  
sleep .4
else               
     if echo "$dirfind" | grep "/" > /dev/null # if any slashes were entered goto <then>
     then
     echo
     echo " No slashes. Directory name only . . ."
     sleep .4  
     else
     echo
     find . -type d -iname "$dirfind" | sort -u > ~/.config/videoinfox/tmp/finthedir.tmp 2>/dev/null  # directory(s) found

     # CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/finthedir.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/finthedir.numberlist.tmp 2>/dev/null
   
     cat ~/.config/videoinfox/tmp/finthedir.numberlist.tmp
     echo
     echo "Total Directories Found:" "$linecount"  # number of files found
     sleep .4         
	    if [ "$linecount" = 0 ]  # if find returned no results goto <then>
	    then
	         :
	    else
              echo
read -r -p "Enter line number to change directory: " linenumber  # waiting fot user input
              if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
              then
              :
              else
              if [[ $linenumber -gt $linecount ]]
              then 
              echo
              echo " Number out of range . . ."
              sleep .7
              else
tail -n +"$linenumber" ~/.config/videoinfox/tmp/finthedir.tmp > ~/.config/videoinfox/tmp/finthedir.tmp2 2>/dev/null
              OLDIFS=$IFS
              IFS=$'\n'
              read line < ~/.config/videoinfox/tmp/finthedir.tmp2
              cd "$line" 2> /dev/null
              IFS=$OLDIFS
fi
fi
fi
fi
fi              
;;

         1)  # CD DIRECTORY TO TV    
          
         grabdirfornav2="$dir1"
         cd "$dir1"
         ;;
    
         2)  # CD DIRECTORY TO MOVIES
         grabdirfornav2="$dir2"
         cd "$dir2" 
         ;;

         3)  # CHANGE DIRECTORY TO DOWNLOADS
         grabdirfornav2="$dirsaved"
         cd "$dirsaved" 
         ;;
   
         4)  # CHANGE DIRECTORY TO EXTRA   
         grabdirfornav2="$dir4"
         cd "$dir4" 
         ;;

         5)  # CHANGE DIRECTORY TO LAST EXIT
         grabdirfornav2="$dir5"
         cd "$dir5" 
         ;;
       
       
         u)  # UP ONE LEVEL 
         if [ "$grabdirfornav2" = "$PWD" ]  # when   Up One Level   reaches the    Treetop    no   cd..   out of the parent directory 
           then
               echo
               echo " At treetop. Can't go any higher . . ."
               sleep .4

           else
               cd .. &>/dev/null
         fi 
         ;;
        

         t)  # TREE TOP
         cd "$grabdirfornav2" &>/dev/null
         ;;          


         c)  # CHANGE DIRECTORY
# GETTING LINECOUNT
linecount=$(wc -l ~/.config/videoinfox/tmp/nt-list.tmp | cut -d' ' -f1)

echo
read -r -p " Enter line number to change directory: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else


if [[ $linenumber -gt $linecount ]]
  then 
      echo
      echo " Number out of range . . ."
      sleep .4
  else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/nt-list.tmp > ~/.config/videoinfox/tmp/nt-list.tmp2 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/nt-list.tmp2

      cd "$line" 2> /dev/null
 
      IFS=$OLDIFS
  
      fi
      fi
;;

        
         ########################################################################################################################################
         d)  # (@PLAY DIRECTORY) NAV TREEE  #####################################################################################################
         ########################################################################################################################################
rm ~/.config/videoinfox/tmp/videoinfox.numbered-navtree-play-directory-list 2>/dev/null

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa 2>/dev/null


#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-navtree-play-directory-list 2>/dev/null

   
else 
    :
fi


if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-navtree-play-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-navtree-play-directory-list 2>/dev/null

linenumber=1

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa 2>/dev/null

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> NAVIGATE TREE >>> PLAY DIRECTORY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " QVideo Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox.navtree-play-directory-apa-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done
 
IFS=$OLDIFS

else
     echo
     echo " No video files in the current directory . . ."
     sleep .7
fi
;;           


         ########################################################################################################################################
         n)  # CHANGE TREETOP (NAVIGATE TREE)  ##################################################################################################
         ########################################################################################################################################

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo
echo " $ver >>> CHANGE TREETOP"
echo "___________________________________________________________________________________________________________________"
echo
echo " No quotations needed for paths with spaces. Case sensative."
echo 
echo " Enter directory or paste directory if in clipboard."
echo
read -r -p " " specifydir  # waiting fot user input - the directory you want to chang to 
	
	if [ -z "$specifydir" ]  # if no input was entered goto  <then> 
          then
               echo " Nothing was entered . . ."
               sleep .4
          else
              if [ -d "$specifydir" ]  #  if directoty exists goto  <then>
                then
                     echo
                     grabdirfornav2="$specifydir"
                     cd "$specifydir"   # change the directory
                     echo " Treetop changed to: $PWD"  # <pwd>  print current working directory to the screen
                     sleep .7                   
                else
                     echo
                     echo " No such directory . . ."
                     sleep .4                   
              fi
      fi       
echo

;;


         ########################################################################################################################################
         a)  # SHOW ALL (NAVIGATE TREE)  ########################################################################################################
         ########################################################################################################################################

#checking for videos in the current directory.  if no videos exist,   Play Directory   won't execute
dovideosexist=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)


if [ $dovideosexist -ne 0 ]  # If the find result doesn't =   0   goto then
  then  # IF VIDEOS EXIST IN THE CURRENT DIRECTORY THEN RUN PLAY LINE

function ntplaynum {

# read current playlist 
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null
     :    
fi


clear

if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
   else
        echo
        echo " No video files in the current directory . . ."
fi

echo
echo "Directory: ""$PWD"
echo "Playlist: ""$setplaylist"
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> NAVIGATE TREE >>> SHOW ALL"
echo "___________________________________________________________________________________________________________________" 
echo
echo " o - Autoplay     s - View Playlist     z - Make Playlist                                                 q - Quit"
echo " j - Play         k - Playlist Add"
echo " i - Info"
echo
echo -en " Enter Option: "
read -r -n1 optionaplist
}

while true
do
ntplaynum
case $optionaplist in


q) # QUIT
   rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null
   rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null
   rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
   rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null 
   break;;


z) # DIRECTORY TO PAYLIST
clear
echo
echo " Directory to Playlist:" "$PWD"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cat ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > ~/.config/videoinfox/videoinfo.playlist  # WRITE DIR TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cat ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > "$plname"  # WRITE DIRECTORY TO THE PLAYLIST DIRECTORY
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cat ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > "$plname"  # WRITE RECURSIVE SEARCH RESULTS TO PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
;; 

     i)  # INFO - NAVIGATE TREE >>> SHOW ALL
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else

            if [ -f ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null
                         

             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-ap

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       ######rm ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null

                 fi
fi
        else
            echo
            echo
            echo " Select Show All or use Find to access this feature . . ."
            sleep 1


            fi

      fi
;;


########################################################################################################################################
         j)  # PLAY LINE - SHOW ALL (NAVIGATE TREE)  ###################################################################################
########################################################################################################################################

#checking for videos in the current directory.  if no videos exist,   Play Directory   won't execute
dovideosexist=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)


if [ $dovideosexist -ne 0 ]  # If the find result doesn't =   0   goto then
  then  # IF VIDEOS EXIST IN THE CURRENT DIRECTORY THEN RUN PLAY LINE

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null    
fi


# clear

if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list ]
   then
        : #cat ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
   else
        echo
        echo " No videos in the current directory . . ."
fi


# GETTING LINECOUNT
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa | cut -d' ' -f1)

clear
cat ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list
echo
read -r -p "Play: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else




tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa

if [ -z "$line" ]

  then
      :

  else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> NAVIGATE TREE >>> PLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."

      echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist  # write to the played list
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line" 
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
      IFS=$OLDIFS

      rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null
      rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa2 2>/dev/null
      rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list 2>/dev/null
      rm ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa-work 2>/dev/null 
         
 
      fi
      fi
      fi

else
    echo
    echo " No video files in the current directory . . ."
    sleep .4
fi
;;


########################################################################################################################################
k)  # SHOW ALL - PLAYLIST ADD (NAVIGATE TREE)  ############################################################################################
########################################################################################################################################

#checking for videos in the current directory.
dovideosexist=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)


if [ $dovideosexist -ne 0 ]  # If the find result doesn't =   0   goto then
  then  # IF VIDEOS EXIST IN THE CURRENT DIRECTORY 

########################################################################################################################function ntplaylistaddnavnum {

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-playlistaddnav-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0 
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN playlistaddnavED LIST TO VARIABLE: $moddedplaylistaddnavedlist 
moddedplaylistaddnavedlist="$HOME""/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa"

#  playlistaddnavED LIST INPUT FOR LOOP
input="$moddedplaylistaddnavedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES


#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-nt-playlistaddnav-directory-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-playlistaddnav-directory-list 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa-work 2>/dev/null    
fi


clear

if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-nt-playlistaddnav-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-nt-playlistaddnav-directory-list 2>/dev/null
   else
        echo
        echo " No videos in the current directory . . ."
fi


# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplnt.tmp 
read -r whatplnt < ~/.config/videoinfox/tmp/whatplnt.tmp
rm ~/.config/videoinfox/tmp/whatplnt.tmp

echo 
read -r -p "Add video to playlist $whatplhome: " linenumber  # waiting fot user input

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa > ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa.tmp 2>/dev/null

#####
# GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa | cut -d' ' -f1)
#####

mv ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null



if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then 
      :

  else

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else

if [ "$linenumber" = 0 ]
  then
      :
  else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else



OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa

if [ -z "$linenumber" ]
  then
      :
  else
read -r hspa < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay 
if [ -z "$hspa" ]
  then  # resume marker is empty
      echo "$line" >> ~/.config/videoinfox/videoinfo.playlist
      read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
      cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
      echo
      echo "$line" 
      echo
      echo "Added to Playlist . . ."      
      sleep .7
  else  # resume marker exists.
      echo "$line" >> ~/.config/videoinfox/videoinfo.playlist
      read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
      cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
      echo "$line" >> ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # UPDATE RESUME LIST
      echo
      echo "$line" 
      echo
      echo "Added to Playlist . . ."      
      sleep .7
fi
fi
fi
fi
fi
fi
 
IFS=$OLDIFS

rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa2 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfox.numbered-nt-playlistaddnav-directory-list 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfox.nt-playlistaddnav-directory-apa-work 2>/dev/null 
          
else
    echo
    echo " No video files in the current directory . . ."
    sleep .4

fi

;;

##################################################################################################################################################
s) #######################  @PLAYLIST - SHOW ALL (NAVIGATE TREE)  ################################################################################
##################################################################################################################################################

grabdir="$PWD"  # SAVE CURRENT DIRECTORY FOR RESTORE ON EXIT

cd ~/.config/videoinfox/playlists


function menuvhome {

sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playlist  # remove all blank lines

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]
  then
      :

  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

read -r savedpl < ~/.config/videoinfox/videoinfo.playlist.current # full name and path of the saved playlist
loadedpl="$HOME/.config/videoinfox/videoinfo.playlist" # full name and path of the loaded playlist
if cmp --silent -- "$savedpl" "$loadedpl"  # compare the saved playlist to the loaded playlist and update the saved playlist on: FILES ARE DIFFERENT  
  then # files are the same
      :
  else # FILES ARE DIFFERENT every time an edit is made to the loaded playlist
      cp ~/.config/videoinfox/videoinfo.playlist "$savedpl" 2>/dev/null  # SAVE THE LOADED PLAYLIST
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # CLEAR START MARKER
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup # CLEAR RESUME MARKER
      echo
      echo "Saving loaded playlist . . ."
      sleep .4
fi
                
clear

cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/tmp/videoinfo.playlist-apa


#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-apa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYLIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYLIST TO VARIABLE: $moddedplaylist 
moddedplaylist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-apa"

#  PLAYLIST INPUT FOR LOOP
input="$moddedplaylist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null     
fi


clear


if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null
        #dashit=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")
        dashit=$(echo "~") #
   else
        dashit=$(echo "-") # 
        echo
        echo "Playlist Empty . . ."
fi

#cat ~/.config/videoinfox/videoinfo.playlist 

# check if directory ~/.config/videoinfox/playlists is empty.  if it is, set playlist to Default 
searchtotal=$(find "$PWD" -type f \( -iname "vplaylist.*" \) 2>/dev/null | wc -l)

if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>
  then
      echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current             
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
      rm ~/.config/videoinfox/tmp/plread.tmp
      # GET CURRENT PLAYLIST
      read -r activeplaylist < ~/.config/videoinfox/videoinfo.playlist.current
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      # SAVE CURRENT PLAYLIST
      cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylist"
     
  else
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp

      rm ~/.config/videoinfox/tmp/plread.tmp
fi

echo
echo "Playlist: ""$setplaylist"

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresume=$(echo -e \ "         ")
      vpclresume=$(echo -e \ "               ")
  else
      vpresume="l - Resume"
      vpclresume="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resume-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resume-display.tmp > ~/.config/videoinfox/tmp/resume-display.tmp2 2>/dev/null
      read resumedisplay3 < ~/.config/videoinfox/tmp/resume-display.tmp2
      plresumenum=$(grep -Fn "$resumedisplay3" ~/.config/videoinfox/videoinfo.playlist | awk -F ':' '{print $1}')
      echo "Resume:" "$plresumenum" "$resumedisplay3"
fi 

##################################################################################################################################################

#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY

##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

#echo "Directory: ""$PWD"

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      echo
      echo "Clipboard: ""$pasteclip"
  else
      :
fi


if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                            

                  else 
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                 
            fi
  else

      if [ -f "$pasteclip" ]  # 
        then
                      echo
                      echo "Clipboard: ""$pasteclip"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                  

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo
fi
fi

echo -en " Enter Option: "
read -r -n1 optionv


}

        while true
        do
	    menuvhome
	    case $optionv in
    
        q)  # QUIT        
        cd "$grabdir"
        break;;

        x) 
        # CLRCLP 
        echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        ;;


        t) # Intermission
        read -r vto < ~/.config/videoinfox/videoinfox.intermission
        clear
        echo
        echo " Current Intermission:" "$vto"
        echo
        echo " Intermission range is 1 to 86400 seconds (24 hours)"
        echo
        read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep .7
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep .7
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep .7
    fi
    fi
    fi
    ;;

       
        h)
        clear
        echo " _________________________________________________________________________________________________________________"
        echo
        echo " "$der" >>> VIEW PLAYLIST >>> HELP"        
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  The loaded playlist is saved when any of the below edits are made."
        echo "  If any of the following options are run in View Playlist or the Play Queue, the resume marker will be cleared."
        echo
        echo "  - Remove Line   - Remove Block   - Remove Dupes   - Move Line   - Move Block   - Clear Playlist or Queue"
        echo
        echo "  Move Line and Move Block: To insert above line 1 enter 0"
        echo
        echo "  Note: Pressing enter with no entry instead of entering a number will cancel the edit."
        echo " _________________________________________________________________________________________________________________" 
        echo
        echo "  Start and Resume: When resume reaches the end of the playlist, the last video will stay in resume until"
        echo "                    start or clear resume are run or if any of the above edits are made."
        echo
        echo "  - Playlist Add will update an existing resume list with the added video."
        echo "  - Add to Queue in Change and Queue will update an existing resume list with the added playlist."
        echo "  - Rename an existing playlist. If a resume list exists, it will also be renamed."
        echo " _________________________________________________________________________________________________________________"
        echo        
        echo "  - Change and Queue: Playlist and Play Queue management. All the playlists are displayed on this screen."
        echo
        echo "  PLAYLIST: - Change - Create - Rename - Delete - Save As       QUEUE: - Add to Queue - Queue List - Play Queue"     
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  Mpv Playlist: This option will load a playlist into Mpv. This will bypass the -Resume option and the"
        echo "  Intermission Screen in Videoinfox. Mpv will keep track of the playlist position instead of Videoinfox's"
        echo "  resume option. Located in Change and Queue"
        echo " _________________________________________________________________________________________________________________"
        echo
        read -p " Press enter to continue . . ."
        ;;


        g)  # Remove Duplicates playlist
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfo.playlist
        clear
        echo
        echo " Remove Duplicates?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Playlist Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfo.playlist | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playlist.tmp
              cp ~/.config/videoinfox/tmp/videoinfo.playlist.tmp ~/.config/videoinfox/videoinfo.playlist
              read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
              cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


        b) # CLEAR RESUME PLAYLIST

if [ -z "$resumedisplay2" ]
  then
      :
  else        
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumedisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > "$setplaylist".last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;      


        o) # START AUTOPLAY (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else
                              
       tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'
       i=0

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > "$setplaylist".last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi

   else
       :
fi
;;


#################################################################
r)  # REMOVE LINE  (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
#################################################################

# delete a line example to remove by pattern
#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist


# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> Navigate Tree >>> Show All >>> View Playlist
      read -r -p "Enter line number to remove video from the playlist $whatplpld: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfo.playlist 2> /dev/null 
                                        echo
                                        echo "Line deleted from the playlist . . ."
                                        #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                        #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                        sleep .4
fi
fi
fi
fi
fi
fi
fi
;;


###################################################################
y)  # REMOVE BLOCK  (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
###################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep 4
                                                            else
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist 
                                                                echo
                                                                echo "Block removed . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


################################################################
m)  # MOVE LINE  (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> Navigate Tree >>> Show All >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfo.playlist <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


###################################################################
v)  # MOVE BLOCK  (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
###################################################################

cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp  # .playlist name 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null
      echo
      read -r -p "Start block cut: " linenumber  # waiting fot user input
      echo
      read -r -p "End block cut: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cut # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number 
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlist | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/videoinfo.playlist  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste1 # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste2 # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1 ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-paste2 > ~/.config/videoinfox/videoinfo.playlist
echo
echo "Block moved . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


##################################################################
l) # RESUME AUOTOPLAY# (NAVIGATE TREE >>> PLAYLIST)
##################################################################

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
fi

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        read < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay resumedisplay

        if [ -z "$resumedisplay" ]
          then
              #echo
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9
              :
          else
              i=0
              OLDIFS=$IFS
              IFS=$'\n'
    
              # READ FIRST LINE TO DISPLAY VIDEO NAME BEFORE PLAY
              
              echo
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3
          
input2=$HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/pl-tmp
mv ~/.config/videoinfox/playlists/pl-tmp ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay

IFS=$OLDIFS

fi

   else
       #echo
       #echo
       #echo " Playlist Empty . . ."
       #sleep 1.9
       :
fi
;;

      
        j) # PLAY LINE  (HOME >>>NAVIGATE TREE >>> SHOW ALL>>> PLAYLIST)

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list
echo
read -r -p "Play: " linenumber  # waiting fot user input

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/videoinfo.playlist-apa

if [ -z "$line" ]

  then
      :

  else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> PLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
IFS=$OLDIFS

rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

fi
fi

else
       echo
       echo
       echo " Playlist Empty . . ."
       sleep .4
fi

;;


       i)  # INFO - NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo.playlist-apa ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else

                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null

                 fi
fi
        else
            :

            fi

      fi

;;       


########################################################################################################################################################
          c)
          # CHANGE AND QUEUE
########################################################################################################################################################

function changepl {

#read -r savepl < ~/.config/videoinfox/videoinfo.playlist.current
#cp ~/.config/videoinfox/videoinfo.playlist "$savepl"

# cd ~/.config/videoinfox/playlists

# FIND PLAYLISTS
find "$PWD" -type f \( -iname "vplaylist.*" \) > ~/.config/videoinfox/videoinfo.playlist.dirlist

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist 

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist

# REMOVE PATH
sed 's/.*\///' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp

# REMOVE FILENAME AND LEAVE EXTENSION
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed 's/.*\.//' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp


# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp 


clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Playlist: ""$setplaylist"
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" VIEW PLAYLIST >>> CHANGE AND QUEUE"       
echo "___________________________________________________________________________________________________________________"
echo
echo " z - Change      r - Rename           a - Add to Queue                               m - Mpv Playlist     q - Quit"
echo " c - Create      d - Delete           b - Queue List"
echo " s - Save As                          p - Play Queue"
echo
echo -en " Enter Option: "
read -r -n1 optioncpl
echo
}


while true
do
changepl
case $optioncpl in


        q)  # QUIT
        ###cd "$grabdir"
        break ;;


        s)  # SAVE AS
clear
echo
echo " Playlist:" "$setplaylist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Save Playlist As... " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES

        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST IS LOADED
            echo
            echo " Save as... name can't be the same as the loaded playlist . . ."
            sleep 2
        
        else
            cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
            echo
            echo " Playlist Saved . . ."
            sleep .7
        fi

        break
        ;;


        n)  # NO
        break;;

        *)        
        esac
        done  

        else
        cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
        echo
        echo " Playlist Saved . . ."
        sleep .7

fi
fi
fi
;; 


        m)  # MPV PLAYLIST
# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
echo
echo " When using Mpv Playlist and back track <| or forward track |> are selected in mpv, the mpv play position marker"
echo " will be erased for the video that was playing (if it had a marker) when <| or |> were selected. To avoid any"
echo " mpv play markers from being erased, use Start and Resume in View Playlist instead of Mpv Playlist to watch a"
echo " playlist."
echo
echo " Mpv will only save a play position marker when Mpv quit(q) is used while playing a video."
echo " If Mpv is quit when a video is paused, it will restart the video paused."
echo
read -r -p " Press enter to continue . . ."

clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Mpv Playlist: " linenumber  # waiting fot user input

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]
        then 
            echo
            echo "Number out of range . . ."
            sleep .4
        else
            if ! command -v mpv &> /dev/null ####### Check for mpv and set if installed ########
              then
                  echo
                  echo "mpv not found . . ."               
                  sleep .4
              else
                  # CREATE FILE MOVING SELECTION TO THE TOP
                  tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/mpv-playlist.tmp

                  # READ FIRST LINE OF FILE
                  read mpvpl < ~/.config/videoinfox/tmp/mpv-playlist.tmp
                  mpv --fs --no-terminal --sid=no --save-position-on-quit --playlist="$mpvpl"
           fi    
      fi
fi
fi
fi
;;



        b)  # QUEUE LIST in NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST >>> CHANGE AND QUEUE    
        function plqueue {

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
  then
      dashit=$(echo -e "~")
  else
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      dashit=$(echo "-")
fi 

clear
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue

if [ -z "$qempty" ]
  then
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
      echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3               
      echo
      echo "Queue List Empty . . ."

else
# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

fi

cp ~/.config/videoinfox/videoinfox-playlist.queue ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-queueapa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2  
      else
          :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\.//' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

fi

cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null
####### !!!!!!!!!!!!!!!!!!HOME >>> VIEW PLAYLIST >>> CHANGE QUEUE >>> QUEUE LIST 
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> QUEUE LIST"        
echo "___________________________________________________________________________________________________________________"
echo
echo " m - Move Line     r - Remove Line     g - Remove Dupes     z - Rebuild Queue     d - Clear Queue         q - Quit"
echo
echo -en " Enter Option: "
read -r -n1 option
echo
}

while true
do
plqueue
case $option in


        q)  # QUIT   (Play Queue)
        break ;;


####################################################################################################
m)  # MOVE LINE --- VIEW PLAYLIST >>> CHANGE AND QUEUE - QUEUE LIST)
####################################################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queuelist.video.number 2>/dev/null


      #cat ~/.config/videoinfox/tmp/playlist.queuelist.video.number
      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2> /dev/null
      echo

      # Home >>> Navigate Tree >>> Show All >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l  ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfox-playlist.queue <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                                echo
                                                                echo "Run Rebuild Queue to update the Play Queue with this change."
                                                                echo
                                                                read -r -p "Press enter to continue . . ."
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
;;

       
###############################################################################
r)  # REMOVE LINE (HOME >>> VIEW PLAYLIST >>> CHANGE AND QUEUE >>> QUEUE LIST)
###############################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
        
clear
      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.number 2>/dev/null


      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

      echo
      read -r -p "Enter line number to remove playlist from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null 
                                        echo
                                        echo "Line deleted from the queue list . . ."
                                        echo
                                        echo "Run Rebuild Queue to update the Play Queue with this change."
                                        echo
                                        read -r -p "Press enter to continue . . ."


fi
fi
fi
fi
fi
fi

else
    echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
clear
;;


        g)  # Remove Duplicates Play Queue
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Remove Duplicate Playlists?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in


	  y)  # YES
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfox-playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/videoinfox-playlist.queue
              
              echo
              echo "Duplicates Removed . . ."
              echo
              echo "Run Rebuild Queue to update the Play Queue with this change."
              echo
              read -r -p "Press enter to continue . . ."
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;
 


        z) # REWRITE QUEUE WITH CURRENT LIST
        # WRITE QUEUE
        function rewrque {
        clear
        echo
        echo " Any edits made in the Play Queue will be lost if Yes is selected."
        echo
        echo " The current play queue can be saved first by selecting No and make playlist in the play queue."
        echo
        echo " Rebuild Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        }

        while true
        do
	  rewrque
	  case $option in

y) #  Rebuild Play Queue  

echo > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox # update for any deleted playlists that were in the queue upon delete
mv ~/.config/videoinfox/videoinfo.playlist-queueapa2 ~/.config/videoinfox/videoinfox-playlist.queue

# Play Queue FILE
input1=~/.config/videoinfox/videoinfox-playlist.queue

read -r chkforempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$chkforempty" ]
then
echo
echo
echo " Play Queue Empty . . ."
sleep .4
break

else
# LOOP 1 READ LINE BY LINE DOWNLOAD QUEUE LIST
while read -r line
do

input2="$line"

# WRITE LINE TO TEMP FILE.  LIST WITH FULL PATH
echo "$line" > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp

# LOOP 2 READ LINE BY LINE
    while read -r line  
    do
    echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

    done < "$input2"
done < "$input1"

      # REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
      sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

      # NUMBER THE LISTS (playlist names loaded into queue   playlist video list queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null
cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay # CLEAR RESUME LIST

echo
echo
echo " Queue Rebuilt . . ."
sleep .4                      
fi
break
;;

n)  # NO       
break;;

*)
        
esac
done
;;

        d)  # CLEAR QUEUE LIST  (Play Queue)
        function menudelq {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
                 
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;
       
        esac
        done
        ;;     





   a)  # ADD TO QUEUE (Playlist)

linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.dirlist.tmp | cut -d' ' -f1)  # GETTING LINECOUNT
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Add a playlist to the play queue: " linenumber  # waiting fot user input

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp # read first line         
            echo "$playnumber" >> ~/.config/videoinfox/videoinfox-playlist.queue # FULL PATH WITH FILENAME

            tail -n +"$linenumber" ~/.config/videoinfox/tmp/playlist.dirlist.tmp > ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp 2>/dev/null
            sed -i 's/^ *[0-9]\+.//g' ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # REMOVE PATH UP TO AND INCLUING DOT
            read playnumber2 < ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # read first line
      
            echo
            echo "$playnumber2" "added to the play queue . . ."
            sleep .7
# REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/videoinfox-playlist.queue &>/dev/null
      
# WRITE QUEUE
cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

input1="$playnumber"
read -r hspa < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
# READ LINE BY LINE
while read -r line  
do
echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

if [ -z "$hspa" ]
  then  # resume marker is empty
      :
  else 
      echo "$line" >> ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi
done < "$input1"

# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

# NUMBER THE LISTS (playlist video list queue  playlist names loaded into queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null

cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue

sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
                      
fi
fi
fi
fi
fi
;;

        p)   # PLAY QUEUE > Navigate Tree -Show All -View Playlist -Change and Queue

function playque {

clear

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi

# REMOVE PATH ONLY LEAVING FILENAME
sed 's/.*\///' ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.work
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.queue.work | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST

read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$qempty" ]
  then
      echo " Play Queue Empty . . ."
  else
      :
fi

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresumeq=$(echo -e \ "         ")
      vpclresumeq=$(echo -e \ "               ")
  else
      vpresumeq="l - Resume"
      vpclresumeq="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resumeq-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resumeq-display.tmp > ~/.config/videoinfox/tmp/resumeq-display.tmp2 2>/dev/null
      read resumeqdisplay3 < ~/.config/videoinfox/tmp/resumeq-display.tmp2
      plresumenum=$(grep -Fn "$resumeqdisplay3" ~/.config/videoinfox/playlists/playlist.queue | awk -F ':' '{print $1}')
      echo
      echo "Resume:" "$plresumenum" "$resumeqdisplay3"
fi 

echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> PLAY QUEUE                                                     ""Intermission:" "$vto" "seconds"        
echo "___________________________________________________________________________________________________________________"
echo
echo " j - Play     o - Start            z - Make Playlist     r - Remove Line      m - Move Line               q - Quit"
echo " t - Intr     $vpresumeq                                 y - Remove Block     v - Move Block" 
echo " i - Info     $vpclresumeq                           g - Remove Dupes     d - Clear Queue             $mpvdisplay1"
echo
echo -en " Enter Option: "
read -r -n1 optionpq
echo
}


while true
do
playque
case $optionpq in


        q)  # QUIT   (Play Queue)
        break ;;

        
       b) # CLEAR RESUME PLAY QUEUE

if [ -z "$resumedisplay2" ]
  then
      :
  else    
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumeqdisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;



        t) # Intermission
    read -r vto < ~/.config/videoinfox/videoinfox.intermission
    clear
    echo
    echo " Current Intermission:" "$vto"
    echo
    echo " Intermission range is 1 to 86400 seconds (24 hours)"
    echo
    read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;


       z) # QUEUE TO PLAYLIST
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
if [ -z "$qempty" ]
then
echo
echo " Play Queue Empty . . ."
sleep .4

else
clear
echo
echo " Queue to Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/videoinfo.playlist  # WRITE RESULTS TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE TO THE PLAYLIST DIRECTORY            
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE SEARCH RESULTS TO THE PLAYLIST DIRECTORY 
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
fi
;; 

      
        d)  # DELETE QUEUE LIST  (Play Queue)
        function menudelq {
   
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
         
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


        g)  # Remove Duplicates Play Queue
        function menurdup {

        if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
        then
        :
        else
        echo > ~/.config/videoinfox/playlists/playlist.queue
        fi
        
        read -r qempty < ~/.config/videoinfox/playlists/playlist.queue
        clear
        echo
        echo " Remove duplicate videos from the play queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates     
              cat -n ~/.config/videoinfox/playlists/playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay 2>/dev/null
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null              
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


   i)  # INFO - NAVIGATE TREE >>> SHOW ALL >>> PLAYLITS >>> Play Queue
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
              then
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else

             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                 fi
fi
        else
            echo
            echo
            echo " Play Queue Empty . . ."
            sleep .4            


            fi

      fi

;;       


j) # PLAY LINE  (Play Queue  nav tree  show all)

# GETTING LINE COUNT
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue | cut -d' ' -f1)
clear
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
   then
       echo
       read -r -p "Play: " linenumber  # waiting fot user input



if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then 
      :

  else 


      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]

              then 
                  :
              else

       tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'

       read line < ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa


fi
      fi
            fi



        if [ -z "$line" ]

         then
             :

         else

if [ "$linenumber" = 0 ]
  then
      :
  else

             clear
             echo
             echo "___________________________________________________________________________________________________________________"
             echo
             echo " ""$der"" >>> PLAY QUEUE >>> PLAY" 
             echo
             echo " [PLAYING]>" "$line"
             echo "___________________________________________________________________________________________________________________"
             echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
             echo
             echo
             echo " Video Player Controls:"
             echo                             
             echo " - Fullscreen Toggle: f"
             echo
             echo " - Play/Pause Toggle: space bar"
             echo
             echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
             echo
             echo " - Quit: q"      
             echo -e "\n"
             echo " This screen will quit when the video player is quit . . ."
             "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
             echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
             $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
             IFS=$OLDIFS
        fi
fi

    else  # FILE IS EMPTY"
        echo
        echo
        echo " Play Queue Empty . . ."
        sleep .4


fi
;;


####################################################################################################
r)  # REMOVE LINE @ PLAY QUEUE in NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null

      echo
      read -r -p "Remove a video from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 
                                        echo
                                        echo "Line deleted from the play queue . . ."
                                        sleep .4


fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue

fi
;;


####################################################################################################
y)  # REMOVE BLOCK @ PLAY QUEUE in NAVIGATE TREE >>> VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
      echo

      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                    if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else  
                                                                # MOVE LINE
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
                                                                echo
                                                                echo "Block Removed . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;



####################################################################################################
m)  # MOVE LINE @ PLAY QUEUE in NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
      echo

      # Home >>> Navigate Tree >>> Show All >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/playlists/playlist.queue <<<""$linenumber"m"$linenumber2"|wq"
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 
                                                                echo
                                                                echo "Line moved . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;


###########################################################################
v)  # MOVE BLOCK PLAY QUEUE (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST)
###########################################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
clear
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
echo
read -r -p "Start block cut: " linenumber  # waiting fot user input
echo
read -r -p "End block cut: " linenumber2

# GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutQ # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/playlists/playlist.queue  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste1Q # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste2Q # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1Q ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-paste2Q > ~/.config/videoinfox/playlists/playlist.queue
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
echo
echo "Block moved . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


o) # START AUTOPLAY (NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST >>> CHANGE AND QUEUE >> PLAY QUEUE)
# START AUTOPLAY Play Queue @@@@@@@@
# SET COUNTER TO ZERO.
i=0

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/playlists/playlist.queue"
#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"

read chkplq < ~/.config/videoinfox/playlists/playlist.queue

if [ -z "$chkplq" ]
   then
       echo
       echo " Play Queue Empty . . ."
       sleep .4
 
   else      

if [ -f  ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp ]
   then
       clear
       cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else

tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.autoplay 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

#  ASSIGN QUEUE LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/playlist.queue.autoplay"
#  LIST INPUT FOR LOOP
input="$moddedplayedlist"

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi
fi
fi
;;


     # RESUME AUTOPLAY Play Queue @@@@@@@@
############################################################
l) # RESUME AUOTOPLAY (Play Queue)
############################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
then
    :
else
    echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

        if [ -z "$resumedisplay" ]
          then
              :
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9

          else

              i=0
              OLDIFS=$IFS
              IFS=$'\n'

              # READ LINE TO DISPLAY VIDEO NAME BEFORE PLAY              
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3          

input2=$HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp
mv ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
;;




esac
done
;;
    

z)  # CHANGE PLAYLIST

# GET CURRENT PLAYLIST
read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current

# SAVE CURRENT PLAYLIST
#cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Loaded playlist: ""$setplaylist"
read -r -p "Change playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

            # CREATE FILE MOVING SELECTION TO THE TOP
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # READ FIRST LINE OF FILE
            read plselected < ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # WRITE SELECTED PLAYLIST
            echo "$plselected" > ~/.config/videoinfox/videoinfo.playlist.current

            # LOAD SELECTED PLAY LIST
            cp "$plselected" ~/.config/videoinfox/videoinfo.playlist 2>/dev/null

            # READ ACTIVE PLAYLIST FOR DISPLAY
            cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
            read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current
            read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
    
   fi


      fi
fi
fi
fi
;;       


r)  # RENAME PLAYLIST (NAVIGATE TREE)

clear
cat /home/homeserver/.config/videoinfox/tmp/playlist.dirlist.tmp
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1) # GETTING NUMBER OF PLAYLISTS
echo
read -r -p "Rename playlist: " linenumber 

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/file-to-be-renamed.tmp 2>/dev/null
read -r selectedtorename < ~/.config/videoinfox/tmp/file-to-be-renamed.tmp
echo "$selectedtorename"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread00.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
read -r renfrom < ~/.config/videoinfox/tmp/plread00.tmp

if [[ "$renfrom" == "Default" ]]
  then
      echo
      echo "The default playlist list cannot be renamed . . ."
      sleep 2
  else

clear
echo
echo " Selected Playlist: ""$renfrom"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Rename Playlist: " renpl  # waiting fot user linenumber. grabbing new filename

echo "$renpl" > ~/.config/videoinfox/tmp/plremovedotrn.tmp # write user input
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedotrn.tmp # Strip out any dots from user entry
read renamepl < ~/.config/videoinfox/tmp/plremovedotrn.tmp  # displayed name

if [[ "$renamepl" == "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

if [ -f "$HOME/.config/videoinfox/playlists/vplaylist.""$renamepl" ]
  then
      echo
      echo " File already exists . . ."
      sleep .4
  else

if [ -z "$renamepl" ]
  then
      :
else

if [[ "$setplaylist" = "$renfrom" ]]
  then  # PLAYLIST IS LOADED
cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$renamepl"
echo "$HOME""/.config/videoinfox/playlists/vplaylist.""$renamepl" > ~/.config/videoinfox/videoinfo.playlist.current # WRITE SELECTED PLAYLIST
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
cp ~/.config/videoinfox/playlists/vplaylist."$renamepl" ~/.config/videoinfox/videoinfo.playlist # LOAD RENAMED PLAYLIST
rm "$selectedtorename" 2>/dev/null
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
echo
echo " Playlist renamed and reloaded . . ."
sleep .4
  else # PLAYLIST ISN'T LOADED

cp "$selectedtorename" ~/.config/videoinfox/playlists/vplaylist."$renamepl"
rm "$selectedtorename" 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
echo
echo " Playlist renamed . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;



         d)  # DELETE PLAYLIST

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# SELECT A PLAYLIST TO DELETE
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Delete playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :

  else

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else
                  echo
                      # CREATE FILE MOVING SELECTION TO THE TOP
                      tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      # READ FIRST LINE OF FILE
                      read plselected < ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread0.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
                      read -r plselected2 < ~/.config/videoinfox/tmp/plread0.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE $pselecteda                     

                      if [[ "$plselected2" == "Default" ]]
                      then
                      echo "The default playlist list cannot be deleted. It can only be cleared . . ."
                      sleep 2
                      else

                      function menucpl {
                  
                      clear
                      echo
                      echo " Delete Playlist . . ."
                      echo
                      echo " $plselected"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 optioncpl
                      echo
                      }

                      while true
                      do
	                menucpl
	                case $optioncpl in

	                y)  # YES

                      rm "$plselected" 2> /dev/null

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME
                      read -r plselectedla < ~/.config/videoinfox/tmp/plread.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE  $pselecteda
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay 2> /dev/null  # REMOVE PLAYLIST.last.autoplay  file
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay.nextup 2> /dev/null  # REMOVE PLAYLIST.last.autoplay.nextup  file
                      echo
                      echo  " Playlist Deleted . . ."
                      sleep .7

                      if [[ "$setplaylistfull" = "$plselected" ]]  # IF DELETED PLAYLIST = ACTIVE PLAYLIST
                        then # SET DEFAULT PLAYLIST TO ACTIVE PLAYLIST
                            echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current
                            cp ~/.config/videoinfox/playlists/vplaylist.Default ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
                            setplaylist="Default"
                            echo
                            echo " Loaded playlist was deleted. Default playlist loaded . . ."
                            sleep 2
                        else
                            :
                      fi
 
                      break
                      ;;


                      n)  # NO
                      break;;

                      *)
        
                      esac
                      done
        
            fi
      fi
fi
fi
fi
fi            
;;        


    c)
         # CREATE PLAYLIST
echo
echo " Create Empty Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            echo > ~/.config/videoinfox/videoinfo.playlist  # WRITE TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
        fi
       
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7

fi
fi
fi
;; 


esac
done
;;
#!!!!!!!!!!!!!!!!!!!!!!! END PLAY QUEUE


          p) 
          #  @PLAY CLIPBOARD - <PLAYLIST>        

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdirz="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload  
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
             else
                  read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

           
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
          then
              :
          else     
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST File  
              $defplayer "${defplayargu[@]}" &> /dev/null "$ytdlplast"  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdirz"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi
 
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      echo " PLAYLIST Closed"
  
        else
            
            echo
            echo
            echo " No playable content in the clipboard . . ."
            sleep .9
      fi   
  fi
  ;;  
               

         d)  # CLEAR PLAYLIST (VIEW PLAYLIST)

        function menucpl {
        
        clear
        echo
        echo
        echo " Clear current playlist: ""$setplaylist""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optioncpl
        echo
        }

        while true
        do
	  menucpl
	  case $optioncpl in

	  y)  # YES
        rm ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
        echo > ~/.config/videoinfox/videoinfo.playlist
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
        read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
        cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST 
        echo
        echo " ""$setplaylist"" Playlist Cleared . . ."
        sleep .7 
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


*)

esac
done
;;
#@@@@@@@@@@@@@ END NAVIGATE TREE >>> SHOW ALL >>> VIEW PLAYLIST


o) # AUTOPLAY (NAVIGATE TREE >>> SHOW ALL)
clear
cat ~/.config/videoinfox/tmp/videoinfox.numbered-nt-play-directory-list
echo
read -r -p "Autoplay: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa 2>/dev/null

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> NAVIGATE TREE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox.nt-play-directory-apa.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

fi
 
IFS=$OLDIFS
          
esac
done


else
    echo
    echo " No video files in the current directory . . ."
    sleep .4

fi
;;


esac
done
;;


##################################################################################################################################################
d)  # (@PLAY DIRECTORY) HOME  ####################################################################################################################
##################################################################################################################################################
rm ~/.config/videoinfox/tmp/videoinfox.numbered-home-play-directory-list 2>/dev/null

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.home-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-home-play-directory-list 2>/dev/null
   
else         
     :
fi


if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-home-play-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-home-play-directory-list 2>/dev/null
   
linenumber=1

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa 2>/dev/null

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> HOME >>> PLAY DIRECTORY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox.home-play-directory-apa-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done
      
IFS=$OLDIFS

else
     echo
     echo
     echo " No video files in the current directory . . ."
     sleep .4
fi
;;           


#####################################################################################################################################################
l) # LAST DOWNLOAD >>> HOME    ######################################################################################################################
#####################################################################################################################################################

read -r ldcheck < ~/.config/videoinfox/videoinfo.lastdownload
if [ -z "$ldcheck" ]
  then
      echo
      echo
      echo " A video has be downloaded first for this feature to work . . ."
      sleep 1
  else
              grabdir="$PWD"  # storing directory to restore on quit
               
              read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"   # change to download directory

                 if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
                    then
                        read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt         
                        ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))
                        echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file
                        read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file

                    else
                        read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download
                        ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownloadbak*" \))
                        echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file
                        read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                 fi   

          
              clear
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " ""$der"" >>> PLAY LAST DOWNLOAD"
              echo
              echo " [PLAYING]> ""$ytdlplast"""
              echo "___________________________________________________________________________________________________________________"         
              echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will quit when the video player is quit . . ."
         
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
                       
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to file

              $defplayer "${defplayargu[@]}" "$ytdlplast" 2> /dev/null
       
              ####              ffplay -fs -autoexit &> /dev/null "$ytdlplast"
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              cd "$grabdir"   # restore dir prior to entering yt-dlp menu
fi
              ;;  


a)  # SHOW ALL VIDEOS

searchtotal=$(find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)    
                                           	                               
                     if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>
      
                       then
                           echo
                           echo
                           echo " No video files recursively reachable from the current directory . . ."
                           sleep 1
                           #cp ~/.config/videoinfox/videoinfo.findwork3 ~/.config/videoinfox/videoinfo.findwork
                           #cp ~/.config/videoinfox/videoinfo.lastsearchtotal2  ~/.config/videoinfox/videoinfo.lastsearchtotal
                        
                       else
                           echo "*" > ~/.config/videoinfox/videoinfo.lastfindstring   # save last find string used                          
                           read -r fterm < ~/.config/videoinfox/videoinfo.lastfindstring
                           

                           # save find results
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | sort -u > ~/.config/videoinfox/videoinfo.findwork
                           echo "$PWD" > ~/.config/videoinfox/videoinfo.lastfinddir  # save last directory that last find was run in 
                           # write last search total file count
                           echo "$searchtotal" > ~/.config/videoinfox/videoinfo.lastsearchtotal
                           # read last search total file count
                           read -r searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal    
                           cp ~/.config/videoinfox/videoinfo.findwork ~/.config/videoinfox/videoinfo.findwork3
                           cp ~/.config/videoinfox/videoinfo.lastsearchtotal ~/.config/videoinfox/videoinfo.lastsearchtotal2                 

                           "$vnotify" "Videoinfox messsage: Find results in $PWD" "$searchtotal files found using search term: $fterm"
                         
     fi
     ;;



     1)  # CD DIRECTORY TO TV    
     cd "$dir1" 
     ;;
    
     2)  # CD DIRECTORY TO MOVIES
     cd "$dir2" 
     ;;


     3)  # CHANGE DIRECTORY TO DOWNLOADS
     cd "$dirsaved" 
     ;;


     4)  # CHANGE DIRECTORY TO EXTRA   
     cd "$dir4" 
     ;;


     5)  # CHANGE DIRECTORY TO LAST EXIT
     cd "$dir5" 
     ;;


     c)  # CLEAR FIND RESULTS
     # CREATE FIND RESULT MESSAGE THAT THERE ARE NO STORED FINDS
     echo > ~/.config/videoinfox/videoinfo.lastsearchtotal
     echo > ~/.config/videoinfox/videoinfo.lastfindstring
     echo > ~/.config/videoinfox/videoinfo.lastfinddir

     rm ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp 2> /dev/null
     rm ~/.config/videoinfox/tmp/videoinfo-findwork.tmp 2> /dev/null

     echo > ~/.config/videoinfox/videoinfo.findwork
     
     ;;


     x) 
       #CLEAR CLIPBOARD - <HOME> 
       echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
       pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
       ;;

#############################################################################################################################################	
#############################################################################################################################################
     p) 
     #  @PLAY CLIPBOARD - <HOME> !!!!!    MASTER TEMPLATE  This is the one that gets the edits then copied to other places in the code.

#############################################################################################################################################
#############################################################################################################################################
     
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdir="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"    

      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload


      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
             else
                  read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

           
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."

      if [ -z "$ytdlplast" ]
         then
             :
         else     
             "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
             echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List File  
             $defplayer "${defplayargu[@]}" "$ytdlplast" 2> /dev/null  
      fi
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdir"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      
      # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      
      #"$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"      

      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

      echo " Played List Closed"

         else
             echo
             echo
             echo " No playable content in the clipboard . . ."
             sleep .9

fi
fi
;;  


      i)  # INFO - <HOME>
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo-findwork.tmp ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-findwork.tmp > ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null

                 fi
fi
        else
            echo
            echo
            echo " Select Show All or use Find to access this feature . . ."
            sleep 1


            fi

      fi

;;


##################################################################################################################################################
v)                                  ##############################################################################################################    
     #  VIEW/PLAYED LIST - <HOME>   ##############################################################################################################
     
function menuvv {

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content                  
clear

cp ~/.config/videoinfox/videoinfo.playedlist ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null

#  REMOVE DUPLICATES
#cat -n ~/.config/videoinfox/tmp/videoinfo.playedlist-apa | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa3 2>/dev/null
#mv ~/.config/videoinfox/tmp/videoinfo.playedlist-apa3 ~/.config/videoinfox/videoinfo.playedlist 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playedlist 2>/dev/null

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playedlist-apa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfo.playedlist-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 2>/dev/null


#  REMOVE DUPLICATES
#cat -n ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa3 2>/dev/null
#mv ~/.config/videoinfox/tmp/videoinfo.playedlist-apa3 ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.played-list 2>/dev/null

   
else 
     :        
fi

clear

read -r < ~/.config/videoinfox/videoinfo.playedlist chkempty 
if [ -z "$chkempty" ]
  then
      dashit=$(echo "-") 
      echo
      echo "Played List Empty . . ."
  else
      cat ~/.config/videoinfox/tmp/videoinfo.number.played-list 2>/dev/null
        dashit=$(echo -e "~")
fi

echo
echo "Playlist: ""$setplaylist"

##################################################################################################################################################

#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY

##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
then
echo
echo "Clipboard: ""$pasteclip"
else
:
fi

      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> PLAYED LIST"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j "$dashit" Play         s - View Playlist     g - Remove Dupes          p - Play Clipboard                      q - Quit"
                      echo " o "$dashit" Autoplay     k "$dashit" Playlist Add      d - Clear Played List     x - Clrclp"
                      echo " i "$dashit" Info         z "$dashit" Make Playlist"
                      echo   

                  else 
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> PLAYED LIST"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j "$dashit" Play         s - View Playlist     g - Remove Dupes          p * Play Clipboard                      q - Quit"
            echo " o "$dashit" Autoplay     k "$dashit" Playlist Add      d - Clear Played List     x - Clrclp"
            echo " i "$dashit" Info         z "$dashit" Make Playlist"
                      echo                                                                                        
            fi
  else

      if [ -f "$pasteclip" ]  # 
        then     
            echo
            echo "Clipboard:" "$pasteclip"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " "$der" >>> PLAYED LIST"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " j "$dashit" Play         s - View Playlist     g - Remove Dupes          p * Play Clipboard                      q - Quit"
            echo " o "$dashit" Autoplay     k "$dashit" Playlist Add      d - Clear Played List     x - Clrclp"
            echo " i "$dashit" Info         z "$dashit" Make Playlist"
            echo                                                            

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

            echo "___________________________________________________________________________________________________________________"
            echo
            echo " "$der" >>> PLAYED LIST"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " j "$dashit" Play         s - View Playlist     g - Remove Dupes          p - Play Clipboard                      q - Quit"
            echo " o "$dashit" Autoplay     k "$dashit" Playlist Add      d - Clear Played List     x - Clrclp"
            echo " i "$dashit" Info         z "$dashit" Make Playlist"
            echo
fi
fi

echo -en " Enter Option: "
read -r -n1 optionv


}

        while true
        do
	    menuvv
	    case $optionv in
    
        q)  # QUIT
        rm ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null
        rm ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 2>/dev/null
        rm ~/.config/videoinfox/tmp/videoinfo.number.played-list 2>/dev/null
        break;;

        
        x) 
        # CLRCLP 
        echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        ;;


        g) # REMOVE DUPES PLAYED LIST

 function menurdup {
        read -r playedlempty < ~/.config/videoinfox/videoinfo.playedlist
        clear
        echo
        echo " Remove Duplicate Videos in Played List?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in


	  y)  # YES
        if [ -z "$playedlempty" ]
          then
              echo
              echo " Played List Empty . . ."
              sleep .4
          else
              # Remove Duplicates
cat -n ~/.config/videoinfox/videoinfo.playedlist | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playedlist-rdupes 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playedlist-rdupes ~/.config/videoinfox/videoinfo.playedlist 2>/dev/null
sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playedlist 2>/dev/null #  REMOVE BLANK LINES
              
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


        o) # AUTOPLAY LINE  (PLAYED LIST)

# GETTING LINE COUNT
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.number.played-list 2> /dev/null | cut -d' ' -f1)

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.played-list ]
   then

clear
cat ~/.config/videoinfox/tmp/videoinfo.number.played-list
echo
read -r -p "Autoplay: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
  then 
      :
  else 

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :
        else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [[ $linenumber -gt $linecount ]]
  then
      :
  else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playedlist-apa > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYED LIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo.playedlist-apa > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfo.playedlist-apa-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done    

fi
 
IFS=$OLDIFS


fi
fi
fi

   else
       echo
       echo
       echo " Played List Empty . . ."
       sleep .4
fi

;;


        j) # PLAY LINE  (PLAYED LIST)

# GETTING LINE COUNT
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.number.played-list 2> /dev/null | cut -d' ' -f1)

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.played-list ]
   then
       clear
       cat ~/.config/videoinfox/tmp/videoinfo.number.played-list
       echo
       read -r -p "Play: " linenumber  # waiting for user input



if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :

  else 


      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]

              then 
                  :

              else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playedlist-apa > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'

       read line < ~/.config/videoinfox/tmp/videoinfo.playedlist-apa


fi
      fi
            fi



        if [ -z "$line" ]

         then
             :

         else

if [ "$linenumber" = 0 ]
  then
      :
  else
             clear
             echo
             echo "___________________________________________________________________________________________________________________"
             echo
             echo " ""$der"" >>> PLAYED LIST >>> PLAY" 
             echo
             echo " [PLAYING]>" "$line"
             echo "___________________________________________________________________________________________________________________"
             echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
             echo
             echo
             echo " Video Player Controls:"
             echo                             
             echo " - Fullscreen Toggle: f"
             echo
             echo " - Play/Pause Toggle: space bar"
             echo
             echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
             echo
             echo " - Quit: q"      
             echo -e "\n"
             echo " This screen will quit when the video player is quit . . ."
             "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
             #echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
             $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
             IFS=$OLDIFS

             rm ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null
             rm ~/.config/videoinfox/tmp/videoinfo.playedlist-apa2 2>/dev/null
             rm ~/.config/videoinfox/tmp/videoinfo.number.played-list 2>/dev/null

        fi
fi

    else  # FILE IS EMPTY"
        echo
        echo
        echo " Played List Empty . . ."
        sleep .4


fi
;;


z) # MAKE PLAYLIST in PLAYED LIST

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.playedlist > ~/.config/videoinfox/tmp/videoinfo.playedlist.tmp
mv ~/.config/videoinfox/tmp/videoinfo.playedlist.tmp ~/.config/videoinfox/videoinfo.playedlist

read -r isresultsempty < ~/.config/videoinfox/videoinfo.playedlist
if [ -z "$isresultsempty" ]
then
    echo
    echo
    echo " Played List  Empty . . ."
    sleep .4
else
clear
echo
echo " Save Played List as a Playlist."
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read -r createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp
plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cat ~/.config/videoinfox/videoinfo.playedlist > ~/.config/videoinfox/videoinfo.playlist  # WRITE SEARCH RESULTS TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cat ~/.config/videoinfox/videoinfo.playedlist > "$plname"  # WRITE SEARCH RESULTS TO THE PLAYLIST DIRECTORY
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: "$plname""
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cat ~/.config/videoinfox/videoinfo.playedlist > "$plname"  # WRITE RECURSIVE SEARCH RESULTS TO PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
fi
;; 


       i)  # INFO - <PLAYED LIST>
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo.playedlist-apa ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playedlist-apa > ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo.playedlist-apa.tmp 2>/dev/null

                 fi
fi
        else
            echo
            echo
            echo " Play List Empty . . ."
            sleep .4            


            fi

      fi

;;       


#####################################################################################################################################
s) # @PLAYLIST  VIEW PLAYLIST in PLAYED LIST
#####################################################################################################################################

grabdir="$PWD"  # SAVE CURRENT DIRECTORY FOR RESTORE ON EXIT

cd ~/.config/videoinfox/playlists


function menuvhome {

sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playlist  # remove all blank lines

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]
  then
      :

  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

read -r savedpl < ~/.config/videoinfox/videoinfo.playlist.current # full name and path of the saved playlist
loadedpl="$HOME/.config/videoinfox/videoinfo.playlist" # full name and path of the loaded playlist
if cmp --silent -- "$savedpl" "$loadedpl"  # compare the saved playlist to the loaded playlist and update the saved playlist on: FILES ARE DIFFERENT  
  then # files are the same
      :
  else # FILES ARE DIFFERENT every time an edit is made to the loaded playlist
      cp ~/.config/videoinfox/videoinfo.playlist "$savedpl" 2>/dev/null  # SAVE THE LOADED PLAYLIST
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # CLEAR START MARKER
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup # CLEAR RESUME MARKER
      echo
      echo "Saving loaded playlist . . ."
      sleep .4
fi

clear

cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/tmp/videoinfo.playlist-apa


#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-apa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYLIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYLIST TO VARIABLE: $moddedplaylist 
moddedplaylist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-apa"

#  PLAYLIST INPUT FOR LOOP
input="$moddedplaylist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null     
fi


clear


if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null
        #dashit=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")
        dashit=$(echo "~") #
   else
        dashit=$(echo "-") # 
        echo
        echo "Playlist Empty . . ."
fi

#cat ~/.config/videoinfox/videoinfo.playlist 

# check if directory ~/.config/videoinfox/playlists is empty.  if it is, set playlist to Default 
searchtotal=$(find "$PWD" -type f \( -iname "vplaylist.*" \) 2>/dev/null | wc -l)

if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>
  then
      echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current             
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
      rm ~/.config/videoinfox/tmp/plread.tmp
      # GET CURRENT PLAYLIST
      read -r activeplaylist < ~/.config/videoinfox/videoinfo.playlist.current
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      # SAVE CURRENT PLAYLIST
      cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylist"
     
  else
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp

      rm ~/.config/videoinfox/tmp/plread.tmp
fi

echo
echo "Playlist: ""$setplaylist"

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresume=$(echo -e \ "         ")
      vpclresume=$(echo -e \ "               ")
  else
      vpresume="l - Resume"
      vpclresume="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resume-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resume-display.tmp > ~/.config/videoinfox/tmp/resume-display.tmp2 2>/dev/null
      read resumedisplay3 < ~/.config/videoinfox/tmp/resume-display.tmp2
      plresumenum=$(grep -Fn "$resumedisplay3" ~/.config/videoinfox/videoinfo.playlist | awk -F ':' '{print $1}')
      echo "Resume:" "$plresumenum" "$resumedisplay3"
fi 

##################################################################################################################################################

#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY

##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

#echo "Directory: ""$PWD"

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      echo
      echo "Clipboard: ""$pasteclip"
  else
      :
fi


if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                            

                  else 
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                 
            fi
  else

      if [ -f "$pasteclip" ]  # 
        then
                      echo
                      echo "Clipboard: ""$pasteclip"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                  

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo
fi
fi


echo -en " Enter Option: "
read -r -n1 optionv


}

        while true
        do
	    menuvhome
	    case $optionv in
    
        q)  # QUIT        
        cd "$grabdir"
        break;;

        x) 
        # CLRCLP 
        echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        ;;


        t) # Intermission
        read -r vto < ~/.config/videoinfox/videoinfox.intermission
        clear
        echo
        echo " Current Intermission:" "$vto"
        echo
        echo " Intermission range is 1 to 86400 seconds (24 hours)"
        echo
        read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;

       
         h)
        clear
        echo " _________________________________________________________________________________________________________________"
        echo
        echo " "$der" >>> VIEW PLAYLIST >>> HELP"        
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  The loaded playlist is saved when any of the below edits are made."
        echo "  If any of the following options are run in View Playlist or the Play Queue, the resume marker will be cleared."
        echo
        echo "  - Remove Line   - Remove Block   - Remove Dupes   - Move Line   - Move Block   - Clear Playlist or Queue"
        echo
        echo "  Move Line and Move Block: To insert above line 1 enter 0"
        echo
        echo "  Note: Pressing enter with no entry instead of entering a number will cancel the edit."
        echo " _________________________________________________________________________________________________________________" 
        echo
        echo "  Start and Resume: When resume reaches the end of the playlist, the last video will stay in resume until"
        echo "                    start or clear resume are run or if any of the above edits are made."
        echo
        echo "  - Playlist Add will update an existing resume list with the added video."
        echo "  - Add to Queue in Change and Queue will update an existing resume list with the added playlist."
        echo "  - Rename an existing playlist. If a resume list exists, it will also be renamed."
        echo " _________________________________________________________________________________________________________________"
        echo        
        echo "  - Change and Queue: Playlist and Play Queue management. All the playlists are displayed on this screen."
        echo
        echo "  PLAYLIST: - Change - Create - Rename - Delete - Save As       QUEUE: - Add to Queue - Queue List - Play Queue"      
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  Mpv Playlist: This option will load a playlist into Mpv. This will bypass the -Resume option and the"
        echo "  Intermission Screen in Videoinfox. Mpv will keep track of the playlist position instead of Videoinfox's"
        echo "  resume option. Located in Change and Queue"
        echo " _________________________________________________________________________________________________________________"
        echo
        read -p " Press enter to continue . . ."
        ;;

        g)  # Remove Duplicates playlist
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfo.playlist
        clear
        echo
        echo " Remove Duplicates?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Playlist Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfo.playlist | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playlist.tmp
              cp ~/.config/videoinfox/tmp/videoinfo.playlist.tmp ~/.config/videoinfox/videoinfo.playlist
              read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
              cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


       b) # CLEAR RESUME PLAYLIST

if [ -z "$resumedisplay2" ]
  then
      :
  else        
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumedisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > "$setplaylist".last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;      



        o) # START AUTOPLAY (PLAYED LIST >>> VIEW PLAYLIST)
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else
                              
       tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'
       i=0

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > "$setplaylist".last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi

   else
       :
fi
;;


#################################################################
r)  # REMOVE LINE  (PLAYED LIST >>> VIEW PLAYLIST)
#################################################################

# delete a line example to remove by pattern
#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist


# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> PLAYED LIST >>> View Playlist
      read -r -p "Enter line number to remove video from the playlist $whatplpld: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfo.playlist 2> /dev/null 
                                        echo
                                        echo "Line deleted from the playlist . . ."
                                        #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                        #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                        sleep .4
fi
fi
fi
fi
fi
fi
fi
;;


###################################################################
y)  # REMOVE BLOCK  (VIEW PLAYLIST in Played List)
###################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist 
                                                                echo
                                                                echo "Block removed . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


################################################################
m)  # MOVE LINE  (PLAYED LIST >>> VIEW PLAYLIST)
################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> PLAYED LIST >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfo.playlist <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


####################################################################
v)  # MOVE BLOCK  (PLAYED LIST >>> VIEW PLAYLIST)
####################################################################

cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp  # .playlist name 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null
      echo
      read -r -p "Start block cut: " linenumber  # waiting fot user input
      echo
      read -r -p "End block cut: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cut # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number 
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlist | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/videoinfo.playlist  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste1 # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste2 # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1 ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-paste2 > ~/.config/videoinfox/videoinfo.playlist
echo
echo "Block moved . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


##################################################################
l) # RESUME AUOTOPLAY# PLAYED LIST >>> PLAYLIST)
##################################################################

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
fi

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        read < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay resumedisplay

        if [ -z "$resumedisplay" ]
          then
              #echo
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9
              :
          else
              i=0
              OLDIFS=$IFS
              IFS=$'\n'
    
              # READ FIRST LINE TO DISPLAY VIDEO NAME BEFORE PLAY
              
              echo
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3
          
input2=$HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
     echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/pl-tmp
mv ~/.config/videoinfox/playlists/pl-tmp ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay

IFS=$OLDIFS

fi

   else
       #echo
       #echo
       #echo " Playlist Empty . . ."
       #sleep 1.9
       :
fi
;;

      
        j) # PLAY LINE  (HOME >>> PLAYED LISt >>> PLAYLIST)

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list
echo
read -r -p "Play: " linenumber  # waiting fot user input

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/videoinfo.playlist-apa

if [ -z "$line" ]

  then
      :

  else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> PLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
IFS=$OLDIFS

rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

fi
fi

else
       echo
       echo
       echo " Playlist Empty . . ."
       sleep .4
fi

;;


       i)  # INFO - played list <PLAYLIST>
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo.playlist-apa ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null

                 fi
fi
        else
            :

            fi

      fi

;;       


########################################################################################################################################################
          c)
          # CHANGE AND QUEUE
########################################################################################################################################################

function changepl {

#read -r savepl < ~/.config/videoinfox/videoinfo.playlist.current
#cp ~/.config/videoinfox/videoinfo.playlist "$savepl"

# cd ~/.config/videoinfox/playlists

# FIND PLAYLISTS
find "$PWD" -type f \( -iname "vplaylist.*" \) > ~/.config/videoinfox/videoinfo.playlist.dirlist

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist 

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist

# REMOVE PATH
sed 's/.*\///' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp

# REMOVE FILENAME AND LEAVE EXTENSION
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed 's/.*\.//' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp


# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp 


clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Playlist: ""$setplaylist"
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" VIEW PLAYLIST >>> CHANGE AND QUEUE"       
echo "___________________________________________________________________________________________________________________"
echo
echo " z - Change      r - Rename           a - Add to Queue                               m - Mpv Playlist     q - Quit"
echo " c - Create      d - Delete           b - Queue List"
echo " s - Save As                          p - Play Queue"
echo
echo -en " Enter Option: "
read -r -n1 optioncpl
echo
}


while true
do
changepl
case $optioncpl in


        q)  # QUIT
        ###cd "$grabdir"
        break ;;


        s)  # SAVE AS
clear
echo
echo " Playlist:" "$setplaylist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Save Playlist As... " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES

        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST IS LOADED
            echo
            echo " Save as... name can't be the same as the loaded playlist . . ."
            sleep 2
        
        else
            cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
            echo
            echo " Playlist Saved . . ."
            sleep .7
        fi

        break
        ;;


        n)  # NO
        break;;

        *)        
        esac
        done  

        else
        cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
        echo
        echo " Playlist Saved . . ."
        sleep .7

fi
fi
fi
;; 


  m)  # MPV PLAYLIST
# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
echo
echo " When using Mpv Playlist and back track <| or forward track |> are selected in mpv, the mpv play position marker"
echo " will be erased for the video that was playing (if it had a marker) when <| or |> were selected. To avoid any"
echo " mpv play markers from being erased, use Start and Resume in View Playlist instead of Mpv Playlist to watch a"
echo " playlist."
echo
echo " Mpv will only save a play position marker when Mpv quit(q) is used while playing a video."
echo " If Mpv is quit when a video is paused, it will restart the video paused."
echo
read -r -p " Press enter to continue . . ."

clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Mpv Playlist: " linenumber  # waiting fot user input

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]
        then 
            echo
            echo "Number out of range . . ."
            sleep .4
        else
            if ! command -v mpv &> /dev/null ####### Check for mpv and set if installed ########
              then
                  echo
                  echo "mpv not found . . ."               
                  sleep .4
              else
                  # CREATE FILE MOVING SELECTION TO THE TOP
                  tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/mpv-playlist.tmp

                  # READ FIRST LINE OF FILE
                  read mpvpl < ~/.config/videoinfox/tmp/mpv-playlist.tmp
                  mpv --fs --no-terminal --sid=no --save-position-on-quit --playlist="$mpvpl"
           fi    
      fi
fi
fi
fi
;;



        b)  # QUEUE LIST in PLAYED LIST >>> VIEW PLAYLIST >>> CHANGE AND QUEUE    
        function plqueue {

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
  then
      dashit=$(echo -e "~")
  else
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      dashit=$(echo "-")
fi 

clear
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue

if [ -z "$qempty" ]
  then
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
      echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3               
      echo
      echo "Queue List Empty . . ."

else
# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

fi

cp ~/.config/videoinfox/videoinfox-playlist.queue ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-queueapa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2  
      else
          :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\.//' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

fi

cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

####### !!!!!!!!!!!!!!!!!!HOME >>> VIEW PLAYLIST >>> CHANGE QUEUE >>> QUEUE LIST 
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> QUEUE LIST"        
echo "___________________________________________________________________________________________________________________"
echo
echo " m - Move Line     r - Remove Line     g - Remove Dupes     z - Rebuild Queue     d - Clear Queue         q - Quit"
echo
echo -en " Enter Option: "
read -r -n1 option
echo
}

while true
do
plqueue
case $option in


        q)  # QUIT   (Play Queue)
        break ;;


####################################################################################################
m)  # MOVE LINE --- VIEW PLAYLIST >>> CHANGE AND QUEUE - QUEUE LIST)
####################################################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queuelist.video.number 2>/dev/null


      #cat ~/.config/videoinfox/tmp/playlist.queuelist.video.number
      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2> /dev/null
      echo

      # Home >>> PLAYED LIST >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l  ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfox-playlist.queue <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                                echo
                                     echo "Run Rebuild Queue to update the Play Queue with this change."
                                                                
                                                                echo
                                                                read -r -p "Press enter to continue . . ."
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
;;

       
###############################################################################
r)  # REMOVE LINE (HOME >>> VIEW PLAYLIST >>> CHANGE AND QUEUE >>> QUEUE LIST)
###############################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
        
clear
      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.number 2>/dev/null


      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

      echo
      read -r -p "Enter line number to remove playlist from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null 
                                        echo
                                        echo "Line deleted from the queue list . . ."
                                        echo
                                        echo "Run Rebuild Queue to update the Play Queue with this change."
                                        echo
                                        read -r -p "Press enter to continue . . ."


fi
fi
fi
fi
fi
fi

else
    echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
clear
;;


        g)  # Remove Duplicates Play Queue
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Remove Duplicate Playlists?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in


	  y)  # YES
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfox-playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/videoinfox-playlist.queue
              
              echo
              echo "Duplicates Removed . . ."
              echo
              echo "Run Rebuild Queue to update the Play Queue with this change."
              echo
              read -r -p "Press enter to continue . . ."
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;
 


        z) # REWRITE QUEUE WITH CURRENT LIST
        # WRITE QUEUE
        function rewrque {
        clear
        echo
        echo " Any edits made in the Play Queue will be lost if Yes is selected."
        echo
        echo " The current play queue can be saved first by selecting No and make playlist in the play queue."
        echo
        echo " Rebuild Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        }

        while true
        do
	  rewrque
	  case $option in

y) #  Rebuild Play Queue  

echo > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox # update for any deleted playlists that were in the queue upon delete
mv ~/.config/videoinfox/videoinfo.playlist-queueapa2 ~/.config/videoinfox/videoinfox-playlist.queue

# Play Queue FILE
input1=~/.config/videoinfox/videoinfox-playlist.queue

read -r chkforempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$chkforempty" ]
then
echo
echo
echo " Play Queue Empty . . ."
sleep .4
break

else
# LOOP 1 READ LINE BY LINE DOWNLOAD QUEUE LIST
while read -r line
do

input2="$line"

# WRITE LINE TO TEMP FILE.  LIST WITH FULL PATH
echo "$line" > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp

# LOOP 2 READ LINE BY LINE
    while read -r line  
    do
    echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

    done < "$input2"
done < "$input1"

      # REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
      sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

      # NUMBER THE LISTS (playlist names loaded into queue   playlist video list queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null
cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay # CLEAR RESUME LIST

echo
echo
echo " Queue Rebuilt . . ."
sleep .4                      
fi
break
;;

n)  # NO       
break;;

*)
        
esac
done
;;

        d)  # CLEAR QUEUE LIST  (Play Queue)
        function menudelq {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
                 
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;
       
        esac
        done
        ;;     





   a)  # ADD TO QUEUE (Playlist)

linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.dirlist.tmp | cut -d' ' -f1)  # GETTING LINECOUNT
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Add a playlist to the play queue: " linenumber  # waiting fot user input

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp # read first line         
            echo "$playnumber" >> ~/.config/videoinfox/videoinfox-playlist.queue # FULL PATH WITH FILENAME

            tail -n +"$linenumber" ~/.config/videoinfox/tmp/playlist.dirlist.tmp > ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp 2>/dev/null
            sed -i 's/^ *[0-9]\+.//g' ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # REMOVE PATH UP TO AND INCLUING DOT
            read playnumber2 < ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # read first line
      
            echo
            echo "$playnumber2" "added to the play queue . . ."
            sleep .7
# REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/videoinfox-playlist.queue &>/dev/null
      
# WRITE QUEUE
cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

input1="$playnumber"
read -r hspa < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
# READ LINE BY LINE
while read -r line  
do
echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

if [ -z "$hspa" ]
  then  # resume marker is empty
      :
  else 
      echo "$line" >> ~/.config/videoinfox/playlists/playlist.queue.last-autoplay 
fi
done < "$input1"

# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

# NUMBER THE LISTS (playlist video list queue  playlist names loaded into queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null

cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue

sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
                      
fi
fi
fi
fi
fi
;;


        p)   # PLAY QUEUE > Navigate Tree -Show All -View Playlist -Change and Queue

function playque {

clear

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi

# REMOVE PATH ONLY LEAVING FILENAME
sed 's/.*\///' ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.work
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.queue.work | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST

read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$qempty" ]
  then
      echo " Play Queue Empty . . ."
  else
      :
fi

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresumeq=$(echo -e \ "         ")
      vpclresumeq=$(echo -e \ "               ")
  else
      vpresumeq="l - Resume"
      vpclresumeq="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resumeq-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resumeq-display.tmp > ~/.config/videoinfox/tmp/resumeq-display.tmp2 2>/dev/null
      read resumeqdisplay3 < ~/.config/videoinfox/tmp/resumeq-display.tmp2
      plresumenum=$(grep -Fn "$resumeqdisplay3" ~/.config/videoinfox/playlists/playlist.queue | awk -F ':' '{print $1}')
      echo
      echo "Resume:" "$plresumenum" "$resumeqdisplay3"
fi 

echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> PLAY QUEUE                                                     ""Intermission:" "$vto" "seconds"        
echo "___________________________________________________________________________________________________________________"
echo
echo " j - Play     o - Start            z - Make Playlist     r - Remove Line      m - Move Line               q - Quit"
echo " t - Intr     $vpresumeq                                 y - Remove Block     v - Move Block" 
echo " i - Info     $vpclresumeq                           g - Remove Dupes     d - Clear Queue             $mpvdisplay1"
echo
echo -en " Enter Option: "
read -r -n1 optionpq
echo
}


while true
do
playque
case $optionpq in


        q)  # QUIT   (Play Queue)
        break ;;


        b) # CLEAR RESUME PLAY QUEUE

if [ -z "$resumedisplay2" ]
  then
      :
  else    
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumeqdisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;


        t) # Intermission
    read -r vto < ~/.config/videoinfox/videoinfox.intermission
    clear
    echo
    echo " Current Intermission:" "$vto"
    echo
    echo " Intermission range is 1 to 86400 seconds (24 hours)"
    echo
    read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;


       z) # QUEUE TO PLAYLIST
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
if [ -z "$qempty" ]
then
echo
echo " Play Queue Empty . . ."
sleep .4

else
clear
echo
echo " Queue to Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/videoinfo.playlist  # WRITE RESULTS TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE TO THE PLAYLIST DIRECTORY            
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE SEARCH RESULTS TO THE PLAYLIST DIRECTORY 
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
fi
;; 

      
        d)  # DELETE QUEUE LIST  (Play Queue)
        function menudelq {
   
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
         
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


        g)  # Remove Duplicates Play Queue
        function menurdup {

        if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
        then
        :
        else
        echo > ~/.config/videoinfox/playlists/playlist.queue
        fi
        
        read -r qempty < ~/.config/videoinfox/playlists/playlist.queue
        clear
        echo
        echo " Remove duplicate videos from the play queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates     
              cat -n ~/.config/videoinfox/playlists/playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/playlists/playlist.queue              
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay 2>/dev/null
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


   i)  # INFO - PLAYED LIST >>> VIEW PLAYLIST >>> Play Queue
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
              then
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                 fi
fi
        else
            echo
            echo
            echo " Play Queue Empty . . ."
            sleep .4           


            fi

      fi

;;       


j) # PLAY LINE  (>>> PLAYED LISt >>> PLAYLIST >>> Play Queue)

# GETTING LINE COUNT
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue | cut -d' ' -f1)
clear
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
   then
       echo
       read -r -p "Play: " linenumber  # waiting fot user input



if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then 
      :

  else 


      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]

              then 
                  :
              else

       tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'

       read line < ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa


fi
      fi
            fi



        if [ -z "$line" ]

         then
             :

         else

if [ "$linenumber" = 0 ]
  then
      :
  else

             clear
             echo
             echo "___________________________________________________________________________________________________________________"
             echo
             echo " ""$der"" >>> PLAY QUEUE >>> PLAY" 
             echo
             echo " [PLAYING]>" "$line"
             echo "___________________________________________________________________________________________________________________"
             echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
             echo
             echo
             echo " Video Player Controls:"
             echo                             
             echo " - Fullscreen Toggle: f"
             echo
             echo " - Play/Pause Toggle: space bar"
             echo
             echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
             echo
             echo " - Quit: q"      
             echo -e "\n"
             echo " This screen will quit when the video player is quit . . ."
             "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
             echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
             $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
             IFS=$OLDIFS
        fi
fi

    else  # FILE IS EMPTY"
        echo
        echo
        echo " Play Queue Empty . . ."
        sleep .4


fi
;;


####################################################################################################
r)  # REMOVE LINE @ PLAY QUEUE in PLAYED LIST >>> VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null

      echo
      read -r -p "Remove a video from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
                                        echo
                                        echo "Line deleted from the play queue . . ."
                                        sleep .4


fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue

fi
;;


####################################################################################################
y)  # REMOVE BLOCK @ PLAY QUEUE in PLAYED LIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
      echo

      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                    if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else  
                                                                # MOVE LINE
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
                                                                echo
                                                                echo "Block Removed . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;



####################################################################################################
m)  # MOVE LINE @ PLAY QUEUE in PLAYED LIST >>> VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

     cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
     # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
     echo

      # Home >>> PLAYED LIST >>> View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/playlists/playlist.queue <<<""$linenumber"m"$linenumber2"|wq"
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 
                                                                echo
                                                                echo "Line moved . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;


###########################################################################
v)  # MOVE BLOCK PLAY QUEUE (PLAYED LIST)
###########################################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
clear
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
echo
read -r -p "Start block cut: " linenumber  # waiting fot user input
echo
read -r -p "End block cut: " linenumber2

# GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutQ # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/playlists/playlist.queue  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste1Q # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste2Q # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1Q ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-paste2Q > ~/.config/videoinfox/playlists/playlist.queue
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
echo
echo "Block moved . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


o) # START AUTOPLAY (PLAYED LIST >>> VIEW PLAYLIST >>> CHANGE AND QUEUE >> PLAY QUEUE)
# START AUTOPLAY Play Queue @@@@@@@@
# SET COUNTER TO ZERO.
i=0

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/playlists/playlist.queue"
#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"

read chkplq < ~/.config/videoinfox/playlists/playlist.queue

if [ -z "$chkplq" ]
   then
       echo
       echo " Play Queue Empty . . ."
       sleep .4
 
   else      

if [ -f  ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp ]
   then
       clear
       cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else

tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.autoplay 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

#  ASSIGN QUEUE LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/playlist.queue.autoplay"
#  LIST INPUT FOR LOOP
input="$moddedplayedlist"

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi
fi
fi
;;


     # RESUME AUTOPLAY Play Queue @@@@@@@@
############################################################
l) # RESUME AUOTOPLAY (Play Queue)
############################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
then
    :
else
    echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

        if [ -z "$resumedisplay" ]
          then
              :
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9

          else

              i=0
              OLDIFS=$IFS
              IFS=$'\n'

              # READ LINE TO DISPLAY VIDEO NAME BEFORE PLAY              
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3          

input2=$HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp
mv ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
;;




esac
done
;;
    
z)  # CHANGE PLAYLIST

# GET CURRENT PLAYLIST
read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current

# SAVE CURRENT PLAYLIST
#cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Loaded playlist: ""$setplaylist"
read -r -p "Change playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

            # CREATE FILE MOVING SELECTION TO THE TOP
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # READ FIRST LINE OF FILE
            read plselected < ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # WRITE SELECTED PLAYLIST
            echo "$plselected" > ~/.config/videoinfox/videoinfo.playlist.current

            # LOAD SELECTED PLAY LIST
            cp "$plselected" ~/.config/videoinfox/videoinfo.playlist 2>/dev/null

            # READ ACTIVE PLAYLIST FOR DISPLAY
            cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
            read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current
            read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
    
   fi


      fi
fi
fi
fi
;;   


r)  # RENAME PLAYLIST (PLAYED LIST)

clear
cat /home/homeserver/.config/videoinfox/tmp/playlist.dirlist.tmp
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1) # GETTING NUMBER OF PLAYLISTS
echo
read -r -p "Rename playlist: " linenumber 

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/file-to-be-renamed.tmp 2>/dev/null
read -r selectedtorename < ~/.config/videoinfox/tmp/file-to-be-renamed.tmp
echo "$selectedtorename"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread00.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
read -r renfrom < ~/.config/videoinfox/tmp/plread00.tmp

if [[ "$renfrom" == "Default" ]]
  then
      echo
      echo "The default playlist list cannot be renamed . . ."
      sleep 2
  else

clear
echo
echo " Selected Playlist: ""$renfrom"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Rename Playlist: " renpl  # waiting fot user linenumber. grabbing new filename

echo "$renpl" > ~/.config/videoinfox/tmp/plremovedotrn.tmp # write user input
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedotrn.tmp # Strip out any dots from user entry
read renamepl < ~/.config/videoinfox/tmp/plremovedotrn.tmp  # displayed name

if [[ "$renamepl" == "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

if [ -f "$HOME/.config/videoinfox/playlists/vplaylist.""$renamepl" ]
  then 
      echo
      echo " File already exists . . ."
      sleep .4
  else

if [ -z "$renamepl" ]
  then
      :
else

if [[ "$setplaylist" = "$renfrom" ]]
  then  # PLAYLIST IS LOADED
cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$renamepl"
echo "$HOME""/.config/videoinfox/playlists/vplaylist.""$renamepl" > ~/.config/videoinfox/videoinfo.playlist.current # WRITE SELECTED PLAYLIST
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
cp ~/.config/videoinfox/playlists/vplaylist."$renamepl" ~/.config/videoinfox/videoinfo.playlist # LOAD RENAMED PLAYLIST
rm "$selectedtorename" 2>/dev/null
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
echo
echo " Playlist renamed and reloaded . . ."
sleep .4
  else # PLAYLIST ISN'T LOADED

cp "$selectedtorename" ~/.config/videoinfox/playlists/vplaylist."$renamepl"
rm "$selectedtorename" 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
echo
echo " Playlist renamed . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


   
         d)  # DELETE PLAYLIST

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# SELECT A PLAYLIST TO DELETE
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Delete playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :

  else

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else
                  echo
                      # CREATE FILE MOVING SELECTION TO THE TOP
                      tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      # READ FIRST LINE OF FILE
                      read plselected < ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread0.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
                      read -r plselected2 < ~/.config/videoinfox/tmp/plread0.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE $pselecteda                     

                      if [[ "$plselected2" == "Default" ]]
                      then
                      echo "The default playlist list cannot be deleted. It can only be cleared . . ."
                      sleep 2
                      else

                      function menucpl {
                  
                      clear
                      echo
                      echo " Delete Playlist . . ."
                      echo
                      echo " $plselected"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 optioncpl
                      echo
                      }

                      while true
                      do
	                menucpl
	                case $optioncpl in

	                y)  # YES

                      rm "$plselected" 2> /dev/null

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME
                      read -r plselectedla < ~/.config/videoinfox/tmp/plread.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE  $pselecteda
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay 2> /dev/null  # REMOVE PLAYLIST.last.autoplay  file
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay.nextup 2> /dev/null  # REMOVE PLAYLIST.last.autoplay.nextup  file
                      echo
                      echo  " Playlist Deleted . . ."
                      sleep .7

                      if [[ "$setplaylistfull" = "$plselected" ]]  # IF DELETED PLAYLIST = ACTIVE PLAYLIST
                        then # SET DEFAULT PLAYLIST TO ACTIVE PLAYLIST
                            echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current
                            cp ~/.config/videoinfox/playlists/vplaylist.Default ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
                            setplaylist="Default"
                            echo
                            echo " Loaded playlist was deleted. Default playlist loaded . . ."
                            sleep 2

                        else
                            :
                      fi
 
                      break
                      ;;


                      n)  # NO
                      break;;

                      *)
        
                      esac
                      done
        
            fi
      fi
fi
fi
fi
fi            
;;        


    c)
         # CREATE PLAYLIST
echo
echo " Create Empty Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            echo > ~/.config/videoinfox/videoinfo.playlist  # WRITE TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7 
        fi
       
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7

fi
fi
fi
;; 


esac
done
;;
#!!!!!!!!!!!!!!!!!!!!!!! END PLAY QUEUE


          p) 
          #  @PLAY CLIPBOARD - <PLAYLIST>        

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdirz="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload  
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
             else
                  read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

           
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
          then
              :
          else     
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST File  
              $defplayer "${defplayargu[@]}" &> /dev/null "$ytdlplast"  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdirz"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi
 
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      echo " PLAYLIST Closed"
  
        else
            
            echo
            echo
            echo " No playable content in the clipboard . . ."
            sleep .9
      fi   
  fi
  ;;  
               

         d)  # CLEAR PLAYLIST (VIEW PLAYLIST)

        function menucpl {
        
        clear
        echo
        echo
        echo " Clear current playlist: ""$setplaylist""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optioncpl
        echo
        }

        while true
        do
	  menucpl
	  case $optioncpl in

	  y)  # YES
        rm ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
        echo > ~/.config/videoinfox/videoinfo.playlist
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
        read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
        cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST 
        echo
        echo " ""$setplaylist"" Playlist Cleared . . ."
        sleep .7  
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


*)

esac
done
;;
#@@@@@@@@@@@@@ END PLAYED LIST >>> VIEW PLAYLIST



k)
##################################################################################################################################################
###########################   ADD TO PLAYLIST  k   (PLAYED LIST)  ################################################################################
##################################################################################################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplhome < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playedlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.played-list 2>/dev/null

      echo
      read -r -p "Add video to playlist $whatplhome: " linenumber  # waiting fot user input 

      # REMOVE BLANK LINES
      sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null


      # create file moving selected line number to the top
      tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playedlist-apa > ~/.config/videoinfox/tmp/videoinfo.playedlist-playnumber.tmp 2>/dev/null


# GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playedlist-apa 2>/dev/null | cut -d' ' -f1)

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else

if [ "$linenumber" = 0 ]
  then
      :
  else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else


      # read first line of file for play
      read playnumber < ~/.config/videoinfox/tmp/videoinfo.playedlist-playnumber.tmp
      if [ -z "$playnumber" ]
        then
            :
        else
     read -r hspa < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay 
     if [ -z "$hspa" ]
       then  # resume marker is empty
           echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playlist
           read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
           cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST   
           echo
           echo "$playnumber" 
           echo
           echo "Added to Playlist . . ."
           sleep .7
       else  # resume marker exists. 
           echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playlist
           read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
           cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
           echo "$playnumber" >> ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # UPDATE RESUME LIST   
           echo
           echo "$playnumber" 
           echo
           echo "Added to Playlist . . ."           
           sleep .7
fi
fi
fi
fi
fi
fi

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1

fi
;;

      
          p) 
          #  @PLAY CLIPBOARD - <PLAYED LIST>        

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdir="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload  
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
                 else
                     read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

           
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
          then
              :
          else     
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List File  
              $defplayer "${defplayargu[@]}" 2> /dev/null "$ytdlplast"  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdir"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      #read -p " Press enter to continue . . ."
      
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      echo " Played List Closed"
  
        else
            
            echo
            echo
            echo " No playable content in the clipboard . . ."
            sleep .9
      fi   
  fi
  ;;  


                d)  # CLEAR Played List
        function menudelq {
        sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playedlist # remove blank lines
        read -r qempty < ~/.config/videoinfox/videoinfo.playedlist
        clear
        echo
        echo " Delete Played List?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
                 
        if [ -z "$qempty" ]
          then
              echo
              echo " Played List was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfo.playedlist                  
              echo
              echo " Played List DELETED . . ."
              echo
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;




                *)

                esac
                done
                ;; 


##################################################################################################################################################
s) #######################  @PLAYLIST - (HOME)  ################################################################################################### 
##################################################################################################################################################

grabdir="$PWD"  # SAVE CURRENT DIRECTORY FOR RESTORE ON EXIT

cd ~/.config/videoinfox/playlists


function menuvhome {

sed -i '/^$/d' ~/.config/videoinfox/videoinfo.playlist  # remove all blank lines

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]
  then
      :

  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

read -r savedpl < ~/.config/videoinfox/videoinfo.playlist.current # full name and path of the saved playlist
loadedpl="$HOME/.config/videoinfox/videoinfo.playlist" # full name and path of the loaded playlist
if cmp --silent -- "$savedpl" "$loadedpl"  # compare the saved playlist to the loaded playlist and update the saved playlist on: FILES ARE DIFFERENT  
  then # files are the same
      :
  else # FILES ARE DIFFERENT every time an edit is made to the loaded playlist
      cp ~/.config/videoinfox/videoinfo.playlist "$savedpl" 2>/dev/null  # SAVE THE LOADED PLAYLIST
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # CLEAR START MARKER
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup # CLEAR RESUME MARKER
      echo
      echo "Saving loaded playlist . . ."
      sleep .4
fi

clear

cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/tmp/videoinfo.playlist-apa


#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-apa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYLIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYLIST TO VARIABLE: $moddedplaylist 
moddedplaylist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-apa"

#  PLAYLIST INPUT FOR LOOP
input="$moddedplaylist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null



#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

   
else #  NO LINES START WITH A SLASH /   remove empty files
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
     rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null     
fi


clear


if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null
        #dashit=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")
        dashit=$(echo "~") #
   else
        dashit=$(echo "-") # 
        echo
        echo "Playlist Empty . . ."
fi

#cat ~/.config/videoinfox/videoinfo.playlist 

# check if directory ~/.config/videoinfox/playlists is empty.  if it is, set playlist to Default 
searchtotal=$(find "$PWD" -type f \( -iname "vplaylist.*" \) 2>/dev/null | wc -l)

if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>
  then
      echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current             
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
      rm ~/.config/videoinfox/tmp/plread.tmp
      # GET CURRENT PLAYLIST
      read -r activeplaylist < ~/.config/videoinfox/videoinfo.playlist.current
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      # SAVE CURRENT PLAYLIST
      cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylist"
     
  else
      cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp 
      
      read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current

      read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp

      rm ~/.config/videoinfox/tmp/plread.tmp
fi

echo
echo "Playlist: ""$setplaylist"

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresume=$(echo -e \ "         ")
      vpclresume=$(echo -e \ "               ")
  else
      vpresume="l - Resume"
      vpclresume="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resume-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resume-display.tmp > ~/.config/videoinfox/tmp/resume-display.tmp2 2>/dev/null
      read resumedisplay3 < ~/.config/videoinfox/tmp/resume-display.tmp2
      plresumenum=$(grep -Fn "$resumedisplay3" ~/.config/videoinfox/videoinfo.playlist | awk -F ':' '{print $1}')
      echo "Resume:" "$plresumenum" "$resumedisplay3"
fi 

##################################################################################################################################################

#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY

##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

#echo "Directory: ""$PWD"

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      echo
      echo "Clipboard: ""$pasteclip"
  else
      :
fi


if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                            

                  else 
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                 
            fi
  else

      if [ -f "$pasteclip" ]  # 
        then
                      echo
                      echo "Clipboard: ""$pasteclip"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p * Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo                                                                                  

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> VIEW PLAYLIST                                                  ""Intermission:" "$vto" "seconds"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j - Play     o - Start            c - Change and Queue     r - Remove Line      m - Move Line            q - Quit"
                      echo " t - Intr     $vpresume           p - Play Clipboard       y - Remove Block     v - Move Block           h - Help"
                      echo " i - Info     $vpclresume     x - Clrclp               g - Remove Dupes     d - Clear Playlist       $mpvdisplay1"
                      echo
fi
fi


echo -en " Enter Option: "
read -r -n1 optionv


}

        while true
        do
	    menuvhome
	    case $optionv in
    
        q)  # QUIT        
        cd "$grabdir"
        break;;

        x) 
        # CLRCLP 
        echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        ;;


        t) # Intermission
        read -r vto < ~/.config/videoinfox/videoinfox.intermission
        clear
        echo
        echo " Current Intermission:" "$vto"
        echo
        echo " Intermission range is 1 to 86400 seconds (24 hours)"
        echo
        read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;

       
        h)
        clear
        echo " _________________________________________________________________________________________________________________"
        echo
        echo " "$der" >>> VIEW PLAYLIST >>> HELP"        
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  The loaded playlist is saved when any of the below edits are made."
        echo "  If any of the following options are run in View Playlist or the Play Queue, the resume marker will be cleared."
        echo
        echo "  - Remove Line   - Remove Block   - Remove Dupes   - Move Line   - Move Block   - Clear Playlist or Queue"
        echo
        echo "  Move Line and Move Block: To insert above line 1 enter 0"
        echo
        echo "  Note: Pressing enter with no entry instead of entering a number will cancel the edit."
        echo " _________________________________________________________________________________________________________________" 
        echo
        echo "  Start and Resume: When resume reaches the end of the playlist, the last video will stay in resume until"
        echo "                    start or clear resume are run or if any of the above edits are made."
        echo
        echo "  - Playlist Add will update an existing resume list with the added video."
        echo "  - Add to Queue in Change and Queue will update an existing resume list with the added playlist."
        echo "  - Rename an existing playlist. If a resume list exists, it will also be renamed."
        echo " _________________________________________________________________________________________________________________"
        echo        
        echo "  - Change and Queue: Playlist and Play Queue management. All the playlists are displayed on this screen."
        echo
        echo "  PLAYLIST: - Change - Create - Rename - Delete - Save As       QUEUE: - Add to Queue - Queue List - Play Queue"      
        echo " _________________________________________________________________________________________________________________"
        echo
        echo "  Mpv Playlist: This option will load a playlist into Mpv. This will bypass the -Resume option and the"
        echo "  Intermission Screen in Videoinfox. Mpv will keep track of the playlist position instead of Videoinfox's"
        echo "  resume option. Located in Change and Queue"
        echo " _________________________________________________________________________________________________________________"
        echo
        read -p " Press enter to continue . . ."
        ;;

        g)  # Remove Duplicates playlist
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfo.playlist
        clear
        echo
        echo " Remove Duplicates?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Playlist Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfo.playlist | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfo.playlist.tmp
              cp ~/.config/videoinfox/tmp/videoinfo.playlist.tmp ~/.config/videoinfox/videoinfo.playlist
              read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
              cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


     b) # CLEAR RESUME PLAYLIST

if [ -z "$resumedisplay2" ]
  then
      :
  else        
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumedisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > "$setplaylist".last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;      


        o) # START AUTOPLAY (HOME >>> VIEW PLAYLIST)
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else
                              
       tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'
       i=0

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfo.playlist-apa-nextup.tmp
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > "$setplaylist".last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi

   else
       :
fi
;;



#################################################################
r)  # REMOVE LINE  (HOME >>> VIEW PLAYLIST)
#################################################################

# delete a line example to remove by pattern
#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist


# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> HOME >>> View Playlist
      read -r -p "Enter line number to remove video from the playlist $whatplpld: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfo.playlist 2> /dev/null 
                                        echo
                                        echo "Line deleted from the playlist . . ."
                                        #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                        #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                        sleep .4
fi
fi
fi
fi
fi
fi
fi
;;


################################################################
y)  # REMOVE BLOCK  (HOME VIEW PLAYLIST)
################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist 
                                                                echo
                                                                echo "Block removed . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


################################################################
m)  # MOVE LINE  (HOME VIEW PLAYLIST)
################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp
rm ~/.config/videoinfox/tmp/whatplpld.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null

      echo
      # Home >>> HOME View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfo.playlist <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                            #read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
                                                            #cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


###################################################################
v)  # MOVE BLOCK  (HOME >>> VIEW PLAYLIST)
###################################################################

cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplpld.tmp  # .playlist name 
read -r whatplpld < ~/.config/videoinfox/tmp/whatplpld.tmp

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi

if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo.number.play-list 2> /dev/null
      echo
      read -r -p "Start block cut: " linenumber  # waiting fot user input
      echo
      read -r -p "End block cut: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cut # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/videoinfo.playlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-path | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.number 
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlist | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/videoinfo.playlist  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste1 # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlist > ~/.config/videoinfox/tmp/playlist.mb-paste2 # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1 ~/.config/videoinfox/tmp/playlist.mb-cut ~/.config/videoinfox/tmp/playlist.mb-paste2 > ~/.config/videoinfox/videoinfo.playlist
echo
echo "Block moved . . ."
sleep .7

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


##################################################################
l) # RESUME AUOTOPLAY# (HOME >>> PLAYLIST)
##################################################################

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
fi

if [ -f ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
fi

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
        read < $HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay resumedisplay

        if [ -z "$resumedisplay" ]
          then
              #echo
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9
              :
          else
              i=0
              OLDIFS=$IFS
              IFS=$'\n'
    
              # READ FIRST LINE TO DISPLAY VIDEO NAME BEFORE PLAY
              
              echo
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3
          
input2=$HOME/.config/videoinfox/playlists/"$setplaylist".last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
    echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay > ~/.config/videoinfox/playlists/pl-tmp
mv ~/.config/videoinfox/playlists/pl-tmp ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay

IFS=$OLDIFS

fi

   else
       #echo
       #echo
       #echo " Playlist Empty . . ."
       #sleep 1.9
       :
fi
;;

      
        j) # PLAY LINE  (HOME >>> PLAYLIST)

if [ -f ~/.config/videoinfox/tmp/videoinfo.number.play-list ]
   then
clear
cat ~/.config/videoinfox/tmp/videoinfo.number.play-list
echo
read -r -p "Play: " linenumber  # waiting fot user input

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/videoinfo.playlist-apa

if [ -z "$line" ]

  then
      :

  else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAYLIST >>> PLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
IFS=$OLDIFS

rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa2 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo.number.play-list 2>/dev/null

fi
fi

else
       echo
       echo
       echo " Playlist Empty . . ."
       sleep .4
fi

;;


       i)  # INFO - HOME >>> PLAYLIST
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo.playlist-apa ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo.playlist-apa > ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo.playlist-apa.tmp 2>/dev/null

                 fi
fi
        else
            :

            fi

      fi

;;       


########################################################################################################################################################
          c)
          # CHANGE AND QUEUE
########################################################################################################################################################

function changepl {

#read -r savepl < ~/.config/videoinfox/videoinfo.playlist.current
#cp ~/.config/videoinfox/videoinfo.playlist "$savepl"

# cd ~/.config/videoinfox/playlists

# FIND PLAYLISTS
find "$PWD" -type f \( -iname "vplaylist.*" \) > ~/.config/videoinfox/videoinfo.playlist.dirlist

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist 

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp ~/.config/videoinfox/videoinfo.playlist.dirlist

# REMOVE PATH
sed 's/.*\///' ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp

# REMOVE FILENAME AND LEAVE EXTENSION
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed 's/.*\.//' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp


# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.dirlist.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.dirlist.tmp2
mv ~/.config/videoinfox/tmp/playlist.dirlist.tmp2 ~/.config/videoinfox/tmp/playlist.dirlist.tmp 


clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Playlist: ""$setplaylist"
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" VIEW PLAYLIST >>> CHANGE AND QUEUE"       
echo "___________________________________________________________________________________________________________________"
echo
echo " z - Change      r - Rename           a - Add to Queue                               m - Mpv Playlist     q - Quit"
echo " c - Create      d - Delete           b - Queue List"
echo " s - Save As                          p - Play Queue"
echo
echo -en " Enter Option: "
read -r -n1 optioncpl
echo
}


while true
do
changepl
case $optioncpl in


        q)  # QUIT
        ###cd "$grabdir"
        break ;;


        s)  # SAVE AS
clear
echo
echo " Playlist:" "$setplaylist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Save Playlist As... " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES

        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST IS LOADED
            echo
            echo " Save as... name can't be the same as the loaded playlist . . ."
            sleep 2
        
        else
            cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
            echo
            echo " Playlist Saved . . ."
            sleep .7
        fi

        break
        ;;


        n)  # NO
        break;;

        *)        
        esac
        done  

        else
        cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$createpl"
        echo
        echo " Playlist Saved . . ."
        sleep .7

fi
fi
fi
;; 


  m)  # MPV PLAYLIST
# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
echo
echo " When using Mpv Playlist and back track <| or forward track |> are selected in mpv, the mpv play position marker"
echo " will be erased for the video that was playing (if it had a marker) when <| or |> were selected. To avoid any"
echo " mpv play markers from being erased, use Start and Resume in View Playlist instead of Mpv Playlist to watch a"
echo " playlist."
echo
echo " Mpv will only save a play position marker when Mpv quit(q) is used while playing a video."
echo " If Mpv is quit when a video is paused, it will restart the video paused."
echo
read -r -p " Press enter to continue . . ."

clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Mpv Playlist: " linenumber  # waiting fot user input

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]
        then 
            echo
            echo "Number out of range . . ."
            sleep .4
        else
            if ! command -v mpv &> /dev/null ####### Check for mpv and set if installed ########
              then
                  echo
                  echo "mpv not found . . ."               
                  sleep .4
              else
                  # CREATE FILE MOVING SELECTION TO THE TOP
                  tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/mpv-playlist.tmp

                  # READ FIRST LINE OF FILE
                  read mpvpl < ~/.config/videoinfox/tmp/mpv-playlist.tmp
                  mpv --fs --no-terminal --sid=no --save-position-on-quit --playlist="$mpvpl"
           fi    
      fi
fi
fi
fi
;;



        b)  # QUEUE LIST in HOME VIEW PLAYLIST >>> CHANGE AND QUEUE    
        function plqueue {

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
  then
      dashit=$(echo -e "~")
  else
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      dashit=$(echo "-")
fi 

clear
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue

if [ -z "$qempty" ]
  then
      echo > ~/.config/videoinfox/videoinfox-playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
      echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3               
      echo
      echo "Queue List Empty . . ."

else
# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

fi

cp ~/.config/videoinfox/videoinfox-playlist.queue ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfo.playlist-queueapa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2  
      else
          :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\.//' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

fi

cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

####### !!!!!!!!!!!!!!!!!!HOME >>> VIEW PLAYLIST >>> CHANGE QUEUE >>> QUEUE LIST 
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> QUEUE LIST"        
echo "___________________________________________________________________________________________________________________"
echo
echo " m - Move Line     r - Remove Line     g - Remove Dupes     z - Rebuild Queue     d - Clear Queue         q - Quit"
echo
echo -en " Enter Option: "
read -r -n1 option
echo
}

while true
do
plqueue
case $option in


        q)  # QUIT   (Play Queue)
        break ;;


####################################################################################################
m)  # MOVE LINE --- VIEW PLAYLIST >>> CHANGE AND QUEUE - QUEUE LIST)
####################################################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queuelist.video.number 2>/dev/null


      #cat ~/.config/videoinfox/tmp/playlist.queuelist.video.number
      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2> /dev/null
      echo

      # Home >>> HOME View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l  ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/videoinfox-playlist.queue <<<""$linenumber"m"$linenumber2"|wq" 
                                                                echo
                                                                echo "Line moved . . ."
                                                                echo
                                     echo "Run Rebuild Queue to update the Play Queue with this change."
                                                                
                                                                echo
                                                                read -r -p "Press enter to continue . . ."
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
;;

       
###############################################################################
r)  # REMOVE LINE (HOME >>> VIEW PLAYLIST >>> CHANGE AND QUEUE >>> QUEUE LIST)
###############################################################################

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]  # if file exists goto then
  then
        
clear
      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/videoinfox-playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.number 2>/dev/null


      cat ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3 2>/dev/null

      echo
      read -r -p "Enter line number to remove playlist from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/videoinfox-playlist.queue 2> /dev/null 
                                        echo
                                        echo "Line deleted from the queue list . . ."
                                        echo
                                        echo "Run Rebuild Queue to update the Play Queue with this change."
                                        echo
                                        read -r -p "Press enter to continue . . ."


fi
fi
fi
fi
fi
fi

else
    echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi
clear
;;


        g)  # Remove Duplicates Play Queue
        function menurdup {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Remove Duplicate Playlists?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in


	  y)  # YES
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates
              cat -n ~/.config/videoinfox/videoinfox-playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/videoinfox-playlist.queue
              
              echo
              echo "Duplicates Removed . . ."
              echo
              echo "Run Rebuild Queue to update the Play Queue with this change."
              echo
              read -r -p "Press enter to continue . . ."
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;
 


        z) # REWRITE QUEUE WITH CURRENT LIST
        # WRITE QUEUE
        function rewrque {
        clear
        echo
        echo " Any edits made in the Play Queue will be lost if Yes is selected."
        echo
        echo " The current play queue can be saved first by selecting No and make playlist in the play queue."
        echo
        echo " Rebuild Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        }

        while true
        do
	  rewrque
	  case $option in

y) #  Rebuild Play Queue  

echo > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

cp ~/.config/videoinfox/tmp/videoinfo.playlist-queueapa2 ~/.config/videoinfox # update for any deleted playlists that were in the queue upon delete
mv ~/.config/videoinfox/videoinfo.playlist-queueapa2 ~/.config/videoinfox/videoinfox-playlist.queue

# Play Queue FILE
input1=~/.config/videoinfox/videoinfox-playlist.queue

read -r chkforempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$chkforempty" ]
then
echo
echo
echo " Play Queue Empty . . ."
sleep .4
break

else
# LOOP 1 READ LINE BY LINE DOWNLOAD QUEUE LIST
while read -r line
do

input2="$line"

# WRITE LINE TO TEMP FILE.  LIST WITH FULL PATH
echo "$line" > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp

# LOOP 2 READ LINE BY LINE
    while read -r line  
    do
    echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

    done < "$input2"
done < "$input1"

      # REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
      sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

      # NUMBER THE LISTS (playlist names loaded into queue   playlist video list queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null
cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay # CLEAR RESUME LIST

echo
echo
echo " Queue Rebuilt . . ."
sleep .4                      
fi
break
;;

n)  # NO       
break;;

*)
        
esac
done
;;

        d)  # CLEAR QUEUE LIST  (Play Queue)
        function menudelq {
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
                 
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo > ~/.config/videoinfox/tmp/videoinfo.number.playlist-queue3
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;
       
        esac
        done
        ;;     


   a)  # ADD TO QUEUE (Playlist)

linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.dirlist.tmp | cut -d' ' -f1)  # GETTING LINECOUNT
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Add a playlist to the play queue: " linenumber  # waiting fot user input

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.playlist.q.tmp # read first line         
            echo "$playnumber" >> ~/.config/videoinfox/videoinfox-playlist.queue # FULL PATH WITH FILENAME

            tail -n +"$linenumber" ~/.config/videoinfox/tmp/playlist.dirlist.tmp > ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp 2>/dev/null
            sed -i 's/^ *[0-9]\+.//g' ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # REMOVE PATH UP TO AND INCLUING DOT
            read playnumber2 < ~/.config/videoinfox/tmp/videoinfox.playlist.q2.tmp # read first line
      
            echo
            echo "$playnumber2" "added to the play queue . . ."
            sleep .4
# REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/videoinfox-playlist.queue &>/dev/null
      
# WRITE QUEUE
cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

input1="$playnumber"
read -r hspa < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
# READ LINE BY LINE
while read -r line  
do
echo "$line" >> ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2

if [ -z "$hspa" ]
  then  # resume marker is empty
      :
  else 
      echo "$line" >> ~/.config/videoinfox/playlists/playlist.queue.last-autoplay 
fi
done < "$input1"

# REMOVE PATH AND FILENAME UP TO AND INCLUDING DOT LEAVING PLAYLIST NAME
sed 's/.*\.//' ~/.config/videoinfox/videoinfox-playlist.queue > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2  

# NUMBER THE LISTS (playlist video list queue  playlist names loaded into queue)
sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.queue2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue2.tmp 2>/dev/null

cp ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 ~/.config/videoinfox/playlists/playlist.queue

sed '/./=' ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.tmp3 2>/dev/null
                      
fi
fi
fi
fi
fi
;;


        p)   # PLAY QUEUE > Navigate Tree -Show All -View Playlist -Change and Queue

function playque {

clear

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi

if [ -f ~/.config/videoinfox/videoinfox-playlist.queue ]
then
:
else
echo > ~/.config/videoinfox/videoinfox-playlist.queue
fi

# REMOVE PATH ONLY LEAVING FILENAME
sed 's/.*\///' ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.work
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/playlist.queue.work | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST

read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
if [ -z "$qempty" ]
  then
      echo " Play Queue Empty . . ."
  else
      :
fi

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
  then
      :
  else
      echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay2 < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay
if [ -z "$resumedisplay2" ]
  then
      vpresumeq=$(echo -e \ "         ")
      vpclresumeq=$(echo -e \ "               ")
  else
      vpresumeq="l - Resume"
      vpclresumeq="b - Clear Resume"
      echo "$resumedisplay2" > ~/.config/videoinfox/tmp/resumeq-display.tmp
      # REMOVE PATH ONLY LEAVING FILENAME
      sed 's/.*\///' ~/.config/videoinfox/tmp/resumeq-display.tmp > ~/.config/videoinfox/tmp/resumeq-display.tmp2 2>/dev/null
      read resumeqdisplay3 < ~/.config/videoinfox/tmp/resumeq-display.tmp2
      plresumenum=$(grep -Fn "$resumeqdisplay3" ~/.config/videoinfox/playlists/playlist.queue | awk -F ':' '{print $1}')
      echo
      echo "Resume:" "$plresumenum" "$resumeqdisplay3"
fi 

echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> PLAY QUEUE                                                     ""Intermission:" "$vto" "seconds"        
echo "___________________________________________________________________________________________________________________"
echo
echo " j - Play     o - Start            z - Make Playlist     r - Remove Line      m - Move Line               q - Quit"
echo " t - Intr     $vpresumeq                                 y - Remove Block     v - Move Block" 
echo " i - Info     $vpclresumeq                           g - Remove Dupes     d - Clear Queue             $mpvdisplay1"
echo
echo -en " Enter Option: "
read -r -n1 optionpq
echo
}


while true
do
playque
case $optionpq in


        q)  # QUIT   (Play Queue)
        break ;;


        b) # CLEAR RESUME PLAY QUEUE

if [ -z "$resumedisplay2" ]
  then
      :
  else    
        function rclear {
        clear
        echo
        echo " Clear Resume: ""$resumeqdisplay3""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  rclear
	  case $option in

	  y)  # YES
        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
fi
        ;;


        t) # Intermission
    read -r vto < ~/.config/videoinfox/videoinfox.intermission
    clear
    echo
    echo " Current Intermission:" "$vto"
    echo
    echo " Intermission range is 1 to 86400 seconds (24 hours)"
    echo
    read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;


       z) # QUEUE TO PLAYLIST
read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
if [ -z "$qempty" ]
then
echo
echo " Play Queue Empty . . ."
sleep .4

else
clear
echo
echo " Queue to Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"  # add user input as file extension

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else
      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue ~/.config/videoinfox/videoinfo.playlist  # WRITE RESULTS TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE TO THE PLAYLIST DIRECTORY            
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7 
        fi        
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            cp ~/.config/videoinfox/playlists/playlist.queue "$plname"  # WRITE SEARCH RESULTS TO THE PLAYLIST DIRECTORY 
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7
fi
fi
fi
;; 

      
        d)  # DELETE QUEUE LIST  (Play Queue)
        function menudelq {
   
        clear
        echo
        echo " Delete Play Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
         
        read -r qempty < ~/.config/videoinfox/videoinfox-playlist.queue
        
        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue was already deleted . . ."
              sleep .4

          else
              echo > ~/.config/videoinfox/videoinfox-playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
              echo
              echo " Play Queue Deleted . . ."
              sleep .4

        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


        g)  # Remove Duplicates Play Queue
        function menurdup {

        if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
        then
        :
        else
        echo > ~/.config/videoinfox/playlists/playlist.queue
        fi
        
        read -r qempty < ~/.config/videoinfox/playlists/playlist.queue
        clear
        echo
        echo " Remove duplicate videos from the play queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  menurdup
	  case $option in

	  y)  # YES

        if [ -z "$qempty" ]
          then
              echo
              echo " Play Queue Empty . . ."
              sleep .4
          else
              # Remove Duplicates     
              cat -n ~/.config/videoinfox/playlists/playlist.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp
              cp ~/.config/videoinfox/tmp/videoinfox-playlist.queue.tmp ~/.config/videoinfox/playlists/playlist.queue              
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay 2>/dev/null
              echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null
              echo
              echo " Duplicates Removed . . ."
              sleep .4
        fi
        break
        ;;

        n)  # NO       
        break;;

        *)
        
        esac
        done
        ;;


   i)  # INFO - HOME >>> PLAYLIST >>> Play Queue
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
              then
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else

             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo.playlist.info.queue.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                 fi
fi
        else
            echo
            echo
            echo " Play Queue Empty . . ."
            sleep .4            


            fi

      fi

;;       


j) # PLAY LINE  (HOME >>> PLAYLIST >>> Play Queue)

# GETTING LINE COUNT
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue | cut -d' ' -f1)
clear
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]
   then
       echo
       read -r -p "Play: " linenumber  # waiting fot user input



if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then 
      :

  else 


      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]

              then 
                  :
              else

       tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp 2>/dev/null
       mv ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa.tmp ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa 2>/dev/null

       OLDIFS=$IFS
       IFS=$'\n'

       read line < ~/.config/videoinfox/tmp/videoinfo.playlist.queue-apa


fi
      fi
            fi



        if [ -z "$line" ]

         then
             :

         else

if [ "$linenumber" = 0 ]
  then
      :
  else

             clear
             echo
             echo "___________________________________________________________________________________________________________________"
             echo
             echo " ""$der"" >>> PLAY QUEUE >>> PLAY" 
             echo
             echo " [PLAYING]>" "$line"
             echo "___________________________________________________________________________________________________________________"
             echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
             echo
             echo
             echo " Video Player Controls:"
             echo                             
             echo " - Fullscreen Toggle: f"
             echo
             echo " - Play/Pause Toggle: space bar"
             echo
             echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
             echo
             echo " - Quit: q"      
             echo -e "\n"
             echo " This screen will quit when the video player is quit . . ."
             "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
             echo "$line" >> ~/.config/videoinfox/videoinfo.playedlist
             $defplayer "${defplayargu[@]}" "$line" 2> /dev/null
 
             IFS=$OLDIFS
        fi
fi

    else  # FILE IS EMPTY"
        echo
        echo
        echo " Play Queue Empty . . ."
        sleep .4


fi
;;


####################################################################################################
r)  # REMOVE LINE @ PLAY QUEUE in HOME VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null

      echo
      read -r -p "Remove a video from the queue: " linenumber  # waiting fot user input

      # GETTING NUMBER OF VIDEO FILES IN THE PLAYED LIST
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else
                                        # DELETE LINE NUMBER
                                        sed -i "${linenumber}d" ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                        echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
                                        echo
                                        echo "Line deleted from the play queue . . ."
                                        sleep .4


fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue

fi
;;


####################################################################################################
y)  # REMOVE BLOCK @ PLAY QUEUE in HOME VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f  ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
      echo

      # Home >>> HOME View Playlist
      read -r -p "Start block remove: " linenumber  # waiting fot user input
      echo
      read -r -p "End block remove: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                    if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else  
                                                                # MOVE LINE
                                                                # REMOVE BLOCK
                                                                sed -i "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
                                                                echo
                                                                echo "Block Removed . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;


####################################################################################################
m)  # MOVE LINE @ PLAY QUEUE in HOME VIEW PLAYLIST >>> CHANGE and QUEUE - PLAY QUEUE
####################################################################################################

#sed '\?^/mnt/MEDIA1/MOVIES/identity thief.mp4?d' videoinfo.playlist   # delete a line example to remove by pattern

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
      # REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
      #cat  ~/.config/videoinfox/playlists/playlist.queue | sed 's/.*\.//' > ~/.config/videoinfox/tmp/videoinfox-playlist.queue.list 

      clear

      # NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null

      cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
      # cat ~/.config/videoinfox/tmp/playlist.queue.video.number 2> /dev/null
      echo

      # Home >>> HOME View Playlist
      read -r -p "Move line: " linenumber  # waiting fot user input
      echo
      read -r -p "Insert line $linenumber below line: " linenumber2

      # GETTING NUMBER OF VIDEO FILES IN THE QUEUE
      linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else 
                                                                # MOVE LINE
                                                                ex ~/.config/videoinfox/playlists/playlist.queue <<<""$linenumber"m"$linenumber2"|wq"
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
                                                                echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 
                                                                echo
                                                                echo "Line moved . . ."
                                                                sleep .4
fi
fi
fi
fi
fi
fi
fi
fi
fi

else
echo > ~/.config/videoinfox/playlists/playlist.queue
fi
;;


###########################################################################
v)  # MOVE BLOCK PLAY QUEUE (HOME)
###########################################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue ]  # if file exists goto then
  then
clear
# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/playlists/playlist.queue | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.queue.video.number 2>/dev/null
cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp  # DISPLAY  THE LIST
echo
read -r -p "Start block cut: " linenumber  # waiting fot user input
echo
read -r -p "End block cut: " linenumber2

# GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
linecount=$(wc -l ~/.config/videoinfox/playlists/playlist.queue 2> /dev/null | cut -d' ' -f1) 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :

                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :

                                    else

                                         if [ -z "$linenumber2" ] # IF NO ENTRY GOTO THEN
                                           then
                                               :

                                                else
                                                    re='^[0-9]+$'
                                                    if ! [[ $linenumber2 =~ $re ]]
                                                      then
                                                          :
                                                      else

                                                          if [[ $linenumber2 -gt $linecount ]]
                                                            then 
                                                                echo
                                                                echo "Number out of range . . ."
                                                                sleep .4
                                                            else
                                                          if [[ $linenumber2 -lt $linenumber ]]
                                                            then
                                                                echo
                                                                echo "End must be greater than start . . ."
                                                                sleep .4
                                                            else
if [[ "$linenumber" == "$linenumber2" ]]
then
    echo
    echo "Numbers can't be the same . . ."
    sleep .4
else

sed -n "$linenumber,$linenumber2"p ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutQ # CUT BLOCK FROM LIST 
sed "$linenumber,$linenumber2"d ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ # LIST WITH BLOCK REMOVED
sed 's/.*\///' ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ # LIST WITH FILENAME ONLY
sed '/./=' ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.no-pathQ | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ # NUM LIST
clear
cat ~/.config/videoinfox/tmp/playlist.mb-cutfromlist.numberQ
echo
read -r -p "Paste block after number: " linenumber  # waiting fot user input

 # GETTING NUMBER OF VIDEO FILES IN THE PLAYLIST
      linecount=$(wc -l ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ | cut -d' ' -f1) # 

          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :

            else 

                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :

                  else

                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                          :
                      else
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  echo
                                  echo "Number out of range . . ."
                                  sleep .4

                              else


if [ "$linenumber" = 0 ]
  then
cat ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/playlists/playlist.queue  

  else
sed -n "1,$linenumber"p ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste1Q # CUT BLOCK FROM LIST
sed "1,$linenumber"d ~/.config/videoinfox/tmp/playlist.mb-cutfromlistQ > ~/.config/videoinfox/tmp/playlist.mb-paste2Q # LIST WITH BLOCK REMOVED
cat ~/.config/videoinfox/tmp/playlist.mb-paste1Q ~/.config/videoinfox/tmp/playlist.mb-cutQ ~/.config/videoinfox/tmp/playlist.mb-paste2Q > ~/.config/videoinfox/playlists/playlist.queue
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
echo
echo "Block moved . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


o) # START AUTOPLAY (HOME VIEW PLAYLIST >>> CHANGE AND QUEUE >> PLAY QUEUE)
# START AUTOPLAY Play Queue @@@@@@@@
# SET COUNTER TO ZERO.
i=0

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/playlists/playlist.queue"
#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"

read chkplq < ~/.config/videoinfox/playlists/playlist.queue

if [ -z "$chkplq" ]
   then
       echo
       echo " Play Queue Empty . . ."
       sleep .4
 
   else      

if [ -f  ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp ]
   then
       clear
       cat ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp
       linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfox-playlist.Aque.number.tmp 2> /dev/null | cut -d' ' -f1) # GETTING LINE COUNT
       echo
       read -r -p "Start: " linenumber  # waiting fot user input
      
          if ! [[ "$linenumber" -eq "$linenumber" ]] #2> /dev/null
            then  
                :
            else 
                if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
                  then
                      :
                  else
                      re='^[0-9]+$'
                      if ! [[ $linenumber =~ $re ]]
                      then
                      :
                      else

                      if [ "$linenumber" = 0 ]
                        then
                            :
                        else
      
                            if [[ $linenumber -gt $linecount ]]
                              then 
                                  :
                              else

                                  if [ -z "$linenumber" ]
                                    then
                                        :
                                    else

tail -n +"$linenumber" ~/.config/videoinfox/playlists/playlist.queue > ~/.config/videoinfox/tmp/playlist.queue.autoplay 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

#  ASSIGN QUEUE LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/playlist.queue.autoplay"
#  LIST INPUT FOR LOOP
input="$moddedplayedlist"

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/playlist.queue.autoplay.nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done

# WRITE 2nd PLAYLIST FOR RESUME AUTOPLAY OPTION . File: ~/.config/videoinfox/playlists/$playlistname.last-autoplay
tail -n +"$i" ~/.config/videoinfox/tmp/playlist.queue.autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
fi
fi
fi
fi
fi
fi
fi
;;


     # RESUME AUTOPLAY Play Queue @@@@@@@@
############################################################
l) # RESUME AUOTOPLAY (Play Queue)
############################################################

if [ -f ~/.config/videoinfox/playlists/playlist.queue.last-autoplay ]
then
    :
else
    echo > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay
fi

read resumedisplay < $HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

        if [ -z "$resumedisplay" ]
          then
              :
              #echo
              #echo " Run Start first to enable this feature . . ."
              #sleep 1.9

          else

              i=0
              OLDIFS=$IFS
              IFS=$'\n'

              # READ LINE TO DISPLAY VIDEO NAME BEFORE PLAY              
              echo
              echo " Resume: ""$resumedisplay"
              sleep .3          

input2=$HOME/.config/videoinfox/playlists/playlist.queue.last-autoplay

for line in $(cat "$input2" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY QUEUE >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/playlists/playlist.queue.last-autoplay-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

tail -n +"$i" ~/.config/videoinfox/playlists/playlist.queue.last-autoplay > ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp
mv ~/.config/videoinfox/tmp/playlist.queue.last-autoplay.tmp ~/.config/videoinfox/playlists/playlist.queue.last-autoplay

IFS=$OLDIFS

fi
;;

esac
done
;;
    

z)  # CHANGE PLAYLIST

# GET CURRENT PLAYLIST
read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current

# SAVE CURRENT PLAYLIST
#cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# LOAD A PLAYLIST
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
echo "Loaded playlist: ""$setplaylist"
read -r -p "Change playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

            # CREATE FILE MOVING SELECTION TO THE TOP
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # READ FIRST LINE OF FILE
            read plselected < ~/.config/videoinfox/tmp/playlist.dirlist.tmp3

            # WRITE SELECTED PLAYLIST
            echo "$plselected" > ~/.config/videoinfox/videoinfo.playlist.current

            # LOAD SELECTED PLAY LIST
            cp "$plselected" ~/.config/videoinfox/videoinfo.playlist 2>/dev/null

            # READ ACTIVE PLAYLIST FOR DISPLAY
            cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
            read -r setplaylistfull < ~/.config/videoinfox/videoinfo.playlist.current
            read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
    
   fi


      fi
fi
fi
fi
;;     


r)  # RENAME PLAYLIST (HOME)

clear
cat /home/homeserver/.config/videoinfox/tmp/playlist.dirlist.tmp
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1) # GETTING NUMBER OF PLAYLISTS
echo
read -r -p "Rename playlist: " linenumber 

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
  then
      :

  else
      if [[ $linenumber -gt $linecount ]]

        then 
            echo
            echo "Number out of range . . ."
            sleep .4

        else

tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/file-to-be-renamed.tmp 2>/dev/null
read -r selectedtorename < ~/.config/videoinfox/tmp/file-to-be-renamed.tmp
echo "$selectedtorename"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread00.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
read -r renfrom < ~/.config/videoinfox/tmp/plread00.tmp

if [[ "$renfrom" == "Default" ]]
  then
      echo
      echo "The default playlist list cannot be renamed . . ."
      sleep 2
  else

clear
echo
echo " Selected Playlist: ""$renfrom"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Rename Playlist: " renpl  # waiting fot user linenumber. grabbing new filename

echo "$renpl" > ~/.config/videoinfox/tmp/plremovedotrn.tmp # write user input
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedotrn.tmp # Strip out any dots from user entry
read renamepl < ~/.config/videoinfox/tmp/plremovedotrn.tmp  # displayed name

if [[ "$renamepl" == "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

if [ -f "$HOME/.config/videoinfox/playlists/vplaylist.""$renamepl" ]
  then
      echo
      echo " File already exists . . ."
      sleep .4
  else

if [ -z "$renamepl" ]
  then
      :
else

if [[ "$setplaylist" = "$renfrom" ]]
  then  # PLAYLIST IS LOADED
cp ~/.config/videoinfox/videoinfo.playlist ~/.config/videoinfox/playlists/vplaylist."$renamepl"
echo "$HOME""/.config/videoinfox/playlists/vplaylist.""$renamepl" > ~/.config/videoinfox/videoinfo.playlist.current # WRITE SELECTED PLAYLIST
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
cp ~/.config/videoinfox/playlists/vplaylist."$renamepl" ~/.config/videoinfox/videoinfo.playlist # LOAD RENAMED PLAYLIST
rm "$selectedtorename" 2>/dev/null
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp       
read -r setplaylist < ~/.config/videoinfox/tmp/plread.tmp
echo
echo " Playlist renamed and reloaded . . ."
sleep .4
  else # PLAYLIST ISN'T LOADED

cp "$selectedtorename" ~/.config/videoinfox/playlists/vplaylist."$renamepl"
rm "$selectedtorename" 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay ~/.config/videoinfox/playlists/"$renamepl".last-autoplay 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay 2>/dev/null
cp ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup ~/.config/videoinfox/playlists/"$renamepl".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom".last-autoplay.nextup 2>/dev/null
rm ~/.config/videoinfox/playlists/"$renfrom" 2>/dev/null
echo
echo " Playlist renamed . . ."
sleep .4

fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
;;


  
         d)  # DELETE PLAYLIST

# GETTING NUMBER OF PLAYLISTS
linecount=$(wc -l ~/.config/videoinfox/videoinfo.playlist.dirlist | cut -d' ' -f1)

# SELECT A PLAYLIST TO DELETE
clear
cat ~/.config/videoinfox/tmp/playlist.dirlist.tmp
echo
read -r -p "Delete playlist: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then
      :

  else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :

  else

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else
                  echo
                      # CREATE FILE MOVING SELECTION TO THE TOP
                      tail -n +"$linenumber" ~/.config/videoinfox/videoinfo.playlist.dirlist > ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      # READ FIRST LINE OF FILE
                      read plselected < ~/.config/videoinfox/tmp/playlist.playlist.delete.tmp

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread0.tmp  # REMOVE PATH UP TO DOT. LEAVING PLAYLIST NAME
                      read -r plselected2 < ~/.config/videoinfox/tmp/plread0.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE $pselecteda                     

                      if [[ "$plselected2" == "Default" ]]
                      then
                      echo "The default playlist list cannot be deleted. It can only be cleared . . ."
                      sleep 2
                      else

                      function menucpl {
                  
                      clear
                      echo
                      echo " Delete Playlist . . ."
                      echo
                      echo " $plselected"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 optioncpl
                      echo
                      }

                      while true
                      do
	                menucpl
	                case $optioncpl in

	                y)  # YES

                      rm "$plselected" 2> /dev/null

                      echo "$plselected"| sed 's/.*\.//' > ~/.config/videoinfox/tmp/plread.tmp  # REMOVE FULL PATH ONLY LEAVING PLAYLIST NAME
                      read -r plselectedla < ~/.config/videoinfox/tmp/plread.tmp  # READING PLAYLIST NAME ONLY INTO VARIABLE  $pselecteda
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay 2> /dev/null  # REMOVE PLAYLIST.last.autoplay  file
                      rm ~/.config/videoinfox/playlists/"$plselectedla".last-autoplay.nextup 2> /dev/null  # REMOVE PLAYLIST.last.autoplay.nextup  file
                      echo
                      echo  " Playlist Deleted . . ."
                      sleep .7

                      if [[ "$setplaylistfull" = "$plselected" ]]  # IF DELETED PLAYLIST = ACTIVE PLAYLIST
                        then # SET DEFAULT PLAYLIST TO ACTIVE PLAYLIST
                            echo "$HOME/.config/videoinfox/playlists/vplaylist.Default" > ~/.config/videoinfox/videoinfo.playlist.current
                            cp ~/.config/videoinfox/playlists/vplaylist.Default ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
                            setplaylist="Default"
                            echo
                            echo " Loaded playlist was deleted. Default playlist loaded . . ."
                            sleep 2
                        else
                            :
                      fi

                      break
                      ;;


                      n)  # NO
                      break;;

                      *)
        
                      esac
                      done
        
            fi
      fi
fi
fi
fi
fi            
;;        
        

    c)
         # CREATE PLAYLIST
echo
echo " Create Empty Playlist"
echo
echo " If any dots are entered, they will be stripped from the playlist name."
echo " Spaces can be used after the first character of the playlist name."
echo
read -r -p " Create Playlist: " createpl1  # waiting fot user input. grabbing new filename

# Strip out any dots from user entry
echo "$createpl1" > ~/.config/videoinfox/tmp/plremovedot.tmp
sed -i -e 's/\.//g' ~/.config/videoinfox/tmp/plremovedot.tmp
read createpl < ~/.config/videoinfox/tmp/plremovedot.tmp
rm ~/.config/videoinfox/tmp/plremovedot.tmp

plname="$HOME/.config/videoinfox/playlists/vplaylist.""$createpl"

if [ -z "$createpl" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4
  else

if [[ "$createpl" = "Default" ]]
  then
      echo
      echo " Default playlist name reserved . . ."
      sleep .4
  else

      if [ -f ~/.config/videoinfox/playlists/vplaylist."$createpl" ]
        then
            
  function ovewritesr {
        clear
        echo
        echo " File already exists . . ."
        echo
        echo " Overwrite playlist "$createpl1"?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  ovewritesr
	  case $optiondelq in

	  y)  # YES
        if [[ "$setplaylist" = "$createpl1" ]]
        then  # PLAYLIST THAT IS BEING OVERWRITTEN IS LOADED
            echo > ~/.config/videoinfox/videoinfo.playlist  # WRITE TO THE LOADED PLAYLIST
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
            echo " Reloading" "$plname . . ."
            echo
            sleep .4
        else  # PLAYLIST THAT IS BEING OVERWRITTEN IS NOT LOADED
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Overwritten: ""$plname"
            echo
            sleep .7
        fi
       
        break
        ;;

        n)  # NO
        break;;

        *)        
        esac
        done  

        else
            echo > "$plname"  #  create user list with full path and filename
            echo > "$HOME"/.config/videoinfox/playlists/"$createpl1".last-autoplay
            echo
            echo " Playlist Created: "$plname""
            echo
            sleep .7

fi
fi
fi
;; 
 


esac
done
;;
#!!!!!!!!!!!!!!!!!!!!!!! END PLAY QUEUE


          p) 
          #  @PLAY CLIPBOARD - <PLAYLIST>        

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdirz="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload  
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
             else
                  read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

           
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
          then
              :
          else     
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST File  
              $defplayer "${defplayargu[@]}" &> /dev/null "$ytdlplast"  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdirz"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi
 
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to PLAYLIST file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      echo " PLAYLIST Closed"
  
        else
            
            echo
            echo
            echo " No playable content in the clipboard . . ."
            sleep .9
      fi   
  fi
  ;;  
               

         d)  # CLEAR PLAYLIST (VIEW PLAYLIST)

        function menucpl {
        
        clear
        echo
        echo
        echo " Clear current playlist: ""$setplaylist""?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optioncpl
        echo
        }

        while true
        do
	  menucpl
	  case $optioncpl in

	  y)  # YES
        rm ~/.config/videoinfox/videoinfo.playlist 2> /dev/null
        echo > ~/.config/videoinfox/videoinfo.playlist
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay
        echo > ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay.nextup
        read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
        cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST 
        echo
        echo " ""$setplaylist"" Playlist Cleared . . ."
        sleep .7  
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


*)

esac
done
;;
#@@@@@@@@@@@@@ END HOME VIEW PLAYLIST


k)
##################################################################################################################################################
###########################   ADD TO PLAYLIST  k   <HOME>  #######################################################################################
##################################################################################################################################################

# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING ONLY PLAYLIST NAME
cat ~/.config/videoinfox/videoinfo.playlist.current | sed 's/.*\.//' > ~/.config/videoinfox/tmp/whatplhome.tmp 
read -r whatplhome < ~/.config/videoinfox/tmp/whatplhome.tmp
rm ~/.config/videoinfox/tmp/whatplhome.tmp


if [ -f ~/.config/videoinfox/videoinfo.playlist ]  # if file exists goto then
  then
      :
  else
      echo > ~/.config/videoinfox/videoinfo.playlist
fi


if [ -f ~/.config/videoinfox/tmp/videoinfo-findwork.tmp ]  # if file exists goto then
  then

      clear
      cat ~/.config/videoinfox/tmp/videoinfo-number-findwork.tmp

      echo
      read -r -p "Add video to playlist $whatplhome: " linenumber  # waiting fot user input     

      # create file moving selected line number to the top
      tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-findwork.tmp > ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp 2>/dev/null

# GETTING NUMBER OF VIDEO FILES FROM FIND RESULTS
linecount=$(wc -l ~/.config/videoinfox/tmp/videoinfo-findwork.tmp | cut -d' ' -f1)

if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then 
      :

  else 

      if [ -z "$linenumber" ] # IF NO ENTRY GOTO THEN
        then
            :

        else

if [ "$linenumber" = 0 ]
  then
      :
  else
            if [[ $linenumber -gt $linecount ]]
              then 
                  echo
                  echo "Number out of range . . ."
                  sleep .4

              else
     
      # read first line of file for play
      read playnumber < ~/.config/videoinfox/tmp/videoinfo-findwork-playnumber.tmp

      if [ -z "$playnumber" ]
        then
            :

        else

     read -r hspa < ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay 
     if [ -z "$hspa" ]
       then  # resume marker is empty
           echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playlist
           read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
           cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
           echo
           echo "$playnumber" 
           echo
           echo "Added to Playlist . . ."           
           sleep .7

       else  # resume marker exists.
           echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playlist
           read -r activeplaylistm < ~/.config/videoinfox/videoinfo.playlist.current # GET CURRENT PLAYLIST
           cp ~/.config/videoinfox/videoinfo.playlist "$activeplaylistm" 2>/dev/null # SAVE CURRENT PLAYLIST
           echo "$playnumber" >> ~/.config/videoinfox/playlists/"$setplaylist".last-autoplay # UPDATE RESUME LIST
           echo
           echo "$playnumber" 
           echo
           echo "Added to Playlist . . ."
           sleep .7

fi
fi
fi
fi
fi
fi

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1

fi
;;


##################################################################################################################################################
    f)  ################  FIND ROUTINE - <HOME>  #################################################################################################
##################################################################################################################################################

    searchtotal2=$(find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)    
                                           	                               
                     if [ "$searchtotal2" = 0 ]  # if find returned no results goto <then>
      
                       then
                           echo
                           echo
                           echo " No video files recursively reachable from the current directory . . ."
                           sleep 1
                        
                       else

    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

    clear
    echo
    echo "Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
    echo "Clipboard: ""$pasteclip"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " ""$ver"" >>> FIND VIDEO"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " Video files must be recursively reachable from the current directory. No file extensions. Wildcard * ok" 
    echo
    read -r -p " Search: " videofind  # waiting fot user input - video file that you want to find

    searchtotal=$(find "$PWD" -type f \( -iname "$videofind.mp4" -o -iname "$videofind.mkv" -o -iname "$videofind.avi" -o -iname "$videofind.webm" -o -iname "$videofind.divx" -o -iname "$videofind.3gp" \) 2>/dev/null | wc -l)    
                                                                                   	
    if [ -z "$videofind" ]  # if no input was entered goto  <then>  
          then
               echo
               echo " Nothing was entered . . ."
               echo
               sleep .4        
          else
                
              if echo "$videofind" | grep "/" > /dev/null  # if any slashehes were entered goto <then>
                then
                    echo
                    echo " No directories only filenames . . ."
                    echo
                    sleep .4 
                else
                                
                     if [ "$searchtotal" = 0 ]  # if find returned no results goto <then>
      
                       then
                           #cp ~/.config/videoinfox/videoinfo.findwork3 ~/.config/videoinfox/videoinfo.findwork
                           #cp ~/.config/videoinfox/videoinfo.lastsearchtotal2  ~/.config/videoinfox/videoinfo.lastsearchtotal
                           echo
                           echo " No files found . . ."
                           echo
                           sleep .4 
                          
                       else
                           echo "$videofind" > ~/.config/videoinfox/videoinfo.lastfindstring   # save last find string used                          
                           read -r fterm < ~/.config/videoinfox/videoinfo.lastfindstring

                           # save find results
find "$PWD" -type f \( -iname "$videofind.mp4" -o -iname "$videofind.mkv" -o -iname "$videofind.avi" -o -iname "$videofind.webm" -o -iname "$videofind.divx" -o -iname "$videofind.3gp" \) | sort -u > ~/.config/videoinfox/videoinfo.findwork
                           echo "$PWD" > ~/.config/videoinfox/videoinfo.lastfinddir  # save last directory that last find was run in 
                           # write last search total file count
                           echo "$searchtotal" > ~/.config/videoinfox/videoinfo.lastsearchtotal
                           # read last search total file count
                           read -r searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal    
                           cp ~/.config/videoinfox/videoinfo.findwork ~/.config/videoinfox/videoinfo.findwork3
                           cp ~/.config/videoinfox/videoinfo.lastsearchtotal ~/.config/videoinfox/videoinfo.lastsearchtotal2                 
                           echo
                           echo " Total files found: " "$searchtotal"  # number of files found
                           "$vnotify" "Videoinfox messsage: Find results in $PWD" "$searchtotal files found using search term: $fterm"
                           sleep .4
    fi
    fi              
    fi
fi
    ;;


##################################################################################################################################################
u)  # SETTINGS - <HOME>  #########################################################################################################################
##################################################################################################################################################

function menusettings {
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
read -r vto < ~/.config/videoinfox/videoinfox.intermission

# LOAD STORED DIRECTORIES
read -r dir1 < ~/.config/videoinfox/videoinfo.tv-dir 2> /dev/null
read -r dir2 < ~/.config/videoinfox/videoinfo.movies-dir 2> /dev/null
read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null
read -r dir4 < ~/.config/videoinfox/videoinfo.parent-dir 2> /dev/null
read -r dir5 < ~/.config/videoinfox/videoinfo.dir-at-exit 2> /dev/null

if [ -f ~/.config/videoinfox/index-last-time ]
      then
          :
      else
          echo "Empty . . ." > ~/.config/videoinfox/index-last-time
    fi

read -r ddlastime < ~/.config/videoinfox/index-last-time

if [[ "$vnotify" = ":" ]]
  then
      vnot="OFF"
  else
      vnot="ON"
fi

clear
echo
echo "Directory:" "$PWD"
echo "Clipboard:" "$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> SETTINGS            Enter - Update Clipboard Display           Intermission:" "$vto" "seconds"
echo "___________________________________________________________________________________________________________________" 
echo
echo " Set Default Directories                                                                     q - Quit"
echo
echo "                                                                                             v - Videoinfox Update"
echo " 1 - TV:" "$dir1"
echo "                                                                                             y - Yt-dlp Update"
echo " 2 - Movies:" "$dir2"
echo "                                                                                             l - Last Search"
echo " 3 - Download:" "$dirsaved"
echo "                                                                                             p - Video Player"
echo " 4 - Extra:" "$dir4"
echo "                                                                                             t - Intermission"
echo " z - Index Default Directories   Last run: ""$ddlastime"
echo "                                                                                             n - GUI Notify: $vnot"
echo   
echo "                                                                                             h - Version History"
echo " Last Exit Dir 5:" "$dir5"
echo "                                                                                             c - Code Stats"
echo
echo -en " Enter Option: "
read -r -n1 optionsettings
}

while true
do
menusettings
case $optionsettings in

    q)  # QUIT
    break;;

    n) # NOTIFICATION
    function guinotify {
    clear
    echo
    echo " GUI Notifications?"
    echo
    echo " y - Yes     n - No"  
    echo 
    echo -en " Enter Option: "
    read -r -n1 option
    echo
    }

    while true
    do
    guinotify
    case $option in

    y)  # YES
    echo "notify-send" > ~/.config/videoinfox/vnotify  # Set notification on
    read -r vnotify < ~/.config/videoinfox/vnotify
    echo
    echo " GUI Noifications ON . . ." 
    sleep 1.3
    break;; 
        
    n)  # NO
    echo ":" > ~/.config/videoinfox/vnotify  # Set notification off
    read -r vnotify < ~/.config/videoinfox/vnotify
    echo
    echo " GUI Noifications OFF . . ."
    echo
    echo " Note: GUI Notifications are always on for  videoinfox -a  and  videoinfox -l  keyboard shortcuts."
    echo
    read -r -p " Press enter to continue . . ." 
    #sleep 2.5
    break;; 
  
    *)                   
    esac
    done
    ;;


    z) # WRITE DEFAULT DIRECTORIES TO PLAYLIST
    grabdir="$PWD"
    
    echo
    echo
    echo " Building Index of Default Directories 1-4 . . ."
    sleep 1.9

    if [ -f ~/.config/videoinfox/playlists/v-index.Default-Directories ]
      then
          rm ~/.config/videoinfox/playlists/v-index.Default-Directories
      else
          :
    fi

    if [ -z "$dir1" ]
      then 
          :
      else 
          cd "$dir1"
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | sort -u > ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp"
    fi

    if [ -z "$dir2" ]
      then 
          :
      else 
          cd "$dir2"
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | sort -u >> ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp"
    fi

    if [ -z "$dirsaved" ]
      then 
          :
      else 
          cd "$dirsaved"
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | sort -u >> ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp"
    fi

    if [ -z "$dir4" ]
      then 
          :
      else 
          cd "$dir4"
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | sort -u >> ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp"
    fi


    if [ -f ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp" ]
      then
          cp ~/.config/videoinfox/tmp/"vplaylist.Default Directories.tmp" ~/.config/videoinfox/playlists/v-index.Default-Directories
          date -r ~/.config/videoinfox/playlists/v-index.Default-Directories > ~/.config/videoinfox/index-last-time
          echo
          echo " Done . . ."
          sleep .5
      else
          echo
          echo " There are no default directories set. Set at least one default directory first . . ."
          sleep 3  
    fi

cd "$grabdir"

    ;;



    t) # Intermission
    read -r vto < ~/.config/videoinfox/videoinfox.intermission
    clear
    echo
    echo " Current Intermission:" "$vto"
    echo
    echo " Intermission range is 1 to 86400 seconds (24 hours)"
    echo
    read -r -p " Enter intermission time in seconds: " timeinsec  # waiting fot user input

    re='^[0-9]+$'
    if ! [[ "$timeinsec" =~ $re ]]
    then
    :
    
    else
        if [[ "$timeinsec" < 1 ]]
          then
              echo
              echo " Entry cannot be less than 1 . . ."
              sleep 1
          else

         if [[ "$timeinsec" -gt 86400 ]]
           then
               echo
               echo " Entry cannot be greater than 86400 . . ."
               sleep 1
           else
              echo "$timeinsec" > ~/.config/videoinfox/videoinfox.intermission
              read -r vto < ~/.config/videoinfox/videoinfox.intermission
              echo
              echo " Intermission changed to:" "$timeinsec" "seconds"    
              sleep 1
    fi
    fi
    fi
    ;;
    

    x) #  CLEAR CLIPBOARD
    echo "" | xclip -sel clip  # clearing out the clipboard
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    ;;


    p) # VIDEO PLAYER
    function videoplayer {

    # Set if mpv will save play position on quit
    read -r mpvsavestat < ~/.config/videoinfox/mpvmarker
    if [[ "$mpvsavestat" = 1 ]]
      then
          mpvmarker="--save-position-on-quit"
      else
          mpvmarker=" "
    fi

         read -r vplay < ~/.config/videoinfox/videoinfox.video-player
         read -r cplayer1 < ~/.config/videoinfox/videoinfox.customplayer.1 
         read -r cplayer2 < ~/.config/videoinfox/videoinfox.customplayer.2
         clear
         echo
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " "$der"  >>> SETTINGS >>> VIDEO PLAYER                                              Current Setting: "$vplay" "
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " Choose video player                                                                                      q - Quit"
         echo
         echo " 1 - ffplay -fs -autoexit -loglevel quiet"  
         echo
         echo " 2 - mpv --fs --no-terminal --sid=no $mpvmarker"
         echo
         echo " 3 - custom:" "$cplayer1" "$cplayer2"
         echo
         echo -en " Enter Option: "
         read -r -n1 optionvp
         echo
         }
        
              
         while true
         do
         videoplayer
	    case $optionvp in

         q)
         break;;
  
         1)
         echo "1" > ~/.config/videoinfox/videoinfox.video-player
         echo
         echo " ffplay set . . ."
         sleep .7
         ;;


         2)         
         if ! command -v mpv &> /dev/null ####### Check for mpv and set if installed ########
           then
               echo
               echo " mpv not found . . ."
               sleep .7
           else

function menumpvsave {
                      clear
                      echo
                      echo " Use MPV option --save-position-on-quit?"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 option
                      echo
                      }

                      while true
                      do
	                menumpvsave
	                case $option in

                      y)  # YES
                      echo "1" > ~/.config/videoinfox/mpvmarker
                      echo
                      echo " Mpv will save play/pause postion on quit . . ."
                      #echo 
                      sleep 1.5
                      break;; 
        
                      n)  # NO
                      echo > ~/.config/videoinfox/mpvmarker 
                      echo
                      echo " Mpv won't save play/pause postion on quit . . ."
                      echo
                      echo " Note: Now if a video is played that has a marker, it will be started from the marker"
                      echo "       and the marker will be cleared on mpv quit(q)"
                      echo
                      echo   
                      read -r -p " Press enter to continue . . ."
                      break;;
      
                *)
                                
                esac
                done     

               echo "2" > ~/.config/videoinfox/videoinfox.video-player
               echo
               echo " mpv set . . . "
               sleep .7

function menumpvclear {
                      clear
                      echo
                      echo " Clear All Mpv Markers?"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 option
                      echo
                      }

                      while true
                      do
	                menumpvclear
	                case $option in

                      y)  # YES
                      rm /home/homeserver/.config/mpv/watch_later/* 2> /dev/null
                      echo
                      echo " All mpv markers cleared . . ."
                      sleep .9
                      break;; 
        
                      n)  # NO
                      echo
                      echo " All mpv markers kept . . ."
                      sleep .9
                      break;;
      
                *)
                                
                esac
                done     


         fi

        ;;

        
        3)
        function menusvp {
         
        clear
        clear
        echo
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " "$der"  >>> SETTINGS >>> VIDEO PLAYER >>> CUSTOM"
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " Custom:" "$cplayer1" "$cplayer2"
        echo
        echo " e - Edit                                                                                                 q - Quit"
        echo " s - Set"
        echo " c - Clear"
        echo
        echo -en " Enter Option: "
        read -r -n1 optionsvp
        echo
        }

        while true
        do
	  menusvp
	  case $optionsvp in

        c) #CLEAR
           echo > ~/.config/videoinfox/videoinfox.customplayer.1
           echo > ~/.config/videoinfox/videoinfox.customplayer.2
           read -r cplayer1 < ~/.config/videoinfox/videoinfox.customplayer.1 
           read -r cplayer2 < ~/.config/videoinfox/videoinfox.customplayer.2
           echo
           echo " Custom cleared . . ."
           sleep .7

           if [[ "$vplay" = "3" ]]
           then
           if ! command -v mpv &> /dev/null ####### Check for mpv and set if found ########
           then
           echo "1" > ~/.config/videoinfox/videoinfox.video-player # SET FFPLAY
           echo
           echo " ffplay set . . ."
           sleep .7
           else
           echo "2" > ~/.config/videoinfox/videoinfox.video-player # SET MPV
           echo "1" > ~/.config/videoinfox/mpvmarker # MPV OPTION  --save-position-on-quit  ACTIVE
           echo
           echo " mpv set . . ."
           sleep .7
           fi
           read -r vplay < ~/.config/videoinfox/videoinfox.video-player

           else
           :
           fi
           ;;


        s) #SET
          if [ -f ~/.config/videoinfox/videoinfox.customplayer.1 ]
            then
                :
            else
                echo > ~/.config/videoinfox/videoinfox.customplayer.1
          fi
             
          read -r chkforempty < ~/.config/videoinfox/videoinfox.customplayer.1
          if [ -z "$chkforempty" ]
            then
                echo
                echo " Custom is empty . . ."
                sleep .7
            else
                echo "3" > ~/.config/videoinfox/videoinfox.video-player
                echo
                echo " Custom set . . ."
                sleep .7
                break
            fi
          ;;


        e) #EDIT
          echo
          echo " Stored executable: " "$cplayer1"
          echo " Stored parameters: " "$cplayer2"
          echo
          read -r -p " Enter video player executable (enter only to keep stored): " customvpe
          echo

          if [ -z "$customvpe" ]
            then
                :
            else
                if ! command -v "$customvpe" &> /dev/null ####### Check for custom and set if installed ########
                  then
                      echo " ""$customvpe" "not found . . ."               
                      sleep .7
                  else
                      echo "$customvpe" > ~/.config/videoinfox/videoinfox.customplayer.1
                      echo "3" > ~/.config/videoinfox/videoinfox.video-player
                      read -r -p " Enter video player parameters (enter only to erase stored): " customvpp
                      echo "$customvpp" > ~/.config/videoinfox/videoinfox.customplayer.2
                      read -r cplayer1 < ~/.config/videoinfox/videoinfox.customplayer.1 
                      read -r cplayer2 < ~/.config/videoinfox/videoinfox.customplayer.2 
                      echo
                      echo " New executable: " "$cplayer1"
                      echo " New parameters: " "$cplayer2"
                      echo
                      echo " Custom set . . ."
                      sleep .7
          fi
          fi
          break
          ;;

          q) quit
          break;;

          *)        
        esac
        done
        ;;

        
   *)
   esac
   done
   ;;

    
    c)  # CODE STATS

function codestats {

clear
echo
echo #"Directory:" "$PWD"
echo #"Clipboard:" "$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> SETTINGS >>> CODE STATS                                                           q - Quit"
echo "___________________________________________________________________________________________________________________" 
echo
echo

a=$(grep -c "^$" /usr/local/bin/videoinfox 2> /dev/null)  # NUMBER OF BLANK LINES
b=$(sed -n -e '/#/p' /usr/local/bin/videoinfox | wc -l 2> /dev/null)  # NUMBER OF COMMENT ONLY LINES
c=$(sed -n '$=' /usr/local/bin/videoinfox 2> /dev/null)  # TOTAL LINES

d=$((c - a - b))  # CODE LINES = TOTAL LINES - BLANK LINES - COMMENT ONLY LINES


# GET VIDEOINFOX FILE SIZE AND LOCATION AND WRITE TO FILE:  ~/.config/videoinfox/videoinfox.code-stats.tmp
du -h /usr/local/bin/videoinfox > ~/.config/videoinfox/videoinfox.code-stats.tmp 2> /dev/null

# READ FILE SIZE
vsize=$(sed 's:/.*::' ~/.config/videoinfox/videoinfox.code-stats.tmp)

# READ FILE LOCATION
vlocat=$(cat ~/.config/videoinfox/videoinfox.code-stats.tmp | cut -c 7-)


printf " Code Lines .......  %s\n" "$d"

echo
printf " Comment Lines ....   %s\n" "$b"

echo
printf " Blank Lines ......   %s\n" "$a"

echo " _________________________"

echo
printf " Total Lines ......  %s\n" "$c"
echo
echo
echo " File Size:" "$vsize"
echo
echo " File Location:" "$vlocat"
#echo " White Spaces ....." $(wc -w < /usr/local/bin/videoinfox 2> /dev/null)  # White Space COUNT
echo
echo
echo -en " Enter Option: "
read -r -n1 optionstats
}


while true
do
codestats
case $optionstats in

    q)  # QUIT
    break;;

*)

esac
done
;;

    
    h)  # VERSION HISTORY
    clear
    less ~/.config/videoinfox/videoinfo-ver-history
    ;;


    l)  # LAST SEARCH    
     function lastsearch {
         read -r lsearch < ~/.config/videoinfox/videoinfo.lastsearch-set
         clear
         echo
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " "$der"  >>> SETTINGS >>> LAST SEARCH                                               Current Setting: "$lsearch" "
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " If there are search results on the the home screen on exit, the below always applies to the next run."
         echo
         echo
         echo " 1 - Always Save                                                                                          q - Quit"  
         echo
         echo " 2 - Never Save"
         echo
         echo " 3 - Ask on Exit"
         echo
         echo
         echo -en " Enter Option: "
         read -r -n1 optionz
         echo
         }
        
              
         while true
         do
         lastsearch
	    case $optionz in

         q)
         break;;
  
         1)
         
         echo "1" > ~/.config/videoinfox/videoinfo.lastsearch-set
         echo
         echo " Always Save . . ."
         sleep .7
         ;;


         2)
         echo "2" > ~/.config/videoinfox/videoinfo.lastsearch-set
         echo
         echo " Never Save . . . "
         sleep .7
         ;;

        
         3)
         echo "3" > ~/.config/videoinfox/videoinfo.lastsearch-set
         echo
         echo " Ask on Exit . . ."
         sleep .7
         ;;

         *)

         esac
         done

         ;;


    1)
    # SET TV DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    read -r dir1 < ~/.config/videoinfox/videoinfo.tv-dir

    clear
    echo
    echo "Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
    echo "Clipboard: ""$pasteclip"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET TV DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " - Enter with no entry to exit     - To clear directory type: clear"
    echo
    echo
    echo " Currently Set: ""$dir1"
    echo
    echo  
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory or paste from clipboard: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else

if [[ "$specifydir2" = "clear" ]]
  then
      echo > ~/.config/videoinfox/videoinfo.tv-dir
      echo
      echo " Directory cleared . . ."
      sleep .7
  else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.tv-dir
                      read -r dir1 < ~/.config/videoinfox/videoinfo.tv-dir
                      echo " TV Directory Set to:" "$dir1"                  
                      else
                      echo
                      echo " error: Directory doesn't exist"                    
                fi
          fi       
fi           
          cd "$grabdir"  # restore working directory
          sleep .7
          ;;


    2)
    # SET MOVIES DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    read -r dir2 < ~/.config/videoinfox/videoinfo.movies-dir 
    clear
    echo
    echo "Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
    echo "Clipboard: ""$pasteclip"
    echo "___________________________________________________________________________________________________________________"
    echo 
    echo " ""$ver"" >>> SET MOVIE DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " - Enter with no entry to exit     - To clear directory type: clear"
    echo
    echo
    echo " Currently Set: ""$dir2"
    echo
    echo  
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory or paste from clipboard: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else

if [[ "$specifydir2" = "clear" ]]
  then
      echo > ~/.config/videoinfox/videoinfo.movies-dir
      echo
      echo " Directory cleared . . ."
      sleep .7
  else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.movies-dir
                      read -r dir2 < ~/.config/videoinfox/videoinfo.movies-dir
                      echo " Movie Directory Set to:" "$dir2"                  
                      else
                      echo
                      echo " error: Directory doesn't exist"                    
                fi
          fi
fi 
          cd "$grabdir"  # restore working directory
          sleep .7
          ;;
           

    3)
    # SET <yt-dlp> DOWNLOAD DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir
    clear
    echo
    echo "Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
    echo "Clipboard: ""$pasteclip"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET YT-DLP DOWNLOAD DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " - Enter with no entry to exit. This directory can't be cleared. It can only be changed."
    echo
    echo
    echo " Currently Set: ""$dirsaved"
    echo
    echo  
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory or paste from clipboard: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else

                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.yt-download-dir
                      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir
                      echo " Download Directory Set to:" "$dirsaved"                  
                      else
                      echo
                      echo " error: Directory doesn't exist"                   
                fi
          fi       
    
          cd "$grabdir"  # restore working directory
          sleep .7
          ;;


 4)
    # SET PARENT DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    read -r dir4 < ~/.config/videoinfox/videoinfo.parent-dir
    clear
    echo
    echo "Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
    echo "Clipboard: ""$pasteclip"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET EXTRA DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " - Enter with no entry to exit     - To clear directory type: clear"
    echo
    echo
    echo " Currently Set: ""$dir4"
    echo
    echo  
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory or paste from clipboard: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else

if [[ "$specifydir2" = "clear" ]]
  then
      echo > ~/.config/videoinfox/videoinfo.parent-dir
      echo
      echo " Directory cleared . . ."
      sleep .7
  else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.parent-dir
                      read -r dir4 < ~/.config/videoinfox/videoinfo.parent-dir
                      echo " Extra Directory Set to:" "$dir4"                  
                      else
                      echo
                      echo " error: Directory doesn't exist"                    
                fi
          fi       
fi          
          cd "$grabdir"  # restore working directory
          sleep .7
          ;;


#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    
    v)  # CHECK FOR VIDEOINFOX UPDATE
    function menuinfox {

    dirtemp="$PWD"  # save dir for restore
    cd ~/.config/videoinfox/tmp

    wget https://raw.githubusercontent.com/powerhousepro69/videoinfox/main/videoinfox 2>/dev/null
    chmod +x ~/.config/videoinfox/tmp/videoinfox 2>/dev/null


    if [ -f ~/.config/videoinfox/tmp/videoinfox ]  # if file exists goto then
       then
            gver=$(~/.config/videoinfox/tmp/videoinfox -v)

       else
            gver="Download Failure"
    fi
  

    clear     
    clear 
    echo
    echo
    echo
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " ""$der"" >>> CHECK VIDEOINFOX UPDATE"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " videoinfox Home: https://github.com/powerhousepro69/videoinfox"
    echo 
    echo " Downloaded From: https://raw.githubusercontent.com/powerhousepro69/videoinfox/main/videoinfox"
    echo
    echo
    echo " Version Check Complete"
    echo
    echo " Downloaded: ""$gver"
    echo
    echo " Installed: " "$ver" 
    echo
    echo
    echo " u - Update     d - Don't Update"  
    echo
    echo -en " Enter Option: "
    read -r -n1 optioninfox
    echo
    }
        
              
         while true
         do
         menuinfox
	   case $optioninfox in


         d)
         #  QUIT
         cd "$dirtemp" # restore directory
         #rm ~/.config/videoinfox/tmp/* 2> /dev/null
         echo
         echo " Not Updated . . ."
         sleep 1
         break;;
      
         u)
         # UPDATE VIDEOINFOX
     
         if [ -f ~/.config/videoinfox/tmp/videoinfox ]  # if file exists goto then
            then
                 echo
                 sudo mv ~/.config/videoinfox/tmp/videoinfox /usr/local/bin/videoinfox 2> /dev/null
                 #rm ~/.config/videoinfox/tmp/* 2> /dev/null
                 echo
                 echo " Downloaded videoinfox copied to: /usr/local/bin"
                 echo   
    
                 sec=3
                 while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
                      echo -ne " UPDATED . . . $sec\033[0K\r"
                      let " sec=sec-1"
                      sleep 1
                 done         


                 clear
                 echo -e "\n"
                 echo
                 echo "___________________________________________________________________________________________________________________"  
                 echo
                 echo " $der >>> EXIT"
                 echo "___________________________________________________________________________________________________________________" 
                 echo
                 echo
                 echo " Videoinfox Updated . . ."
                 sleep 1.9
       
  
                 clear
                 echo -e "\n"
                 echo
                 echo "___________________________________________________________________________________________________________________"
                 echo  
                 echo " $der >>> Updated to "$gver"                              Restart to use updated version."
                 echo "___________________________________________________________________________________________________________________" 
                 echo -e "\n"
                
                 cd "$dirtemp"  # restore directory
                 exit
                
            else 
                 :

         fi
         ;;

          
         esac
         done
cd "$dirtemp"
         ;;


#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        
         y)  # CHECK FOR YT-DLP UPDATE

dirtemp="$PWD"  # save dir for restore after yt-dlp download      

# Yt-dlp download attempt.
clear
echo
echo 
echo 
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> Attempting to download the most recent version of Yt-dlp . . ."
echo "___________________________________________________________________________________________________________________" 
echo
echo " If Yt-dlp can't be downloaded, the download attempt will be aborted."
echo
echo " If the download fails, it is most likely due to at least 1 of the following reasons:"
echo
echo "    - Your internet connection is down."
echo
echo "    - Github isn't reachable due to technical issues on their end."
echo
echo "    - There is no Yt-dlp release available in:  https://github.com/yt-dlp/yt-dlp/releases/latest/download"
echo
echo
echo " If this download fails, the download attempt will be tried again when you select the Yt-dlp Menu in Videoinfox."
echo
echo
echo " Note: The Yt-dlp Menu will not work until there is a copy of yt-dlp in:"
echo
echo " "$HOME"/.config/videoinfox"
echo
echo

cd ~/.config/videoinfox/tmp
 
wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp 2>/dev/null  # download yt-dlp 
 

if [ -f ~/.config/videoinfox/tmp/yt-dlp ]  # if yt-dlp exists goto then
   then
        chmod a+rx ~/.config/videoinfox/tmp/yt-dlp  # set <yt-dlp-fetched> execute bit  


        sec=5
             
         while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
              echo -ne " Yt-dlp Downloaded . . . $sec\033[0K\r"
              let " sec=sec-1"
              sleep 1
         done

    
   
function chkytdlp {

        

         if [ -f ~/.config/videoinfox/tmp/yt-dlp ]
            then
                 ytexist=$(~/.config/videoinfox/yt-dlp --version)
            else
                 ytexist="Not installed"
         fi

         clear 
         echo
         echo
         echo
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " ""$der"" >>> CHECK YT-DLP UPDATE"
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " Yt-dlp Home: https://github.com/yt-dlp/yt-dlp"
         echo
         echo " Downloaded From: https://github.com/yt-dlp/yt-dlp/releases/latest/download"
         echo
         echo
         echo " Version Check Complete"
         echo
         echo " Downloaded:" $(~/.config/videoinfox/tmp/yt-dlp --version)
         echo
         echo " Installed: " "$ytexist"
         echo
         echo
         echo " u - Update     d - Don't Update"  
         echo
         echo -en " Enter Option: "
         read -r -n1 optionytdlp
         echo         
}        
              
         while true
         do
         chkytdlp
	   case $optionytdlp in


         d)
         #  DON'T UPDATE
         #rm ~/.config/videoinfox/tmp/* 2>/dev/null
         cd "$dirtemp"  # restore directory
         echo
         echo " Yt-dlp Not Updated . . ."
         sleep 1
         break;;
      
         u)
         # UPDATE
         rm ~/.config/videoinfox/yt-dlp 2> /dev/null
         mv ~/.config/videoinfox/tmp/yt-dlp ~/.config/videoinfox 2> /dev/null       
         ~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version
         #rm ~/.config/videoinfox/tmp/* 2>/dev/null
         cd "$dirtemp"  # restore directory
         echo
                 
         sec=3
              while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
              echo -ne " Yt-dlp UPDATED . . . $sec\033[0K\r"
              let " sec=sec-1"
              sleep 1
              done         
              break;;
   
         esac
         done


   else
         #rm ~/.config/videoinfox/tmp/* 2>/dev/null     
         cd "$dirtemp"  # restore directory
         sec=20           
         while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>                       
              echo -ne " Yt-dlp Download Failure . . . $sec\033[0K\r"
              let "sec=sec-1"
              sleep 1
         done     
fi
;;         
          

esac
done

#rm ~/.config/videoinfox/tmp/* 2>/dev/null
;;

   

##################################################################################################################################################
###########################  HOME OPTION  y  Yt-dlp Menu  ########################################################################################
##################################################################################################################################################

y)       

grabdir="$PWD"  # grab working directory
pasteclip3=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content to restore to before this function was run


if ! command -v ~/.config/videoinfox/yt-dlp &> /dev/null  # if <yt-dlp> isnt found goto then

then

# Yt-dlp download attempt.  Yt-dlp Menu won't start untl Yt-dlp is downloaded to: ~/.config/videoinfox/yt-dlp
clear
echo
echo 
echo 
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> Attempting to download the most recent version of Yt-dlp . . ."
echo "___________________________________________________________________________________________________________________" 
echo
echo " If Yt-dlp can't be downloaded, the download attempt will be aborted."
echo
echo " If the download fails, it is most likely due to at least 1 of the following reasons:"
echo
echo "    - Your internet connection is down."
echo
echo "    - Github isn't reachable due to technical issues on their end."
echo
echo "    - There is no Yt-dlp release available in:  https://github.com/yt-dlp/yt-dlp/releases/latest/download"
echo
echo
echo " If this download fails, the download attempt will be tried again when you select the Yt-dlp Menu in Videoinfox."
echo
echo
echo " Note: The Yt-dlp Menu will not work until there is a copy of yt-dlp in:"
echo
echo " "$HOME"/.config/videoinfox"
echo
echo

dirtemp="$PWD"  # save dir for restore after ty-dlp download
cd ~/.config/videoinfox

wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp 2>/dev/null  # download yt-dlp 
 
if [ -f ~/.config/videoinfox/yt-dlp ]  # if yt-dlp exists goto then
   then
        chmod a+rx ~/.config/videoinfox/yt-dlp  # set <yt-dlp-fetched> execute bit
        ~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version # write yt-dlp ver number to file: yt-dlp.version 
        

        echo
        echo " Yt-dlp Downloaded . . ."
        echo
        # SAMPLE VIDEO URL BEING COPIED TO CLIPBOARD
        echo "https://www.youtube.com/watch?v=rNWPqfCJDnc" | xclip -sel clip 

        sec=5           
        while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>                       
             echo -ne " $ver starting in: $sec\033[0K\r"
             let "sec=sec-1"
             sleep 1
        done

        cd "$dirtemp"  # restore directory
        rm ~/.config/videoinfox/wget-* 2> /dev/null  


   else
       
        echo
        echo " Yt-dlp Download Failure . . ."
        echo

        sec=20           
        while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>                       
             echo -ne " $ver starting in: $sec\033[0K\r"
             let "sec=sec-1"
             sleep 1
        done     

        cd "$dirtemp"  # restore directory
        rm ~/.config/videoinfox/wget-* 2> /dev/null
fi


############################

else  # IF YT-DLP IS FOUND    >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

###########################

read -r ytdlpver < ~/.config/videoinfox/videoinfo.yt-dlp.version

function menuy {

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi


read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir
#######################  cd "$dirsaved" 

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

clear
echo

##################################################################################################################################################
#=================================================================================================================================================
#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY
#=================================================================================================================================================
##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                      dash0=$(echo "-") # not blinking

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " ""$der"" >>> YT-DLP MENU         Enter - Update Clipboard Display         yt-dlp Version: $ytdlpver"        
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " r - Download Only       g - Download List     l - Last Download      p - Play Clipboard                  q - Quit"
                      echo " c - Download Choose                           v - View Downloads     x - Clrclp                          u - Set"
                      echo " s - Self Destruct"
                      echo
                  
                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content


                  else 
                      
                      dash1=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")                     
                      echo "Clipboard:" "$pasteclip"
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " ""$der"" >>> YT-DLP MENU         Enter - Update Clipboard Display         yt-dlp Version: $ytdlpver"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " r - Download Only       g - Download List     l - Last Download      p * Play Clipboard                  q - Quit"
                      echo " c - Download Choose                           v - View Downloads     x - Clrclp                          u - Set"
                      echo " s - Self Destruct"
                      echo                                                                                  
            fi
  else

      if [ -f "$pasteclip" ]  # Valid file in the clipboard
        then
            echo "Clipboard:" "$pasteclip"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " ""$der"" >>> YT-DLP MENU         Enter - Update Clipboard Display         yt-dlp Version: $ytdlpver"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " r - Download Only       g - Download List     l - Last Download      p * Play Clipboard                  q - Quit"
            echo " c - Download Choose                           v - View Downloads     x - Clrclp                          u - Set"
            echo " s - Self Destruct"                                                                        
            echo                                                                      

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

            echo "___________________________________________________________________________________________________________________"
            echo
            echo " ""$der"" >>> YT-DLP MENU         Enter - Update Clipboard Display         yt-dlp Version: $ytdlpver"        
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " r - Download Only       g - Download List     l - Last Download      p - Play Clipboard                  q - Quit"
            echo " c - Download Choose                           v - View Downloads     x - Clrclp                          u - Set"
            echo " s - Self Destruct"
            echo
fi
fi

echo -en " Enter Option: "                             
read -r -n1 optiony

}


     while true
     do
     menuy
     case $optiony in


     q)  # QUIT
     clear
     break;;

      
     u)  # SET
     
        function dwnlderop {

        read -r dlargue 2>/dev/null < ~/.config/videoinfox/dlargue         
        clear
        clear
        echo
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " "$der"  YT-DLP MENU >>> SETTINGS"
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " Set or clear custom yt-dlp option(s). Applies to: -Download Only -Self Destruct -Download List -Play Clipboard"
        echo
        echo " yt-dlp" "$dlargue"
        echo
        echo " s - Set                                                                                                  q - Quit"
        echo " c - Clear"
        echo
        echo -en " Enter Option: "
        read -r -n1 option
        echo
        }

        while true
        do
	  dwnlderop
	  case $option in

        c) #CLEAR
           unset dlargue
           rm ~/.config/videoinfox/dlargue 2>/dev/null
           echo
           echo " Custom options cleared . . ."
           sleep .7
           ;;

        s) #SET
          echo
          read -r -p " Enter yt-dlp option(s): " dlcustom
          echo

          if [ -z "$dlcustom" ]
            then
                :
            else
                echo "$dlcustom" > ~/.config/videoinfox/dlargue
                read -r dlargue 2>/dev/null < ~/.config/videoinfox/dlargue
                echo " Custom options set . . ."
                sleep .7
          fi
          ;;

          q) # quit
          break;;
          
          *)        
          esac
          done
          ;;


     x)  # CLEAR CLIPBOARD  (DOWNLOAD LIST)
     echo "" | xclip -sel clip  # clearing out the clipboard
     pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     ;;


     g)  # DOWNLOAD LIST  <YT-DLP MENU>

grabclip=$(xclip -o -selection clipboard 2> /dev/null) # grab clipboard content

function dwnlist {

##################################################################################
##########  START   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################## 

# DIRECTORY SELECTED IS NORMAL TEXT AND THE OTHER 4 ARE LESS BOLD. 

# DEFAULT DIR NUMBER 1 FORMAT
dirdisplay1=$(echo -e "1\033[2m 2 3 4 5\033[0m")
# DEFAULT DIR NUMBER 2 FORMAT
dirdisplay2=$(echo -e "\033[2m1 \033[0m2 \033[2m3 4 5\033[0m") 
# DEFAULT DIR NUMBER 3 FORMAT
dirdisplay3=$(echo -e "\033[2m1 2 \033[0m3 \033[2m4 5\033[0m")
# DEFAULT DIR NUMBER 4 FORMAT
dirdisplay4=$(echo -e "\033[2m1 2 3 \033[0m4 \033[2m5\033[0m")
# DEFAULT DIR NUMBER 5 FORMAT
dirdisplay5=$(echo -e "\033[2m1 2 3 4 \033[0m5\033[0m")
# NO MATCH ALL LESS BOLD
dirdisplayno=$(echo -e "\033[2m1 2 3 4 5\033[0m")


# FORMAT PWD NAME FOR COMPARISON
echo "$PWD" > ~/.config/videoinfox/videoinfox.pwd.tmp  # write PWD to a tmp file: videoinfox.pwd.tmp
cat ~/.config/videoinfox/videoinfox.pwd.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.pwd  # remove all froward slashes / write file: videoinfox.pwd
rm  ~/.config/videoinfox/videoinfox.pwd.tmp  # remove tmp file: videoinfox.pwd.tmp
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.pwd  # remove horizontal whitespace write file: videoinfox.pwd

# FORMAT DEFAULT DIR 1 NAME FOR COMPARISON
echo "$dir1" > ~/.config/videoinfox/videoinfox.dir1.tmp  # write dir 1 to a tmp file: videoinfox.dir1.tmp
cat ~/.config/videoinfox/videoinfox.dir1.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir1  # remove all froward slashes / write file: videoinfox.dir1
rm ~/.config/videoinfox/videoinfox.dir1.tmp  # remove tmp file: videoinfox.dir1.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir1  # remove horizontal whitespace write file: videoinfox.dir1

# FORMAT DEFAULT DIR 2 NAME FOR COMPARISON
echo "$dir2" > ~/.config/videoinfox/videoinfox.dir2.tmp  # write dir 2 to a tmp file: videoinfox.dir2.tmp
cat ~/.config/videoinfox/videoinfox.dir2.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir2  # remove all froward slashes / write file: videoinfox.dir2
rm ~/.config/videoinfox/videoinfox.dir2.tmp   # remove tmp file: videoinfox.dir2.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir2 # remove horizontal whitespace write file: videoinfox.dir2

# FORMAT DEFAULT DIR 3 NAME FOR COMPARISON
echo "$dirsaved" > ~/.config/videoinfox/videoinfox.dir3.tmp  # write dir 3 to a tmp file: videoinfox.dir3.tmp
cat ~/.config/videoinfox/videoinfox.dir3.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir3  # remove all froward slashes / write file: videoinfox.dir3
rm ~/.config/videoinfox/videoinfox.dir3.tmp   # remove tmp file: videoinfox.dir3.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir3 # remove horizontal whitespace write file: videoinfox.dir3

# FORMAT DEFAULT DIR 4 NAME FOR COMPARISON
echo "$dir4" > ~/.config/videoinfox/videoinfox.dir4.tmp  # write dir 4 to a tmp file: videoinfox.dir4.tmp
cat ~/.config/videoinfox/videoinfox.dir4.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir4  # remove all froward slashes / write file: videoinfox.dir4
rm ~/.config/videoinfox/videoinfox.dir4.tmp   # remove tmp file: videoinfox.dir4.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir4 # remove horizontal whitespace write file: videoinfox.dir4

# FORMAT DEFAULT DIR 5 NAME FOR COMPARISON
echo "$dir5" > ~/.config/videoinfox/videoinfox.dir5.tmp  # write dir 5 to a tmp file: videoinfox.dir5.tmp
cat ~/.config/videoinfox/videoinfox.dir5.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir5  # remove all froward slashes / write file: videoinfox.dir5
rm ~/.config/videoinfox/videoinfox.dir5.tmp   # remove tmp file: videoinfox.dir5.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir5 # remove horizontal whitespace write file: videoinfox.dir5


# LOAD EDITED PWD AND DEFAULT DIRECTORY NAMES FOR BELOW  IF LOOPS   (all frorward slashes / and white spaces removed from the below directory names)

read -r controldir < ~/.config/videoinfox/videoinfox.pwd    # load reformatted current directory name 
read -r dir1display < ~/.config/videoinfox/videoinfox.dir1  # load reformatted default directory 1 name
read -r dir2display < ~/.config/videoinfox/videoinfox.dir2  # load reformatted default directory 2 name
read -r dir3display < ~/.config/videoinfox/videoinfox.dir3  # load reformatted default directory 3 name
read -r dir4display < ~/.config/videoinfox/videoinfox.dir4  # load reformatted default directory 4 name
read -r dir5display < ~/.config/videoinfox/videoinfox.dir5  # load reformatted default directory 5 name


# DEFAULT DIR 5  DISPLAY     IF DIRECTORY ON EXIT  =  DEFAULT DIRECTORIES 1-4 then Display that directory number.

if [[ "$controldir" = "$dir5display" ]]
  then 

      if [[ "$dir5display" = "$dir1display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 1 then display 1 and not 5
        then
             dirdisp="$dirdisplay1"
      fi

      if [[ "$dir5display" = "$dir2display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 2 then display 2 and not 5
        then
             dirdisp="$dirdisplay2"
      fi

      if [[ "$dir5display" = "$dir3display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 3 then display 3 and not 5
        then
             dirdisp="$dirdisplay3"
      fi

      if [[ "$dir5display" = "$dir4display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 4 then display 4 and not 5
        then
             dirdisp="$dirdisplay4"
      fi
fi



# DEFAULT DIR 5 DISPLAY
if [[ "$controldir" = "$dir5display" ]] 
  then
       dirdisp="$dirdisplay5"  # if directory is changed to  Default Dir 5 :  The number 5 is normal text and the other 4 are less bold.
        
  else
       dirdisp="$dirdisplayno" # if directory doesn't match  Default Dirs 1-5 : All 5 numbers are less bold.  
fi 



# DEFAULT DIR 1  DISPLAY
if [[ "$controldir" = "$dir1display" ]]  # IF PWD = DEFAULT DIR 1 then display 1
  then 
       dirdisp="$dirdisplay1"
fi

# DEFAULT DIR 2  DISPLAY
if [[ "$controldir" = "$dir2display" ]]  # IF PWD = DEFAULT DIR 2 then display 2
  then 
       dirdisp="$dirdisplay2"
fi

# DEFAULT DIR 3  DISPLAY
if [[ "$controldir" = "$dir3display" ]]  # IF PWD = DEFAULT DIR 3 then display 3
  then 
       dirdisp="$dirdisplay3"
fi

# DEFAULT DIR 4  DISPLAY
if [[ "$controldir" = "$dir4display" ]]  # IF PWD = DEFAULT DIR 4 then display 4
  then 
       dirdisp="$dirdisplay4"  # if directory is changed to  Default Dir 4 :  The number 4 is normal text and the other 4 are less bold.
fi

################################################################################
##########  END   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################

########## blinking routine for display ##########

# blinking
downloadlist1=$(echo -e "\033[5mDOWNLOAD LIST\033m\033[0m\033[5m\033[5m\033[0m")

# not blinking
downloadlist0=$(echo "DOWNLOAD LIST")

# blinking
dash1=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")

# not blinking
dash0=$(echo "-")

# if file exists goto then
if [ -f "$pasteclip" ]
  then
      finalresult="$downloadlist1"  # if the file exists: blinking   DOWNLOAD LIST
      finalresult2="$dash1"  #                            blinking   -
  else
      finalresult="$downloadlist0"  # if the file doesn't exist: non blinking   DOWNLOAD LIST
      finalresult2="$dash0"  # if                                non blinking   -
fi

########## end blinking routine #################

#########################################################################################################################################################
# START Routine to find out if clipboard contents  =  The default list or a user list - dash blink or not:  Set User List and Delete User List
#########################################################################################################################################################

# REFORMAT PASTECLIP VARIBLE FOR COMPARISON TO CONTROL VARIBLE
echo "$pasteclip" > ~/.config/videoinfox/videoinfox.c.tmp  # write clipboard contents to to file
cat ~/.config/videoinfox/videoinfox.c.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.c.tmp2  # remove all froward slashes / and write file
rm ~/.config/videoinfox/videoinfox.c.tmp   # remove .c.tmp file
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.c.tmp2 # remove horizontal whitespace from file an write
# REFORMATTED PASTECLIP
read -r ctmp2 < ~/.config/videoinfox/videoinfox.c.tmp2  # clipboard content with default list or user list.
                                                        # list name with full path: with slashes and spaces removed
# CONTROL VARIABLE
ctmpprefformat=""$HOME"/.config/videoinfox/videoinfox-dl-Default"
# REFORMAT CONTROL VARIABLE FOR COMPARISON TO PASTECLIP VARIBLE
echo "$ctmpprefformat" > ~/.config/videoinfox/videoinfox.dlname.tmp  # write clipboard contents to to file
cat ~/.config/videoinfox/videoinfox.dlname.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dlname.tmp2  # remove all froward slashes / and write file
rm ~/.config/videoinfox/videoinfox.dlname.tmp   # remove .dlname.tmp file
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dlname.tmp2  # remove horizontal whitespace from file an write
# REFORMATTED CONTROL VARIABLE
read -r ctmp3 < ~/.config/videoinfox/videoinfox.dlname.tmp2  # default list name with full path: with slashes and spaces removed


if [ -z "$pasteclip" ]  # if clipboard is empty goto then
   then
        dashit2="$dash0"  # no blink dash for: Set User List and Delete User List

   else
   
        if [[ "$ctmp2" = "$ctmp3" ]]  # if clipbaord  = Default List goto then because the default list can't: Set User List or Delete User List
           then
                dashit2="$dash0"  # no blink dash for: Set User List and Delete User List

           else
                dashit2="$dash1"  #    blink dash for: Set User List and Delete User List
        fi
fi


# CONTROL VARIABLE 2  (clear Set User List filename)
read -r chkulistset < ~/.config/videoinfox/videoinfox.set-user-list
# REFORMAT CONTROL VARIABLE 2 FOR COMPARISON TO PASTECLIP VARIBLE
echo "$chkulistset" > ~/.config/videoinfox/videoinfox.chkulist.tmp  # write clipboard contents to to file
cat ~/.config/videoinfox/videoinfox.chkulist.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.chkulist.tmp2  # remove all froward slashes / and write file
rm ~/.config/videoinfox/videoinfox.chkulist.tmp   # remove .dlname.tmp file
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.chkulist.tmp2  # remove horizontal whitespace from file an write
# REFORMATTED CONTROL VARIABLE 2
read -r ctmp4 < ~/.config/videoinfox/videoinfox.chkulist.tmp2  # default list name with full path: with slashes and spaces removed


#  REMOVE TMP2 FILES
rm ~/.config/videoinfox/videoinfox.c.tmp2
rm ~/.config/videoinfox/videoinfox.dlname.tmp2 

#########################################################################################################################################################
# END Routine to find out if clipboard contents  =  The default download list or a user list. Display:   - vs ~  Set User List and Delete User List
#########################################################################################################################################################

# find default download list and write to file.
find ~/.config/videoinfox/videoinfox-dl-Default > ~/.config/videoinfox/videoinfox.dowload.list.default

# find user created download lists and write to file.
find "$PWD" -type f \( -iname "videoinfox-dl*" \) > ~/.config/videoinfox/videoinfox.dowload.list

# removing all lines that contain  .log   this removes all  */.videoinfox-dl*.log listings from results. write file: videoinfox.dowload.list  
sed -i '/.log/d' ~/.config/videoinfox/videoinfox.dowload.list

#################################### count lines file for message display below:  (Copy 1 above User List to the the clipboard to: Download or Set...) 
copymessage=$(sed -n '$=' ~/.config/videoinfox/videoinfox.dowload.list 2> /dev/null)

# Add default list to the download list
echo "$HOME/.config/videoinfox/videoinfox-dl-Default" >> ~/.config/videoinfox/videoinfox.dowload.list

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null

#############
# REMOVE PATH
sed 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp > ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp | cut -c 15- > ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.sorted.tmp
mv ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.sorted.tmp ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp

# SORT BACK INTO ORDER
#sort -u ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp > ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp

# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2 2>/dev/null

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2  # display numbered list
read -r ulistset < ~/.config/videoinfox/videoinfox.set-user-list  # set user list for videoinfox -u shortcut

# CLEAR USER SET LIST IF IT GETS DELETED OUTSIDE OF THE VIDEOINFOX INTERFACE
if [ -f "$chkulistset" ]  # if the user set list exists goto then
   then
       :
   else  # if the user set list doesn't exist, clear the user set list.
       echo > ~/.config/videoinfox/videoinfox.set-user-list
       ctmp4=""
fi

echo
echo "Directory:" "$PWD"

if [ -z "$ctmp4" ]  # if the set user list = null goto then
    then
         :  # don't display anything
    else
         #echo
         echo "User Set List:" "$ulistset"  # display if there is at least one line
fi

echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$der"" >>> YT-DLP MENU >>> DOWNLOAD LIST                                     "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________" 
echo
echo " d - Download List     s - Set User List        k - Default List       m - Create/Change Directory        q - Quit"
echo " v - View List         c - Create User List     a - Add to Queue"    
echo " l - View Log          r - Delete User List     b - Download Queue     z - Clear User Set List            h - Help"
echo 
echo -en " Enter Option: "
read -r -n1 optiond
echo
}

while true
do
dwnlist
case $optiond in

1)
cd "$dir1"
;;


2)
cd "$dir2"
;;


3)
cd "$dirsaved"
;;

4)
cd "$dir4"
;;


5)
cd "$dir5"
;;

         
q)  # QUIT (DOWNLOAD LIST)
break;;


z)  # CLEAR User Set List

sed 's/.*-//g' ~/.config/videoinfox/videoinfox.set-user-list > ~/.config/videoinfox/tmp/ulistset-minus-path # REMOVE PATH AND videoinfox-dl- 
#sed 's/.*\///' ~/.config/videoinfox/videoinfox.set-user-list > ~/.config/videoinfox/tmp/ulistset-minus-path # REMOVE PATH
read -r ulistset2 < ~/.config/videoinfox/tmp/ulistset-minus-path

if [ -z "$ulistset" ]
  then
      echo
      echo " There is no user set list . . ."
      sleep .7
  else
      
      function menuclrusl {
      clear
      echo
      echo " Clear user set list:" "$ulistset2"
      echo
      echo " y - Yes     n - No"  
      echo 
      echo -en " Enter Option: "
      read -r -n1 option
      echo
      }

      while true
      do
	menuclrusl
	case $option in

      y)  # YES
      echo > ~/.config/videoinfox/videoinfox.set-user-list
      echo
      echo " User set list cleared . . ."
      echo 
      sleep .7
      break;; 
        
      n)  # NO 
      break;;
      
      *)
                                
      esac
      done     
fi
;;


m)
##################################################################################################################################################
###########################   CREATE DIRECTORY  n   (DOWNLOAD LIST)   ############################################################################
##################################################################################################################################################

pasteclip2=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content   save to restore on option quit
echo "" | xclip -sel clip  # clearing the clipboard


function navtree {

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ -d "$pasteclip" ]  # if the directory exists gto then
  then
      :

  else      
      echo "$pastetemp" | xclip -sel clip  # clearing out the clipboaed
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     
fi


clear


# recursive list of directories for the user to copy one to the clipboard and press  c   to change to that directory
#### find "$PWD" -type d -iname "*" | sort -u 2>/dev/null

find "$PWD" -type d -iname "*" | sort -u > ~/.config/videoinfox/tmp/nt-list.tmp 2>/dev/null

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/nt-list.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/nt-list-number.tmp 2>/dev/null

cat ~/.config/videoinfox/tmp/nt-list-number.tmp


# recursive number of directories found
ttotal=$(find  "$PWD" -type d -iname "*" 2>/dev/null | wc -l)   

"$vnotify" "Videoinfox is done processing: Directory Tree" "Total Directories Found: "$ttotal" " # GUI Notification.

# recursive number of files found
#ttotalnum=$(find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" \) 2>/dev/null | wc -l)


##################################################################################
##########  START   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################## 

# DIRECTORY SELECTED IS NORMAL TEXT AND THE OTHER 4 ARE LESS BOLD. 

# DEFAULT DIR NUMBER 1 FORMAT
dirdisplay1=$(echo -e "1\033[2m 2 3 4 5\033[0m")
# DEFAULT DIR NUMBER 2 FORMAT
dirdisplay2=$(echo -e "\033[2m1 \033[0m2 \033[2m3 4 5\033[0m") 
# DEFAULT DIR NUMBER 3 FORMAT
dirdisplay3=$(echo -e "\033[2m1 2 \033[0m3 \033[2m4 5\033[0m")
# DEFAULT DIR NUMBER 4 FORMAT
dirdisplay4=$(echo -e "\033[2m1 2 3 \033[0m4 \033[2m5\033[0m")
# DEFAULT DIR NUMBER 5 FORMAT
dirdisplay5=$(echo -e "\033[2m1 2 3 4 \033[0m5\033[0m")
# NO MATCH ALL LESS BOLD
dirdisplayno=$(echo -e "\033[2m1 2 3 4 5\033[0m")


# FORMAT PWD NAME FOR COMPARISON
echo "$PWD" > ~/.config/videoinfox/videoinfox.pwd.tmp  # write PWD to a tmp file: videoinfox.pwd.tmp
cat ~/.config/videoinfox/videoinfox.pwd.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.pwd  # remove all froward slashes / write file: videoinfox.pwd
rm  ~/.config/videoinfox/videoinfox.pwd.tmp  # remove tmp file: videoinfox.pwd.tmp
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.pwd  # remove horizontal whitespace write file: videoinfox.pwd

# FORMAT DEFAULT DIR 1 NAME FOR COMPARISON
echo "$dir1" > ~/.config/videoinfox/videoinfox.dir1.tmp  # write dir 1 to a tmp file: videoinfox.dir1.tmp
cat ~/.config/videoinfox/videoinfox.dir1.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir1  # remove all froward slashes / write file: videoinfox.dir1
rm ~/.config/videoinfox/videoinfox.dir1.tmp  # remove tmp file: videoinfox.dir1.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir1  # remove horizontal whitespace write file: videoinfox.dir1

# FORMAT DEFAULT DIR 2 NAME FOR COMPARISON
echo "$dir2" > ~/.config/videoinfox/videoinfox.dir2.tmp  # write dir 2 to a tmp file: videoinfox.dir2.tmp
cat ~/.config/videoinfox/videoinfox.dir2.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir2  # remove all froward slashes / write file: videoinfox.dir2
rm ~/.config/videoinfox/videoinfox.dir2.tmp   # remove tmp file: videoinfox.dir2.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir2 # remove horizontal whitespace write file: videoinfox.dir2

# FORMAT DEFAULT DIR 3 NAME FOR COMPARISON
echo "$dirsaved" > ~/.config/videoinfox/videoinfox.dir3.tmp  # write dir 3 to a tmp file: videoinfox.dir3.tmp
cat ~/.config/videoinfox/videoinfox.dir3.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir3  # remove all froward slashes / write file: videoinfox.dir3
rm ~/.config/videoinfox/videoinfox.dir3.tmp   # remove tmp file: videoinfox.dir3.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir3 # remove horizontal whitespace write file: videoinfox.dir3

# FORMAT DEFAULT DIR 4 NAME FOR COMPARISON
echo "$dir4" > ~/.config/videoinfox/videoinfox.dir4.tmp  # write dir 4 to a tmp file: videoinfox.dir4.tmp
cat ~/.config/videoinfox/videoinfox.dir4.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir4  # remove all froward slashes / write file: videoinfox.dir4
rm ~/.config/videoinfox/videoinfox.dir4.tmp   # remove tmp file: videoinfox.dir4.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir4 # remove horizontal whitespace write file: videoinfox.dir4

# FORMAT DEFAULT DIR 5 NAME FOR COMPARISON
echo "$dir5" > ~/.config/videoinfox/videoinfox.dir5.tmp  # write dir 5 to a tmp file: videoinfox.dir5.tmp
cat ~/.config/videoinfox/videoinfox.dir5.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir5  # remove all froward slashes / write file: videoinfox.dir5
rm ~/.config/videoinfox/videoinfox.dir5.tmp   # remove tmp file: videoinfox.dir5.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir5 # remove horizontal whitespace write file: videoinfox.dir5


# LOAD EDITED PWD AND DEFAULT DIRECTORY NAMES FOR BELOW  IF LOOPS   (all frorward slashes / and white spaces removed from the below directory names)

read -r controldir < ~/.config/videoinfox/videoinfox.pwd    # load reformatted current directory name 
read -r dir1display < ~/.config/videoinfox/videoinfox.dir1  # load reformatted default directory 1 name
read -r dir2display < ~/.config/videoinfox/videoinfox.dir2  # load reformatted default directory 2 name
read -r dir3display < ~/.config/videoinfox/videoinfox.dir3  # load reformatted default directory 3 name
read -r dir4display < ~/.config/videoinfox/videoinfox.dir4  # load reformatted default directory 4 name
read -r dir5display < ~/.config/videoinfox/videoinfox.dir5  # load reformatted default directory 5 name


# DEFAULT DIR 5  DISPLAY     IF DIRECTORY ON EXIT  =  DEFAULT DIRECTORIES 1-4 then Display that directory number.

if [[ "$controldir" = "$dir5display" ]]
  then 

      if [[ "$dir5display" = "$dir1display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 1 then display 1 and not 5
        then
             dirdisp="$dirdisplay1"
      fi

      if [[ "$dir5display" = "$dir2display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 2 then display 2 and not 5
        then
             dirdisp="$dirdisplay2"
      fi

      if [[ "$dir5display" = "$dir3display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 3 then display 3 and not 5
        then
             dirdisp="$dirdisplay3"
      fi

      if [[ "$dir5display" = "$dir4display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 4 then display 4 and not 5
        then
             dirdisp="$dirdisplay4"
      fi
fi



# DEFAULT DIR 5 DISPLAY
if [[ "$controldir" = "$dir5display" ]] 
  then
       dirdisp="$dirdisplay5"  # if directory is changed to  Default Dir 5 :  The number 5 is normal text and the other 4 are less bold.
        
  else
       dirdisp="$dirdisplayno" # if directory doesn't match  Default Dirs 1-5 : All 5 numbers are less bold.  
fi 



# DEFAULT DIR 1  DISPLAY
if [[ "$controldir" = "$dir1display" ]]  # IF PWD = DEFAULT DIR 1 then display 1
  then 
       dirdisp="$dirdisplay1"
fi

# DEFAULT DIR 2  DISPLAY
if [[ "$controldir" = "$dir2display" ]]  # IF PWD = DEFAULT DIR 2 then display 2
  then 
       dirdisp="$dirdisplay2"
fi

# DEFAULT DIR 3  DISPLAY
if [[ "$controldir" = "$dir3display" ]]  # IF PWD = DEFAULT DIR 3 then display 3
  then 
       dirdisp="$dirdisplay3"
fi

# DEFAULT DIR 4  DISPLAY
if [[ "$controldir" = "$dir4display" ]]  # IF PWD = DEFAULT DIR 4 then display 4
  then 
       dirdisp="$dirdisplay4"  # if directory is changed to  Default Dir 4 :  The number 4 is normal text and the other 4 are less bold.
fi

################################################################################
##########  END   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################


########## blinking routines for display ##########

# not blinking Play Directory
playdir1=$(echo "Play Directory")
# blinking Play Directory
playdir2=$(echo -e "\033[5mPlay Directory\033m\033[0m\033[5m\033[5m\033[0m")

# not blinking dash
dash0=$(echo "-")
# blinking dash
dash1=$(echo -e "\033[5m-\033m\033[0m\033[5m\033[5m\033[0m")


# get file count of videos one directory deep for blinking   Play Directory
blinkit=$(find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)

# if find results are zero goto then
if [ "$blinkit" = 0 ]
  then
      blinkit2="$playdir1"  # zero files. non bliking  Playdirectory
      bdash="$dash0"
  else
      blinkit2="$playdir2" # not zero files. blinking  Play Directory
      bdash="$dash1"
fi


# not blinking
changedir1=$(echo "Change Directory")
# blinking
changedir2=$(echo -e "\033[5mChange Directory\033m\033[0m\033[5m\033[5m\033[0m")

# if directory exists goto then
if [ -d "$pasteclip" ]
  then
      changedir3="$changedir2"  # if the directory exists, blinking  Change Directory
  else
      changedir3="$changedir1"  # if the directory doesn't exist, non blinking  Change Directory
fi
########## end blinking routines ################## 


echo
echo "Treetop:" "$grabdirfornav2"
echo "Total Directories: "$ttotal" "
#echo "Total Video Files:" "$ttotalnum"                                                               	                                         
echo
echo "Current Directory:" "$PWD"
#echo "Video Files:" "$blinkit"
#echo
#echo "Clipboard:" "$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$der"" >>> CREATE/CHANGE DIRECTORY                                           "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________" 
echo
echo " c - Change Directory     m - Create Directory     n - Change Treetop                                     q - Quit"
echo " u - Up One Level                                  g - Find Directory"
echo " t - Treetop"
echo
echo -en " Enter Option: "
read -r -n1 option
echo
}
  
         while true
         do
         navtree
	    case $option in
         
         q)  # QUIT
    ##############################     cd "$grabdirfornav2" &>/dev/null   # restore directory
         echo "" | xclip -sel clip  # clearing the clipboard
         pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
         break
         ;;


         1)  # CD DIRECTORY TO TV    
         cd "$dir1" 
         grabdirfornav2="$dir1"
         ;;
    
         2)  # CD DIRECTORY TO MOVIES
         grabdirfornav2="$dir2"
         cd "$dir2" 
         ;;

         3)  # CHANGE DIRECTORY TO DOWNLOADS
         grabdirfornav2="$dirsaved"
         cd "$dirsaved" 
         ;;
   
         4)  # CHANGE DIRECTORY TO EXTRA   
         grabdirfornav2="$dir4"
         cd "$dir4" 
         ;;

         5)  # CHANGE DIRECTORY TO LAST EXIT
         grabdirfornav2="$dir5"
         cd "$dir5" 
         ;;


         g)	 #  FIND DIRECTORY  CREATE/CHANGE DIRECTORY in >>> YT-DLP MENU >>> DOWNLOAD LIST
clear
echo
echo "Directory: ""$PWD"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$ver"" >>> FIND DIRECTORY                 Enter only to quit                             * - Show All"
echo "___________________________________________________________________________________________________________________" 
echo
echo " The directory enterd must be recursively reachable from the current directory."
echo
read -r -p " Directory Name: " dirfind  # waiting fot user input - dierectory that you want to find
linecount=$(find . -type d -iname "$dirfind" 2>/dev/null | wc -l)   # number of files found
                                                                                    	
if [ -z "$dirfind" ]  # if no input was entered goto  <then>  
then
echo
echo " error: Nothing was entered"  
sleep 1.9
else               
     if echo "$dirfind" | grep "/" > /dev/null # if any slashes were entered goto <then>
     then
     echo
     echo " No slashes. Directory name only . . ."
     sleep .4  
     else
     echo
     find . -type d -iname "$dirfind" | sort -u > ~/.config/videoinfox/tmp/finthedir.tmp 2>/dev/null  # directory(s) found

     # CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/finthedir.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/finthedir.numberlist.tmp 2>/dev/null
   
     cat ~/.config/videoinfox/tmp/finthedir.numberlist.tmp
     echo
     echo "Total Directories Found:" "$linecount"  # number of files found
     sleep .4         
	    if [ "$linecount" = 0 ]  # if find returned no results goto <then>
	    then
	        :          
	    else
             echo
read -r -p "Enter number to change directory: " linenumber  # waiting fot user input
              if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
              then
              :
              else
              if [[ $linenumber -gt $linecount ]]
              then 
              echo
              echo " Number out of range . . ."
              sleep .4
              else
tail -n +"$linenumber" ~/.config/videoinfox/tmp/finthedir.tmp > ~/.config/videoinfox/tmp/finthedir.tmp2 2>/dev/null
              OLDIFS=$IFS
              IFS=$'\n'
              read line < ~/.config/videoinfox/tmp/finthedir.tmp2
              cd "$line" 2> /dev/null
              IFS=$OLDIFS
fi
fi
fi
fi
fi              
;;
       
         u)  # UP ONE LEVEL 
         if [ "$grabdirfornav2" = "$PWD" ]  # when   Up One Level   reaches the    Treetop    no   cd..   out of the parent directory 
           then
               echo
               echo " At treetop. Can't go any higher . . ."
               sleep .4

           else
               cd .. &>/dev/null
         fi 
         ;;
        

         t)  # TREE TOP
         cd "$grabdirfornav2" &>/dev/null
         ;;          


         c)  # CHANGE DIRECTORY
# GETTING LINECOUNT
linecount=$(wc -l ~/.config/videoinfox/tmp/nt-list.tmp | cut -d' ' -f1)

echo
read -r -p " Enter line number to change directory: " linenumber  # waiting fot user input


if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
  then  
      :

  else 


if [[ $linenumber -gt $linecount ]]
  then 
      echo
      echo " Number out of range . . ."
      sleep .4
  else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/nt-list.tmp > ~/.config/videoinfox/tmp/nt-list.tmp2 2>/dev/null

OLDIFS=$IFS
IFS=$'\n'

read line < ~/.config/videoinfox/tmp/nt-list.tmp2

      cd "$line" 2> /dev/null
 
      IFS=$OLDIFS
  
      fi
      fi
;;        

 
         m)  # CREATE DIRECTORY  (CREATE DIRECTORY)
         echo
         echo " Enter name for new directory or enter with no entry to cancel . . ."
         echo
         read -r -p " Create Directory: " newdir  # waiting fot user input.

         direxist4="$PWD""/""$newdir"

         if [ -z "$newdir" ]
           then
               echo
               echo " Nothing was entered . . ."
               sleep .4

           else
               if [ -d "$direxist4" ] 
                 then
                     echo
                     echo " Directory already exists . . ."
                     sleep .4

                 else
                     mkdir "$newdir" 2> /dev/null
                     echo
                     echo " Directory Created:" "$PWD""/""$newdir"
                     sleep .7
           fi
         fi

         ;;

         
         ########################################################################################################################################
         n)  # CHANGE TREETOP (CREATE DIRECTORY)  ###############################################################################################
         ########################################################################################################################################

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo
echo " $ver >>> CHANGE TREETOP"
echo "___________________________________________________________________________________________________________________"
echo
echo " No quotations needed for paths with spaces. Case sensative."
echo 
echo " Enter directory or paste directory if in clipboard."
echo
read -r -p " " specifydir  # waiting fot user input - the directory you want to chang to 
	
	if [ -z "$specifydir" ]  # if no input was entered goto  <then> 
          then
               echo
               echo " Nothing was entered . . ."
               sleep .4
          else
              if [ -d "$specifydir" ]  #  if directoty exists goto  <then>
                then
                     echo
                     grabdirfornav2="$specifydir"
                     cd "$specifydir"   # change the directory
                     echo " Treetop changed to: $PWD"  # <pwd>  print current working directory to the screen
                     sleep 1                   
                else
                     echo
                     echo " No such directory . . ."
                     sleep .4                  
          fi
    fi       
echo

;;

         esac
         done
         ;;


a)  # ADD TO QUEUE (DOWNLOAD LIST)
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "Add list number to the download queue: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default 2> /dev/null

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file to set selected playlist to download           

            if [[ "$playnumber" = "$defaultlist" ]] 
              then  # if the default download list is selected          
                  echo
                  echo "The default download list cannot be added to the queue . . ."
                  sleep .7
              else
                  echo "$playnumber" >> ~/.config/videoinfox/videoinfox-download.queue
                  echo
                  echo "$playnumber"
                  echo
                  echo "Download list added to queue . . ."
                  sleep .4
                      
fi
fi
fi
fi
fi
fi
;;

    b)   # DOWNLOAD QUEUE  (DOWNLOAD LIST)

# SAVE CURRENT DIRECTORY FOR RESTORE ON FUNCTION
savethedir="$PWD"

function dwnque {

clear

if [ -f ~/.config/videoinfox/videoinfox-download.queue ]
  then
      # REMOVE DUPLICATES
      cat -n ~/.config/videoinfox/videoinfox-download.queue | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfox-download.queue.tmp
      mv ~/.config/videoinfox/videoinfox-download.queue.tmp ~/.config/videoinfox/videoinfox-download.queue
      
      # REMOVE BLANK LINES
      sed -i '/^$/d' ~/.config/videoinfox/videoinfox-download.queue
      
      cat ~/.config/videoinfox/videoinfox-download.queue

  else
      echo
      echo " Download queue empty . . ."
fi
      
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> DOWNLOAD QUEUE"        
echo "___________________________________________________________________________________________________________________"
echo
echo " b - Download Queue     d - Delete Queue                                                                  q - Quit"
echo 
echo -en " Enter Option: "
read -r -n1 optiondq
echo
}


while true
do
dwnque
case $optiondq in


        q)  # QUIT   (DOWNLOAD QUEUE)
        break ;;

      
        d)  # DELETE QUEUE LIST  (DOWNLOAD QUEUE)
        function menudelq {
   
        clear
        echo
        echo " Delete Download Queue?"
        echo
        echo " y - Yes     n - No"  
        echo 
        echo -en " Enter Option: "
        read -r -n1 optiondelq
        echo
        }

        while true
        do
	  menudelq
	  case $optiondelq in

	  y)  # YES
        if [ -f ~/.config/videoinfox/videoinfox-download.queue ]
          then
              rm ~/.config/videoinfox/videoinfox-download.queue 2> /dev/null
              echo
              echo " Download Queue Deleted . . ."
              sleep .4
          else
              echo
              echo " Download Queue was already deleted . . ."
              sleep .4
        fi
        break
        ;;


        n)  # NO
        break;;

        *)
        
        esac
        done
        ;;


        b)  # DOWNLOAD QUEUE  (DOWNLOAD QUEUE)

# READ USER SET LIST FOR REMOVAL IF IT IS IN THE DOWNLOAD QUEUE
read usersetlist < ~/.config/videoinfox/videoinfox.set-user-list

#################################################
##########  START DOWNLOAD QUEUE LOOP  ########## 
#################################################

if [ -f ~/.config/videoinfox/videoinfox-download.queue ]
  then

clear

# DOWNLOAD QUEUE FILE
input1=~/.config/videoinfox/videoinfox-download.queue


# LOOP 1 READ LINE BY LINE DOWNLOAD QUEUE LIST
while read -r line
do

input2="$line"

echo
echo 
echo -e "Processing Download List:" "\033[5m"$line"\033m\033[0m"

# REMOVE BLANK LINES IN CURRENT DOWNLOAD LIST
sed -i '/^$/d' "$line"

# WRITE LINE TO TEMP FILE.  DOWNLOAD LIST WITH FULL PATH
echo "$line" > ~/.config/videoinfox/tmp/videoinfox-queue.tmp

# REMOVE FILE NAME FROM PATH AND WRITE FILE
sed -i 's%/[^/]*$%%' ~/.config/videoinfox/tmp/videoinfox-queue.tmp 

# READ FILE WHICH IS PATH ONLY
read -r abc < ~/.config/videoinfox/tmp/videoinfox-queue.tmp

# CHANGE TO READ PATH
cd "$abc"

# CREATE LOG FILE FOE CURRENT DOWNLOAD LIST 
logfile="$line".log  # tag  .log  onto the users Download List  */.videoinfox-dl*.log 
echo ""$ver" >>> DOWNLOAD LIST >>> Logfile:" "$line"".log" > "$logfile"  # create file
echo >> "$logfile"

# IF DOWNLOAD LIST = SET USER LIST THEN REMOVE
if [ "$line" == "$usersetlist" ]
  then
      echo > ~/.config/videoinfox/videoinfox.set-user-list
  else
      :
fi


# LOOP 2 READ LINE BY LINE FROM CURRENT DOWNLOAD LIST
    while read -r line  
    do

    echo

    ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line"  # download url

    echo
    echo "Logging URL and Filename to:" "$logfile"

    # logging yt-dlp output
    echo "$line" >> "$logfile" 
    ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line" | tee >> "$logfile"
    echo >> "$logfile" 

    ############  REMOVE UNWANTED LOG INFO  ############# 
    sed -i '/\[youtube\]/d' "$logfile" &> /dev/null  # removing lines that start with  [youtube]
    sed -i '/\[info\]/d' "$logfile" &> /dev/null  # removing lines that start with  [info]
    sed -i 's/\[download\]//' "$logfile" &> /dev/null  # remove   [download]   from the end of the line.
    sed -i 's/has already been downloaded//' "$logfile" &> /dev/null  # remove   has already been downloaded   from the end of the line.
    sed -i -e 's/^[ \t]*//' "$logfile" &> /dev/null  # remove spaces at beginning of line.
    #####################################################    

    done < "$input2"

done < "$input1"

###############################################
##########  END DOWNLOAD QUEUE LOOP  ########## 
###############################################

echo
echo
echo -e "$der" "\033[5mDone processing download queue . . .\033m\033[0m"
echo
echo "Press enter to exit this screen"

"$vnotify" "Videoinfox messsage: Done Processing Download Queue . . ."

read -p ""
echo "" | xclip -sel clip  # clearing out the clipboard

cd "$savethedir"  # RESTORE DIRECTORY

else
    :
fi
;;

esac
done
;;


c)  # CREATE USER LIST  <DOWNLOAD LIST>
echo
echo " Spaces can be used after the first character."
echo
read -r -p " Create New List: " createulist  # waiting fot user input. grabbing new filename

if [ -z "$createulist" ]  # if enter is pressed with no entry
  then
      echo
      echo " Nothing was entered . . ."
      sleep .4

  else

      if [ -f "videoinfox-dl-""$createulist" ]
        then
            echo
            echo " File already exists . . ."
            sleep .7

        else

ulistname="$PWD/videoinfox-dl-""$createulist"  # add user input to end of:  current directory/videoinfox-dl
echo > "$ulistname"  #  create user list with full path and filename
echo
echo " User List Created: "$ulistname""
echo
echo
sleep 1

      fi
fi
;; 


s)  # SET USER LIST  <DOWNLOAD LIST>
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "Set user list number: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default 2> /dev/null

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file to set selected playlist to download           

            if [[ "$playnumber" = "$defaultlist" ]] 
              then  # if the default download list is selected          
                  echo
                  echo "The default download list cannot be set as a user list . . ."
                  sleep 1
                  else
                  echo "$playnumber" > ~/.config/videoinfox/videoinfox.set-user-list
fi
fi
fi
fi
fi
fi
;;

r)  # DELETE USER LIST  <DOWNLOAD LIST>
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "Delete list number: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default 2> /dev/null

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then 
      :
  else
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file to set selected playlist to download           

            if [[ "$playnumber" = "$defaultlist" ]] 
              then  # if the default download list is selected          
                  echo
                  echo "The default download list cannot be deleted. It can only be cleared . . ."
                  sleep 1
                  else
                      function menudul {
                      clear
                      echo
                      echo " Delete User List:" "$playnumber"
                      echo
                      echo " y - Yes     n - No"  
                      echo 
                      echo -en " Enter Option: "
                      read -r -n1 option
                      echo
                      }

                      while true
                      do
	                menudul
	                case $option in

                      y)  # YES
                      rm "$playnumber"*
                      echo
                      echo " User List DELETED . . ."
                      echo 
                      sleep .4
                      break;; 
        
                      n)  # NO 
                      echo
                      echo " User List SAVED . . ."
                      echo   
                      sleep .4
                      break;;
      
                *)
                                
                esac
                done     
fi
fi
fi
fi
fi
fi
;;


k)  # DEFAULT LIST  <DOWNLOAD LIST>

###############echo "" | xclip -sel clip  # clearing out the clipboard

function ddefault {

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content


# ######### start blinking and error correcting routine #################

# blinking
addtodefault1=$(echo -e "\033[5mAdd to Default List\033m\033[0m\033[5m\033[5m\033[0m")

# not blinking
addtodefault0=$(echo "Add to Default List")


checktheclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$checktheclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      atd="$addtodefault1"
      
  else      
      atd="$addtodefault0"
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content      

fi

########## end blinking and error correcting routine #################

# # DEFAULT LIST - REMOVE DUPLICATES, BLANK LINES and ANY LINES NOT STARTING WITH HTTP
cat -n ~/.config/videoinfox/videoinfox-dl-Default | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfox-dl-Default.tmp
mv ~/.config/videoinfox/videoinfox-dl-Default.tmp ~/.config/videoinfox/videoinfox-dl-Default

sed -i '/^$/d' ~/.config/videoinfox/videoinfox-dl-Default 2>/dev/null  # remove any blank lines in the list
sed -i '/http/!d' ~/.config/videoinfox/videoinfox-dl-Default  # remove all lines not starting with  http

clear
cat ~/.config/videoinfox/videoinfox-dl-Default  # display default download list
echo
echo "Download Directory: $dirsaved"  # dislpay default download directory
echo
echo "Copy 1 video url to the clipboard then -Add to Default List to add the url to the default list."
echo
#echo "Directory:" "$PWD"
echo "Clipboard:" "$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$der"" YT-DLP MENU >>> DOWNLOAD LIST >>> DEFAULT LIST                Enter - Update Clipboard Display"
echo "___________________________________________________________________________________________________________________" 
echo
echo " a - "$atd"     r - Remove Last Entry     c - Clear Default List     x - Clear Clipboard     q - Quit"
echo
echo -en " Enter Option: "
read -r -n1 optiondd
echo
}

while true
do
ddefault
case $optiondd in
         
q)  # QUIT  <DEFAULT LIST>
###echo "" | xclip -sel clip  # clearing out the clipboard
###pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
break;;


x) #  CLEAR CLIPBOARD  <DEFAULT LIST> 
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
;;


c)  # CLEAR DEFAULT LIST   <DEFAULT LIST>  
function yesorno {
clear
echo
echo " Clear the Default List?"
echo
echo " y - Yes     n - No"  
echo 
echo -en " Enter Option: "
read -r -n1 optionyn
echo
}

while true
do
    yesorno
    case $optionyn in
	
    y) 
    # CREATING EMPTY DEFAULT DOWNLOAD LIST WITH LIST EMPTY MESSAGE
    echo > ~/.config/videoinfox/videoinfox-dl-Default
    echo "Default Download List Empty" >> ~/.config/videoinfox/videoinfox-dl-Default
 
    rm ~/.config/videoinfox/videoinfox-dl-Default.log 2> /dev/null    
 
    echo
    echo " Default List CLEARED . . ."
    echo 
    sleep .4
    break;; 
 
       
    n) 
    echo
    echo " Default List SAVED . . ."
    echo     
    sleep .4

    break;;

*)
          
esac
done
;;

a)  # ADD TO DEFAULT LIST  <DEFAULT LIST>

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
echo "$pasteclip" >> ~/.config/videoinfox/videoinfox-dl-Default
# "$vnotify" "Videoinfox Message: Added to Default Download List." ""$pasteclip"" # GUI Notification.
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
;;


r)  # REMOVE LAST LINE IN THE DEFAULT DOWNLOAD LIST <DEFAULT LIST>

sed -i '$d' ~/.config/videoinfox/videoinfox-dl-Default
;;


*)

esac
done
;;


d)  # DOWNLOAD LIST

dirclip="$PWD"
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
#cat ~/.config/videoinfox/videoinfox.dowload.list
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "Download list number: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then
      :
  else  # ENTRY IS A NUMBER
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file to set selected playlist to download           

            if [[ "$playnumber" = "$defaultlist" ]] 
            then  # if the default download list is selected, change to the default download directory          
            dldir="$dirsaved"           
            else  # if anything other than the default list is selected, change to the directory of the list's location
            dldir=$(echo "$playnumber" | sed 's%/[^/]*$%%' ) # remove last slash and filename from the path for the cd command
            fi 

            cd "$dldir" # change directory to list location

                if [ -z "$playnumber" ]
                  then
                      :
                  else
                      read -r isitempty < "$playnumber"
                
                          if [ -z "$isitempty" ]
                            then
                                echo
                                echo "List is empty . . ."
                                sleep .4
else


if [ "$linenumber" = 0 ]
  then
      :
  else

logfile="$playnumber".log  # tag  .log  onto the users Download List  */.videoinfox-dl*.log 
echo "$ver" ">>> DOWNLOAD LIST >>> Logfile:" "$playnumber"".log" > "$logfile"  # create file
echo >> "$logfile"
clear
input="$playnumber"
################  DOWNLOAD LOOP START  ##############
while read -r line  # read line by line until end
do
echo
~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line"  # download url
echo
echo "Logging URL and Filename to:" "$logfile"
# logging yt-dlp output
echo "$line" >> "$logfile" 
~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$line" | tee >> "$logfile"
echo >> "$logfile" 
done < "$input"
################  DOWNLOAD LOOP END  ################

#...........  REMOVE UNWANTED LOG INFO  ............. 
sed -i '/\[youtube\]/d' "$playnumber".log &> /dev/null  # removing lines that start with  [youtube]
sed -i '/\[info\]/d' "$playnumber".log &> /dev/null  # removing lines that start with  [info]
sed -i 's/\[download\]//' "$playnumber".log &> /dev/null  # remove   [download]   from the end of the line.
sed -i 's/has already been downloaded//' "$playnumber".log &> /dev/null  # remove   has already been downloaded   from the end of the line.
sed -i -e 's/^[ \t]*//' "$playnumber".log &> /dev/null  # remove spaces at beginning of line.
#....................................................
echo
echo
echo -e "$der" "\033[5mDone processing download list . . .\033m\033[0m"
echo
echo "List:" "$playnumber"  # display list filename with full path
echo "Log :" "$logfile"  # display log filename with full path
echo
echo "Press enter to continue . . ."
"$vnotify" "Videoinfox messsage: Done Processing Download List . . ." "$playnumber"
read -p ""

#########################################################################################################################################################
# START Routine to find out if selection  =  set user list filename  if it does, the file will be cleared from the screen after list download
#########################################################################################################################################################

# REFORMAT SELECTION FOR COMPARISON
echo "$playnumber" > ~/.config/videoinfox/videoinfox.c.tmp  # write selection to file
cat ~/.config/videoinfox/videoinfox.c.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.c.tmp2  # remove all froward slashes / and write file
rm ~/.config/videoinfox/videoinfox.c.tmp   # remove .c.tmp file
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.c.tmp2 # remove horizontal whitespace from file an write
read -r ctmp2 < ~/.config/videoinfox/videoinfox.c.tmp2  # selection with full path. slashes and spaces removed
# THE ABOVE COMPARED TO
read -r getuserlist < ~/.config/videoinfox/videoinfox.set-user-list 
echo "$getuserlist" > ~/.config/videoinfox/videoinfox.checku.tmp  # write filename to file: ~/.config/videoinfox/videoinfox.checku.tmp 
cat ~/.config/videoinfox/videoinfox.checku.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.checku.tmp2  # remove all froward slashes / and write file
rm ~/.config/videoinfox/videoinfox.checku.tmp   # remove .dlname.tmp file
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.checku.tmp2  # remove horizontal whitespace from file an write
read -r ctmp5 < ~/.config/videoinfox/videoinfox.checku.tmp2  # set user list filename with full path. slashes and spaces removed

if [[ "$ctmp2" = "$ctmp5" ]]  #  if selection = Default List goto then because the default list can't: Set User List
  then
      echo > ~/.config/videoinfox/videoinfox.set-user-list
  else
      :
fi 

#  REMOVE TMP2 FILES
rm ~/.config/videoinfox/videoinfox.c.tmp2
rm ~/.config/videoinfox/videoinfox.checku.tmp2
#########################################################################################################################################################
# END Routine to find out if selection  =  set user list filename  if it does, the file will be cleared from the screen after list download
#########################################################################################################################################################
fi
fi
fi
fi
fi

fi


cd "$dirclip"  # restore directory to before  Download List
;;


v)  # VIEW A DOWNLOAD LIST
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "View list number: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default 2> /dev/null

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then
      :
  else 
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null         
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file           
            sed -i '/^$/d' "$playnumber"  # remove all blank lines from the user's list             
            sed -i '/http/!d' "$playnumber"  # remove all lines not starting with: http from the user's list
            tvar=$(wc -l "$playnumber" | cut -d' ' -f1)  # GETTING LINECOUNT

               if [ "$tvar" = 0 ]
                 then
                     echo
                     echo "List is Empty . . ."
                     sleep .4
                 else
                     clear
                     cat "$playnumber" 2>/dev/null
                     echo
                     echo "Download List:" "$playnumber"
                     echo
                     read -p "Up/Down arrows or mouse to scroll.  Press enter to quit"           
fi
fi
fi
fi
fi
fi
;;


l)  # VIEW LOGS
linecount=$(wc -l ~/.config/videoinfox/videoinfox.dowload.list | cut -d' ' -f1)  # GETTING LINECOUNT

clear
cat ~/.config/videoinfox/tmp/videoinfo-number-dowload.list.tmp2
echo
read -r -p "View log number: " linenumber  # waiting fot user input
read -r defaultlist < $HOME/.config/videoinfox/videoinfox.dowload.list.default 2> /dev/null

if [ -z "$linenumber" ]
then # BLANK ENTRY
    :
else

re='^[0-9]+$'
if ! [[ $linenumber =~ $re ]]
  then
      :
  else

if [ "$linenumber" = 0 ]
  then
      :
  else

if ! [[ "$linenumber" -eq "$linenumber" ]]
  then
      :
  else
      if [[ $linenumber -gt $linecount ]]
        then  # ENTRY EXCEEDS TOTAL NUMBER OF LINES 
            echo  
            echo "Number out of range . . ."
            sleep .4
        else  # ENTRY IS A VALID NUMBER            
            # create file moving selected line number to the top
            tail -n +"$linenumber" ~/.config/videoinfox/videoinfox.dowload.list > ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp 2>/dev/null         
            read playnumber < ~/.config/videoinfox/tmp/videoinfox.dowload.list.tmp # read first line of file
            playnumber2=~/.config/videoinfox/videoinfox.dowload.list

                 if [ -f "$playnumber"*.log ]
                   then
                       clear
                       cat "$playnumber"*.log 2>/dev/null
                       echo
                       echo "Download List Log:" "$playnumber"*.log
                       echo
                       read -p "Up/Down arrows or mouse to scroll.  Press enter to quit"
                   else
                       echo
                       echo "List not downloaded yet . . ."
                       sleep .7          
fi
fi
fi
fi
fi
fi
;;


h) # DOWNLOAD LIST HELP
less ~/.config/videoinfox/videoinfox.download-list-help
;;

*)
;;

esac
done
;;


#######################################################################################################################################
########################   (PLAY ClIPBOARD) YT-DLP MENU   #############################################################################
#######################################################################################################################################

     p) 
     #  @PLAY CLIPBOARD - <VIEW DOWNLOADS>
          
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
     ################# grabdir="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi

   
      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
                else
                    read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
         then
             :
         else     
             "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
             echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List File  
             $defplayer "${defplayargu[@]}" "$ytdlplast" 2> /dev/null  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdir"   # restore dir prior to entering yt-dlp menu              

  else

      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi
       
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard

      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

      echo " Played List Closed"
      
       else
            
           echo
           echo
           echo " No playable content in the clipboard . . ."
           sleep .9
       fi
fi

cd "$grabdir"
;;

  
#####################################################################################
     v)  # VIEW DOWNLOADS
##################################################################################### 

clipsave=$(xclip -o -selection clipboard 2> /dev/null)  # save clipboard content         

keepdir="$PWD"  # save dir for exit      
     

      function menuyt {  # LIST ALL VIDEO FILES RECURSIVELY IN THE DEFAULT DOWNLOAD DIRECTORY 


cd "$dirsaved"

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

grabclip=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

if [ "$grabclip" = "http" ]  # if the first 4 characters = <http> go then
  then
      :

  else      
      if [ -f "$pasteclip" ]
        then
            :
        else
            echo "" | xclip -sel clip  # clearing out the clipboaed
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      fi
fi

# Find video files.
find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/videoinfo.view-downloads

# CHECK FOR FILES to display:  - vs ~
istherefiles=$(find "$PWD" -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) | wc -l)

vdash0=$(echo "-")
vdash1=$(echo "~")

if [ "$istherefiles" = 0 ]
  then
      vdash="$vdash0"  
  else
      vdash="$vdash1"
fi

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content                  
clear
#cat ~/.config/videoinfox/videoinfo.view-downloads

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/videoinfo.view-downloads > ~/.config/videoinfox/videoinfo.view-downloads.tmp
mv ~/.config/videoinfox/videoinfo.view-downloads.tmp ~/.config/videoinfox/videoinfo.view-downloads 

#  REMOVE BLANK LINES
sed '/^$/d' ~/.config/videoinfox/videoinfo.view-downloads > ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed 's/.*\///' ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp > ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp2 2>/dev/null

# CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp 2>/dev/null
rm ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp2 2>/dev/null

cat ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp  # display numbered find results 


echo
#echo "Download Directory: $dirsaved"  # dislpay default download directory
#echo "Clipboard: ""$pasteclip"


##################################################################################################################################################
#=================================================================================================================================================
#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT DISPLAY
#=================================================================================================================================================
##################################################################################################################################################

# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character

# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  
# If it is <http>, YT-DLP will get the clipboard. yt-dlp will check if its a valid link by trying to extract the name of the video file.
# If it isn't <http>  the ytdlp loop will be skipped

if [ "$grabpaste" = "http" ]  # if the first 4 characters = <http> go then
  then
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null  # reding default download directory
      ytdlpconfirm=$(~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" 2> /dev/null)

            if [ "$ytdlpconfirm" = "" ]  
                  then

                      echo "" | xclip -sel clip  # clearing out the clipboard
                      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

                           # Videoinfox v2.00________________________________________ Videoinfox v2.00_________________________________________
                           #________________x________________________________________ _________________________________________________________
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> YT-DLP MENU >>> VIEW DOWNLOADS"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " j "$vdash" Play     o "$vdash" Autoplay     d "$vdash" Play Directory     p - Play Clipboard     i "$vdash" Info     x - Clrclp      q - Quit"          
                      echo            

                  else 
                      #echo
                      echo "Clipboard: ""$pasteclip"
                      echo "YT-DLP Confirmed: "$ytdlpconfirm""
                      echo "Download Directory: $dirsaved"  # dislpay default download directory
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo " "$der" >>> YT-DLP MENU >>> VIEW DOWNLOADS"
                      echo "___________________________________________________________________________________________________________________"
                      echo
                      echo -e " j "$vdash" Play     o "$vdash" Autoplay     d "$vdash" Play Directory     p * Play Clipboard     i "$vdash" Info     x - Clrclp      q - Quit"    
                      echo                                                                                  
            fi
  else

      if [ -f "$pasteclip" ]  # 
        then      
            echo "Clipboard:" "$pasteclip"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " "$der" >>> YT-DLP MENU >>> VIEW DOWNLOADS"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo -e " j "$vdash" Play     o "$vdash" Autoplay     d "$vdash" Play Directory     p * Play Clipboard     i "$vdash" Info     x - Clrclp      q - Quit" 
            echo                                                             

        else 

            echo "" | xclip -sel clip  # clearing out the clipboard
            pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

            echo "Download Directory: $dirsaved"  # dislpay default download directory 
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " "$der" >>> YT-DLP MENU >>> VIEW DOWNLOADS"
            echo "___________________________________________________________________________________________________________________"
            echo
            echo " j "$vdash" Play     o "$vdash" Autoplay     d "$vdash" Play Directory     p - Play Clipboard     i "$vdash" Info     x - Clrclp      q - Quit"
            echo                                          
fi
fi

echo -en " Enter Option: "
read -r -n1 optionyt

}
        
              while true
              do
              menuyt
	         case $optionyt in


              q)  # QUIT        
              cd "$keepdir"
              rm ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp 2> /dev/null
              rm ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp 2> /dev/null
              break;;


              x) # CLRCLP 
              echo "" | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              ;;

            
              p)
 
          #  @PLAY CLIPBOARD - <VIEW DOWNLOADS>
          
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      grabdir="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      
      read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"   # change to download directory
 
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
    
      # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload   to restore on Play Clipboard with invalid url
      cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
   
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
      # remove first dot and everything after it in filename. this was done because file names with dots before the extension were breking find results
      sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

      # remove first [ and everything after it in filename. this was done because file names with [ 
      sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

      # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
      mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload
      
      if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
         then
             # make a backup copy of:   ~/.config/videoinfox/videoinfo.lastdownload to restore on Play Clipboard with invalid url
             cp ~/.config/videoinfox/videoinfo.lastdownload ~/.config/videoinfox/videoinfo.lastdownload.bak
         else
             :
      fi


      read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt
      read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download 
             
      ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))  # finding the file to play

      echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file

   
      # IF THERE ARE IDENTICAL FILENAMES WITH DIFFERENT FILE EXTENSIONS FIND WILL PRODUCE MORE THAN ONE RESULT      
      correcterror=$(wc -l ~/.config/videoinfox/videoinfo.find-last-download | cut -d' ' -f1)  # getting line count.
          
             if [ "$correcterror" -gt 1 ]  # If line count is greater than 1 goto then. More than 1 was caused from Play Clipboard on invalid url.
                then                
                     if [[ "$lastdownload" == "$lastdownloadbak" ]]                 
                        then
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                     
                        else
                            echo > ~/.config/videoinfox/videoinfo.find-last-download
                            read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download
                     fi
                               
             else
                  read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download      
                                     
             fi      

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY LAST DOWNLOAD"
      echo
      echo " [PLAYING]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
     echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      if [ -z "$ytdlplast" ]
         then
             :
         else     
             "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
             echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List File  
             $defplayer "${defplayargu[@]}" &> /dev/null "$ytdlplast"  
      fi 
      
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      
      cd "$grabdir"   # restore dir prior to entering yt-dlp menu              

  else
      
      if [ -f "$pasteclip" ]
        then

echo "$pasteclip" > ~/.config/videoinfox/tmp/play-clipboard-local-file.1
# REMOVE EVERYTHING FROM THE BEGINNING OF THE LINE UP TO AND INCLUDING THE DOT). LEAVING THE EXTENSION
cat ~/.config/videoinfox/tmp/play-clipboard-local-file.1 | sed 's/.*\.//' > ~/.config/videoinfox/tmp/play-clipboard-local-file.2
read -r whatfext < ~/.config/videoinfox/tmp/play-clipboard-local-file.2
if [[ "$whatfext" = "mp4" ]]
then
:
elif [[ "$whatfext" = "mkv" ]]
then
:
elif [[ "$whatfext" = "avi" ]]
then
:
elif [[ "$whatfext" = "webm" ]]
then
:
elif [[ "$whatfext" = "divx" ]]
then
:
elif [[ "$whatfext" = "3gp" ]]
then
:
else
echo "" | xclip -sel clip  # clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
fi
 
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAYING]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
     echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
       # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$pasteclip" |  awk -F '/' '{print $NF}')  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"
     
      echo "$pasteclip" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$pasteclip" 2>/dev/null  # play video in clipboard
      echo "" | xclip -sel clip  # clearing out the clipboard
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

      echo " Played List Closed"
 
        else
            
           echo
           echo
           echo " No playable content in the clipboard . . ."
           sleep .9
      fi 
fi

cd "$grabdir"
;;  


              i)  # INFO - <VIEW DOWNLOADS>


if [ "$istherefiles" = 0 ]
  then
      echo
      echo
      echo " No video files in the default download directory . . ."
      sleep .7

  else
 
      if [ -f "$pasteclip" ]
        then
            pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
            echo
            echo
            echo " ""$pasteclip"
            echo  

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

            echo
            read -r -p " Press enter to continue . . ." 

        else
            if [ -f ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp ]  # if file exists goto then
              then
              echo
              echo
              read -r -p " Enter line number to get info: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else
             # create file moving selected line number to the top
             tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp > ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp 2>/dev/null
      
             # read first line of file for play
             read playnumber < ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp

                 if [ -z "$playnumber" ]
                   then
                       :
 
                   else
                       #echo
                       echo
                       echo "$playnumber"
                       echo
           
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration

                       echo
                       read -r -p " Press enter to continue . . ." 
                       rm ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp 2>/dev/null

                 fi
fi
        else
            :

            fi

      fi

  fi


;;

         ########################################################################################################################################
         d)  # (@PLAY DIRECTORY) VIEW DOWNLOADS  ################################################################################################
         ########################################################################################################################################

rm ~/.config/videoinfox/tmp/videoinfox.numbered-viewdownloads-play-directory-list 2>/dev/null

# WRITING VIDEO FILE LIST TO FILE: /.config/videoinfox/tmp/videoinfo.nt-play-directory-apa 
find "$PWD" -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) > ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa-work 2>/dev/null

# SORT BACK INTO ORDER
sort -u ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa-work > ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa

#  CHECK FOR AT LEAST ONE LINE THAT STARTS WITH A SLASH /
atleastone=$(grep '^/' ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa 2>/dev/null | wc -l)

#  IF THE NUMBER DOESN"T = 0  THEN PROCESS AUTO PLAY OF PLAYED LIST
if [ $atleastone -ne 0 ]  
   then

#  ASSIGN PLAYED LIST TO VARIABLE: $moddedplayedlist 
moddedplayedlist="$HOME""/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa"

#  PLAYED LIST INPUT FOR LOOP
input="$moddedplayedlist"  

#  CREATE TEMP FILE NEEDED FOR LOOP 
echo > ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2

#  #  START WRITING
while read -r line  # read line by line and write line by line until end of file
do

   if [ -f "$line" ]
      then # ONLY WRITE LINE TO FILE IF IT IS A VALID PATH AND FILE
           echo "$line" >> ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2  
      else
           :
   fi        

done < "$input"
#  DONE WRITING ONLY VALID FILES

#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa 2>/dev/null


#  REMOVE BLANK LINES
sed -i '/^$/d' ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2 2>/dev/null

#  MOVE apa2 BACK TO apa
cp ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2 ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa 2>/dev/null

# REMOVE PATH ONLY LEAVING FILENAME
sed -i 's/.*\///' ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2

# NUMBER THE LIST
sed '/./=' ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa2 | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/videoinfox.numbered-viewdownloads-play-directory-list 2>/dev/null
   
else 
    :
fi

if [ -f ~/.config/videoinfox/tmp/videoinfox.numbered-viewdownloads-play-directory-list ]
   then
        cat ~/.config/videoinfox/tmp/videoinfox.numbered-viewdownloads-play-directory-list 2>/dev/null

linenumber=1

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa.tmp 2>/dev/null
mv ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa.tmp ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa 2>/dev/null

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> VIEW DOWNLOADS >>> PLAY DIRECTORY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " QVideo Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa > ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa-nextup 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfox.viewdownloads-play-directory-apa-nextup
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done
 
IFS=$OLDIFS

else
     echo
     echo " No video files in the default download directory . . ."
     sleep .7
fi
;;           

              o)
##################################################################################################################################################
###########################   AUTOPLAY LINE  o   <VIEW DOWNLOADS>  ###############################################################################
##################################################################################################################################################


if [ "$istherefiles" = 0 ]
  then
      echo
      echo
      echo " No video files in the default download directory . . ."
      sleep .7

  else


if [ -f ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp ]
  then
clear
cat ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp
echo
read -r -p "Autoplay: " linenumber  # waiting fot user input

if [ "$linenumber" = 0 ]
  then
      :
  else

tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp > ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp 2>/dev/null
input="$HOME""/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp"

i=0
OLDIFS=$IFS
IFS=$'\n'

for line in $(cat "$input" 2>/dev/null)
 do
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> VIEW DOWNLOADS >>> AUTOPLAY" 
      echo
      echo " [PLAYING]>" "$line"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$line")  " Duration:" $(ffmpeg -i "$line" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      "$vnotify" "Videoinfox messsage: Playing . . ." "$line"
      $defplayer "${defplayargu[@]}" "$line" 2> /dev/null

i=$((i+1)) # line number of video that was playing on video end/user quit.
total="$vto" #  set intermission time in seconds
count=0  # counter
nextup=0  # line number of next video up

while [ ${count} -lt ${total} ] ; do
    nextup=$((i+1))
    tail -n +"$nextup" ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.tmp > ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.nextup.tmp 2>/dev/null
    read -r nextplay < ~/.config/videoinfox/tmp/videoinfo-view-downloads-autoplay.nextup.tmp
    tlimit=$(( $total - $count ))
    clear
    echo
    echo " Last:" "$line"
    echo
    echo " Next:" "$nextplay"    
    echo "___________________________________________________________________________________________________________________"  
    echo
    echo " $der >>> Intermission Timer"
    echo "___________________________________________________________________________________________________________________" 
    echo        
    echo " Anykey Enter - Play     Hold Enter - Speed Up Timer                                         Spacebar Enter - Quit"
    echo
    echo    
    echo -e "\r Next video starting in ${tlimit} seconds . . .\c"
    echo
    echo
    read -t 1 playoption 
    test ! -z "$playoption" && { break ; }
    count=$((count+1))
done

if [[ "$playoption" = " " ]] # if entry equals (spacebar enter) then break out of play loop
  then                      
  break
fi

done      

fi

IFS=$OLDIFS

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1
fi

fi

;;


              j)
##################################################################################################################################################
###########################   PLAY LINE  j   <VIEW DOWNLOADS>  ###################################################################################
##################################################################################################################################################

if [ "$istherefiles" = 0 ]
  then
      echo
      echo
      echo " No video files in the default download directory . . ."
      sleep .4

  else


if [ -f ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp ]  # if file exists goto then
  then
      clear
      cat ~/.config/videoinfox/tmp/videoinfo-number-view-downloads.tmp
      echo
      read -r -p "Play: " linenumber  # waiting fot user input

      # create file moving selected line number to the top
      tail -n +"$linenumber" ~/.config/videoinfox/tmp/videoinfo-view-downloads.tmp > ~/.config/videoinfox/tmp/videoinfo-view-downloads-playnumber.tmp 2>/dev/null
      
      # read first line of file for play
      read playnumber < ~/.config/videoinfox/tmp/videoinfo-view-downloads-playnumber.tmp

      if [ -z "$playnumber" ]
          then
              :

          else

if [ "$linenumber" = 0 ]
  then
      :
  else

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " ""$der"" >>> VIEW DOWNLOADS >>> PLAY" 
      echo
      echo " [PLAYING]>" "$playnumber"
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$playnumber")  " Duration:" $(ffmpeg -i "$playnumber" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height & duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will quit when the video player is quit . . ."
      echo
      
      # video filename with full path <$pasteclip> strip from the bgininning of line to the last slash leaving only the filename <$getfilenameonly>
      getfilenameonly=$(echo "$playnumber" |  awk -F '/' '{print $NF}')  
  
      "$vnotify" "Videoinfox messsage: Playing . . ." "$getfilenameonly"      

      echo "$playnumber" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      $defplayer "${defplayargu[@]}" "$playnumber" 2>/dev/null  # play video
      rm ~/.config/videoinfox/tmp/videoinfo-view-downloads-playnumber.tmp 2>/dev/null

     fi
fi

else
    echo
    echo
    echo " Select Show All or use Find to access this feature . . ."
    sleep 1

fi

fi

;;


                *)

                esac
                done  
                
              ;;


              s)  # DOWNLOAD VIDEO PLAY, THEN DELETE ON VIDEO PLAYER CLOSE 
              
              grabdir="$PWD"

              read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"   # change to download directory              

              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              
              grabpaste3=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

              if [ "$grabpaste3" = "http" ]  # if the 4 characters = <http> go then
                then
         
              clear
              ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip" -o "$dirsaved"/download.tmp  # downloading temporary video
              "$vnotify" "Videoinfox messsage: YT-DLP is done downloading . . ." "$pasteclip" 

              clear
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " ""$der"" >>> YT-DLP MENU >>> Play Video >>> Self Destruct"
              echo
              echo " [PLAYING]> ""$pasteclip"""
              echo "___________________________________________________________________________________________________________________"         
              echo
              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will quit when the video player is quit . . ."
              echo
              
              $defplayer "${defplayargu[@]}" "$dirsaved"/download.tmp* 2> /dev/null  # play temporary video
              rm "$dirsaved"/download.tmp*  # on player close, delete temporary video
              echo "" | xclip -sel clip  # clearing out the clipboard
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
             
              else 
                    echo
                    echo
                    echo " Clipboard is empty or contained invalid video url . . ."
                    sleep .7
              fi

              cd "$grabdir" # restore dir
              ;; 


              l) # LAST DOWNLOAD (YT-DLP MENU)
               
read -r ldcheck < ~/.config/videoinfox/videoinfo.lastdownload
if [ -z "$ldcheck" ]
  then
      echo
      echo
      echo " A video has to be downloaded first for this feature to work . . ."
      sleep 1
  else
              grabdir="$PWD"  # storing directory to restore on quit
               
              read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"   # change to download directory

                 if [ -s ~/.config/videoinfox/videoinfo.lastdownload ]
                    then
                        read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download attempt         
                        ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownload*" \))
                        echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file
                        read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file

                    else
                        read -r lastdownloadbak < ~/.config/videoinfox/videoinfo.lastdownload.bak  # reading last successful download
                        ylast=$(find "$PWD" -maxdepth 1 -type f \( -iname "$lastdownloadbak*" \))
                        echo "$ylast" > ~/.config/videoinfox/videoinfo.find-last-download  # write find result to file
                        read -r ytdlplast < ~/.config/videoinfox/videoinfo.find-last-download  # read first find result from file
                 fi   

          
              clear
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " ""$der"" >>> PLAY LAST DOWNLOAD"
              echo
              echo " [PLAYING]> ""$ytdlplast"""
              echo "___________________________________________________________________________________________________________________"         
              echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will quit when the video player is quit . . ."
         
              "$vnotify" "Videoinfox messsage: Playing last yt-dlp download . . ." "Play: $lastdownload"
                       
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to file

              $defplayer "${defplayargu[@]}" "$ytdlplast" 2> /dev/null
       
              ####              ffplay -fs -autoexit &> /dev/null "$ytdlplast"
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              cd "$grabdir"   # restore dir prior to entering yt-dlp menu
fi
              ;;  



              r)  # DOWNLOAD ONLY (DEFAULT)
              read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"  # change to download directory
 
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content              
#!!!
              grabpaste3=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

              if [ "$grabpaste3" = "http" ]  # if the 4 characters = <http> go then
                then
                  
              clear
      
              ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
              ~/.config/videoinfox/yt-dlp "${dlargue[@]}" "$pasteclip"     
      
              # remove first dot and everything after it in filename. file names with dots before the extension were breking find results
              sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

              # remove first [ and everything after it in filename. this was done because file names with [ 
              sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

              # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
              mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload
      
              read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download video file
              
              "$vnotify" "Videoinfox messsage: YT-DLP done downloading . . ." "$lastdownload"
              
              echo "" | xclip -sel clip  # clearing out the clipboard
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

              
                else 
                    echo
                    echo
                    echo " Clipboard is empty or contained invalid video url . . ."
                    sleep 1
              fi
              
              cd "$grabdir"
              ;;


              c)  # DOWNLOAD CHOOSE
              read -r dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"   # change to download directory

              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

              grabpaste3=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

              if [ "$grabpaste3" = "http" ]  # if the 4 characters = <http> go then
                then
              
              clear
              echo
              echo
              
              # <yt-dlp> gets the filename minus the extension. this is done becuase the user can pick different video file types to download.
              ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload
 
              # <yt-dlp> giving options for quality and file type to download
              ~/.config/videoinfox/yt-dlp -F "$pasteclip"
              
              echo
              echo
              echo "Find what video quality and format you want. (Code on far left)"
              read -r -p "Enter that Code and Press enter : " svrcode
              echo
              clear
              ~/.config/videoinfox/yt-dlp -f "$svrcode" "$pasteclip"

              # remove first dot and everything after it in filename. file names with dots before the extension were breking find results
              sed "s/\..*//" ~/.config/videoinfox/videoinfo.lastdownload > ~/.config/videoinfox/videoinfo.lastdownload.work

              # remove first [ and everything after it in filename. this was done because file names with [ 
              sed -i "s/\[.*//" ~/.config/videoinfox/videoinfo.lastdownload.work

              # rename videoinfo.lastdownload.work to videoinfox/videoinfo.lastdownload
              mv ~/.config/videoinfox/videoinfo.lastdownload.work ~/.config/videoinfox/videoinfo.lastdownload
              
              read -r lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download video file
              "$vnotify" "Videoinfox messsage: YT-DLP done downloading . . ." "$lastdownload"              
              
              echo "" | xclip -sel clip  # clearing out the clipboard
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              
              else 
                    echo
                    echo
                    echo " Clipboard is empty or contained invalid video url . . ."
                    sleep 1
              fi
              
              cd "$grabdir"
              ;; 

*)

 esac
 done

fi
;; 


##################################################################################################################################################
m)  # MORE OPTIONS   #############################################################################################################################
##################################################################################################################################################

function menu {

##################################################################################
##########  START   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################## 

# DIRECTORY SELECTED IS NORMAL TEXT AND THE OTHER 4 ARE LESS BOLD. 

# DEFAULT DIR NUMBER 1 FORMAT
dirdisplay1=$(echo -e "1\033[2m 2 3 4 5\033[0m")
# DEFAULT DIR NUMBER 2 FORMAT
dirdisplay2=$(echo -e "\033[2m1 \033[0m2 \033[2m3 4 5\033[0m") 
# DEFAULT DIR NUMBER 3 FORMAT
dirdisplay3=$(echo -e "\033[2m1 2 \033[0m3 \033[2m4 5\033[0m")
# DEFAULT DIR NUMBER 4 FORMAT
dirdisplay4=$(echo -e "\033[2m1 2 3 \033[0m4 \033[2m5\033[0m")
# DEFAULT DIR NUMBER 5 FORMAT
dirdisplay5=$(echo -e "\033[2m1 2 3 4 \033[0m5\033[0m")
# NO MATCH ALL LESS BOLD
dirdisplayno=$(echo -e "\033[2m1 2 3 4 5\033[0m")


# FORMAT PWD NAME FOR COMPARISON
echo "$PWD" > ~/.config/videoinfox/videoinfox.pwd.tmp  # write PWD to a tmp file: videoinfox.pwd.tmp
cat ~/.config/videoinfox/videoinfox.pwd.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.pwd  # remove all froward slashes / write file: videoinfox.pwd
rm  ~/.config/videoinfox/videoinfox.pwd.tmp  # remove tmp file: videoinfox.pwd.tmp
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.pwd  # remove horizontal whitespace write file: videoinfox.pwd

# FORMAT DEFAULT DIR 1 NAME FOR COMPARISON
echo "$dir1" > ~/.config/videoinfox/videoinfox.dir1.tmp  # write dir 1 to a tmp file: videoinfox.dir1.tmp
cat ~/.config/videoinfox/videoinfox.dir1.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir1  # remove all froward slashes / write file: videoinfox.dir1
rm ~/.config/videoinfox/videoinfox.dir1.tmp  # remove tmp file: videoinfox.dir1.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir1  # remove horizontal whitespace write file: videoinfox.dir1

# FORMAT DEFAULT DIR 2 NAME FOR COMPARISON
echo "$dir2" > ~/.config/videoinfox/videoinfox.dir2.tmp  # write dir 2 to a tmp file: videoinfox.dir2.tmp
cat ~/.config/videoinfox/videoinfox.dir2.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir2  # remove all froward slashes / write file: videoinfox.dir2
rm ~/.config/videoinfox/videoinfox.dir2.tmp   # remove tmp file: videoinfox.dir2.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir2 # remove horizontal whitespace write file: videoinfox.dir2

# FORMAT DEFAULT DIR 3 NAME FOR COMPARISON
echo "$dirsaved" > ~/.config/videoinfox/videoinfox.dir3.tmp  # write dir 3 to a tmp file: videoinfox.dir3.tmp
cat ~/.config/videoinfox/videoinfox.dir3.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir3  # remove all froward slashes / write file: videoinfox.dir3
rm ~/.config/videoinfox/videoinfox.dir3.tmp   # remove tmp file: videoinfox.dir3.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir3 # remove horizontal whitespace write file: videoinfox.dir3

# FORMAT DEFAULT DIR 4 NAME FOR COMPARISON
echo "$dir4" > ~/.config/videoinfox/videoinfox.dir4.tmp  # write dir 4 to a tmp file: videoinfox.dir4.tmp
cat ~/.config/videoinfox/videoinfox.dir4.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir4  # remove all froward slashes / write file: videoinfox.dir4
rm ~/.config/videoinfox/videoinfox.dir4.tmp   # remove tmp file: videoinfox.dir4.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir4 # remove horizontal whitespace write file: videoinfox.dir4

# FORMAT DEFAULT DIR 5 NAME FOR COMPARISON
echo "$dir5" > ~/.config/videoinfox/videoinfox.dir5.tmp  # write dir 5 to a tmp file: videoinfox.dir5.tmp
cat ~/.config/videoinfox/videoinfox.dir5.tmp | tr "/" " " > ~/.config/videoinfox/videoinfox.dir5  # remove all froward slashes / write file: videoinfox.dir5
rm ~/.config/videoinfox/videoinfox.dir5.tmp   # remove tmp file: videoinfox.dir5.tmp 
sed -i 's/[[:blank:]]//g' ~/.config/videoinfox/videoinfox.dir5 # remove horizontal whitespace write file: videoinfox.dir5


# LOAD EDITED PWD AND DEFAULT DIRECTORY NAMES FOR BELOW  IF LOOPS   (all frorward slashes / and white spaces removed from the below directory names)

read -r controldir < ~/.config/videoinfox/videoinfox.pwd    # load reformatted current directory name 
read -r dir1display < ~/.config/videoinfox/videoinfox.dir1  # load reformatted default directory 1 name
read -r dir2display < ~/.config/videoinfox/videoinfox.dir2  # load reformatted default directory 2 name
read -r dir3display < ~/.config/videoinfox/videoinfox.dir3  # load reformatted default directory 3 name
read -r dir4display < ~/.config/videoinfox/videoinfox.dir4  # load reformatted default directory 4 name
read -r dir5display < ~/.config/videoinfox/videoinfox.dir5  # load reformatted default directory 5 name


# DEFAULT DIR 5  DISPLAY     IF DIRECTORY ON EXIT  =  DEFAULT DIRECTORIES 1-4 then Display that directory number.

if [[ "$controldir" = "$dir5display" ]]
  then 

      if [[ "$dir5display" = "$dir1display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 1 then display 1 and not 5
        then
             dirdisp="$dirdisplay1"
      fi

      if [[ "$dir5display" = "$dir2display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 2 then display 2 and not 5
        then
             dirdisp="$dirdisplay2"
      fi

      if [[ "$dir5display" = "$dir3display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 3 then display 3 and not 5
        then
             dirdisp="$dirdisplay3"
      fi

      if [[ "$dir5display" = "$dir4display" ]]  # IF DIRECTORY ON EXIT = DEFAULT DIR 4 then display 4 and not 5
        then
             dirdisp="$dirdisplay4"
      fi
fi



# DEFAULT DIR 5 DISPLAY
if [[ "$controldir" = "$dir5display" ]] 
  then
       dirdisp="$dirdisplay5"  # if directory is changed to  Default Dir 5 :  The number 5 is normal text and the other 4 are less bold.
        
  else
       dirdisp="$dirdisplayno" # if directory doesn't match  Default Dirs 1-5 : All 5 numbers are less bold.  
fi 



# DEFAULT DIR 1  DISPLAY
if [[ "$controldir" = "$dir1display" ]]  # IF PWD = DEFAULT DIR 1 then display 1
  then 
       dirdisp="$dirdisplay1"
fi

# DEFAULT DIR 2  DISPLAY
if [[ "$controldir" = "$dir2display" ]]  # IF PWD = DEFAULT DIR 2 then display 2
  then 
       dirdisp="$dirdisplay2"
fi

# DEFAULT DIR 3  DISPLAY
if [[ "$controldir" = "$dir3display" ]]  # IF PWD = DEFAULT DIR 3 then display 3
  then 
       dirdisp="$dirdisplay3"
fi

# DEFAULT DIR 4  DISPLAY
if [[ "$controldir" = "$dir4display" ]]  # IF PWD = DEFAULT DIR 4 then display 4
  then 
       dirdisp="$dirdisplay4"  # if directory is changed to  Default Dir 4 :  The number 4 is normal text and the other 4 are less bold.
fi

################################################################################
##########  END   1 2 3 4 5 - DEFAULT DIRS   DISPLAY ROUTINE  ##################
################################################################################


clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"                                                                 #
echo "___________________________________________________________________________________________________________________"
echo
echo " $der >>> MORE OPTIONS                                                      "$dirdisp" - Default Dirs"
echo "___________________________________________________________________________________________________________________"
echo
echo " c - Change Directory     n - Video Count        v - Video Info                                           q - Quit"                     
echo " g - Find Directory       d - Video Duration"
echo " l - List Directory"
echo
echo -en " Enter Option: "
read -r -n1 option
}

  
while true
do
	menu
	case $option in


q)  # QUIT - <HOME> 
break ;;



1) # CD DIRECTORY TO TV    
cd "$dir1" 
;;

    
2)  # CD DIRECTORY TO MOVIES
cd "$dir2" 
;;


3)  # CHANGE DIRECTORY TO DOWNLOADS
cd "$dirsaved" 
;;


4)  # CHANGE DIRECTORY TO EXTRA   
cd "$dir4" 
;;


5)  # CHANGE DIRECTORY TO LAST EXIT
cd "$dir5" 
;;



l)  # LIST DIRECTORY
##################################################################################################################################################
###########################   MORE OPTIONS l  LIST DIRECTORY  ####################################################################################
##################################################################################################################################################

#   The Line below gives a total count of all mp4, mkv, avi, & divx in Current Directory.
currentdirfilecount=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)
	

if [ -f "videoinfo.List-Directory" ]  #  if file <videoinfo.List-Directory> exists goto <then>
  then
#     >>>>>>>>>>>>>>>>>>>>>>>>>> DISPLAY LAST DIRECTORY LISTING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 

      less videoinfo.List-Directory  # display in <less>
  
  else

#     >>>>>>>>>>>>>>>>>>>>>>>>>> CREATE NEW DIRECTORY LISTING FILE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   

# The group of echo's below write a header to file <videoinfo.List-Directory> 
# echo > videoinfo.List-Directory
echo "$ver                                                                                  LIST DIRECTORY" >> videoinfo.List-Directory
echo >> videoinfo.List-Directory
echo "This File was Created $(date) by" "$USER" >> videoinfo.List-Directory
echo >> videoinfo.List-Directory  # Every line ending in  ' >> videoinfo.List-Directory '  is writing that line to text file <videoinfo.List-Directory>)
echo "SAVED RESULTS LOADED FROM FILE: videoinfo.List-Directory" >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory
echo "Working Directory: ""$PWD" >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory 
echo "___________________________________________________________________________________________________________________" >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory 
echo " Up & Down Arrows or Mouse wheel - scroll                                                            Home - top" >> videoinfo.List-Directory
echo " q - quit                                                                                            End - bottom" >> videoinfo.List-Directory
echo "___________________________________________________________________________________________________________________" >> videoinfo.List-Directory       
echo >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory

# Display & Write <videoinfo.List-Directory>  The Results of:  - ffprobe for Codec & Resolution <$codecres>
#                                                              - ffmpeg for Duration in (hrs:min)
clear

for i in *.mp4  # list all <mp4> files in the current directory
do 
  echo "$i";  # display <mp4> filename
  echo "$i" >> videoinfo.List-Directory  
  $codecres "$i"  # display <mp4> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done

for i in *.mkv  # list all <mkv> files in the current directory
do 
  echo "$i"  # display <mkv> filename
  echo "$i" >> videoinfo.List-Directory
  $codecres "$i"  # display <mkv> Codec & Resolution$
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo
  echo >> videoinfo.List-Directory
  done

for i in *.avi  # list all <avi> files in the current directory
do 
  echo "$i"  # display <avi> filename
  echo "$i" >> videoinfo.List-Directory
  $codecres "$i"  # display <avi> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory  
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done


for i in *.webm  # list all <webm> files in the current directory
do 
  echo "$i"  # display <avi> filename
  echo "$i" >> videoinfo.List-Directory
  $codecres "$i"  # display <avi> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory  
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done


for i in *.divx  # list all <divx> files in the current directory
do 
  echo "$i"  # display <divx> filename
  echo "$i" >> videoinfo.List-Directory
  $codecres "$i"  # display <divx> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done


for i in *.3gp  # list all <3gp> files in the current directory
do 
  echo "$i"  # display <3gp> filename
  echo "$i" >> videoinfo.List-Directory
  $codecres "$i"  # display <3gp> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done

	
# echo >> videoinfo.List-Directory
echo "Total Video Files:" "$currentdirfilecount"
echo >> videoinfo.List-Directory
echo "Total Video Files:" "$currentdirfilecount" >> videoinfo.List-Directory
echo
echo
echo >> videoinfo.List-Directory
echo ">>> Listing is not recursive <<<"
echo ">>> Listing is not recursive <<<" >> videoinfo.List-Directory
echo
echo >> videoinfo.List-Directory
echo "Working Directory: ""$PWD"  # <pwd>  print current working directory to the screen   
echo "Working Directory: ""$PWD" >> videoinfo.List-Directory
echo


if [ "$currentdirfilecount" = 0 ]  # if find returned no results goto <then>
  then
      :  # the colon can be used in place of a command to 'Do Nothing'
  else 
      echo "$rer"
      echo
      echo -e "\033[5mProbing $currentdirfilecount \033[5mVideo Files for Duration\033[0m"  #  file count of find results
      echo
      echo "This can take a while if there are a lot of video files to process."
      echo "You will get a GUI Notification when this process is complete."
      echo
     
      #  This is where the file <~/.config/videoinfox/videoinfo.duration.tmp> is created to store duration in seconds with the format being  (x.xxxxxx)
      #  Video files are found in current directory and processed with ffprobe and written to <~/.config/videoinfox/videoinfo.duration.tmp>. 
find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \; > ~/.config/videoinfox/videoinfo.duration.tmp 2>/dev/null

      #  ffprobe outputs video duration in seconds 6 places past the decimal point.
      #  bash can't do floating point math.  So  <bc>  is needed first to get sum of   <~/.config/videoinfox/videoinfo.duration.tmp>
      #  The  <paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp>  puts a +  between each line of the file and  <bc>  gives you the sum. 
      floatingseconds=$(paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp | bc)
         
      #  The total in seconds <$floatingseconds> is taken from line above and the format needs changed from  (x.xxxxxx) to (x)
      #  Below, <awk> is stripping 7 characters in from the right of the sum of  <$floatingseconds>
      #  In this case, the decimal point and the 6 trailing numbers are stripped from the string.
      totalseconds=$(echo "$floatingseconds" | awk '{ print substr( $0, 1, length($0)-7 ) }')
        
      #  Calculation of  <$totalseconds>  into different formats.
      secs=$(echo "$totalseconds")  # $totalseconds variable stored in $secs variable
      totalminutes=$(($(($totalseconds/60))))  # total minutes calculation

      echo >> videoinfo.List-Directory
      echo >> videoinfo.List-Directory
      echo "Seconds"
      echo "Seconds" >> videoinfo.List-Directory
      echo "$totalseconds"  # display total seconds
      echo "$totalseconds" >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory 
      echo "Minutes"
      echo "Minutes" >> videoinfo.List-Directory
      echo "$totalminutes"  # display total minutes
      echo "$totalminutes" >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo "Hrs:Mi:Sec"
      echo "Hrs:Mi:Sec" >> videoinfo.List-Directory
      printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60))  # calculation to display hours, minutes and seconds
      printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60)) >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo "Days     Hrs:Min:Sec"
      echo "Days     Hrs:Min:Sec" >> videoinfo.List-Directory
      printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60))  # same as above except Days are added
      printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo -e "\033[5mNEW RESULTS LOADED \033[5m \033[0m(use Mouse Wheel to Scroll)"
      echo "EXISTING RESULTS LOADED FROM FILE videoinfo.List-Directory " $(stat -c %y "videoinfo.List-Directory") >> videoinfo.List-Directory
      echo >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      "$vnotify" "Videoinfox is done processing: List Directory" "$PWD"  # GUI Notification is displayed when this function <option 1> has completed.
      # The file  <~/.config/videoinfox/videoinfo.duration.tmp>  was created for <ffprobe> to store video duration in seconds of all find results.
      # The math was already performed on this file and it is no longer needed.  So it is being removed.  
      rm ~/.config/videoinfox/videoinfo.duration.tmp
   fi
fi


# every time You Save.  The File <videoinfo.List-Directory> is saved to the directory that option 1 was run in.
function menu1 {

clear
less videoinfo.List-Directory  # view results from file
echo
echo " Directory: ""$PWD"
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$der"" >>> LIST DIRECTORY"                                                  
echo "___________________________________________________________________________________________________________________"
echo
echo " Save or Delete Directory Listing"
echo
echo " s - Save     d - Delete"  
echo 
echo -en " Enter Option: "
read -r -n1 option1
echo
}

while true
do
	menu1
	case $option1 in
	
    s) 
    echo
    echo " Results SAVED . . ."
    echo 
    #read -p "Press enter to continue . . ."
    sleep .4
    break;; 
        
    d) 
    rm videoinfo.List-Directory
    echo
    echo " Results DELETED . . ."
    echo 
    #read -p "Press enter to continue . . ."    
    sleep .4
    break;;
      
        *)
    
        esac
        done
        ;;


c)
##################################################################################################################################################
###########################   MORE OPTIONS c  CHANGE DIRECTORY  ##################################################################################
##################################################################################################################################################
 
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo
echo " $ver >>> CHANGE DIRECTORY"
echo "___________________________________________________________________________________________________________________"
echo
echo " No quotations needed for paths with spaces. Case sensative."
echo 
read -r -p " Enter Directory: " specifydir  # waiting fot user input - the directory you want to chang to 
	
	if [ -z "$specifydir" ]  # if no input was entered goto  <then> 
          then
               echo
               echo " Nothing was entered . . ."
               sleep .4
          else
              if [ -d "$specifydir" ]  #  if directoty exists goto  <then>
                then
                     echo
                     cd "$specifydir"   # change the directory
                     echo " Working Driectory changed to: $PWD"  # <pwd>  print current working directory to the screen
                     sleep .7                   
                else
                     echo
                     echo " No such file or directory . . ."
                     sleep .4                   
          fi
    fi       
echo
#read -p "     Press enter to continue . . ." 
;;
	

g)	 
##################################################################################################################################################
###########################   MORE OPTIONS f  FIND DIRECTORY  ####################################################################################
##################################################################################################################################################

clear
echo
echo "Directory: ""$PWD"
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$ver"" >>> FIND DIRECTORY                 Enter only to quit                             * - Show All"
echo "___________________________________________________________________________________________________________________" 
echo
echo " The directory enterd must be recursively reachable from the current directory."
echo
read -r -p " Directory Name: " dirfind  # waiting fot user input - dierectory that you want to find
linecount=$(find . -type d -iname "$dirfind" 2>/dev/null | wc -l)   # number of files found
                                                                                    	
if [ -z "$dirfind" ]  # if no input was entered goto  <then>  
then
echo
echo " Nothing was entered . . ."  
sleep .4
else               
     if echo "$dirfind" | grep "/" > /dev/null # if any slashes were entered goto <then>
     then
     echo
     echo " No slashes. Directory name only."
     sleep .4  
     else
     echo
     find . -type d -iname "$dirfind" | sort -u > ~/.config/videoinfox/tmp/finthedir.tmp 2>/dev/null  # directory(s) found

     # CREATE NUMBERED lIST
sed '/./=' ~/.config/videoinfox/tmp/finthedir.tmp | sed '/./N; s/\n/ /' > ~/.config/videoinfox/tmp/finthedir.numberlist.tmp 2>/dev/null
   
     cat ~/.config/videoinfox/tmp/finthedir.numberlist.tmp
     echo
     echo "Total Directories Found:" "$linecount"  # number of files found
     sleep .4        
	    if [ "$linecount" = 0 ]  # if find returned no results goto <then>
	    then
              :
	    else
              echo
read -r -p "Enter number to change directory: " linenumber  # waiting fot user input
              if ! [[ "$linenumber" -eq "$linenumber" ]] 2> /dev/null
              then
              :
              else
              if [[ $linenumber -gt $linecount ]]
              then 
              echo
              echo " Number out of range . . ."
              sleep .4
              else
tail -n +"$linenumber" ~/.config/videoinfox/tmp/finthedir.tmp > ~/.config/videoinfox/tmp/finthedir.tmp2 2>/dev/null
              OLDIFS=$IFS
              IFS=$'\n'
              read line < ~/.config/videoinfox/tmp/finthedir.tmp2
              cd "$line" 2> /dev/null
              IFS=$OLDIFS
fi
fi
fi
fi
fi              
;;


n)
##################################################################################################################################################
###########################   MORE OPTIONS  4  VIDEO COUNT  ######################################################################################
##################################################################################################################################################


clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> VIDEO COUNT - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo " RECURSIVE COUNT OF VIDEO FILES"
echo
mp4count=$(find . -type f \( -iname "*.mp4" \) 2>/dev/null | wc -l)  # total number of <mp4> files found
echo " MP4   = " "$mp4count"
mkvcount=$(find . -type f \( -iname "*.mkv" \) 2>/dev/null | wc -l)  # total number of <mkv> files found
echo " MKV   = " "$mkvcount"
avicount=$(find . -type f \( -iname "*.avi" \) 2>/dev/null | wc -l)  # total number of <avi> files found
echo " AVI   = " "$avicount"
webmcount=$(find . -type f \( -iname "*.webm" \) 2>/dev/null | wc -l) # total number of <webm files found
echo " WEBM  = " "$webmcount"
divxcount=$(find . -type f \( -iname "*.divx" \) 2>/dev/null | wc -l) # total number of <divx> files found
echo " DIVX  = " "$divxcount"
g3pcount=$(find . -type f \( -iname "*.3gp" \) 2>/dev/null | wc -l) # total number of <divx> files found
echo " 3GP   = " "$g3pcount"
echo "------------------"
totalcount=$(($mp4count + $mkvcount + $avicount + $webmcount + $divxcount + $g3pcount))  # calcutation for Sum of All 4 file types
echo " TOTAL = " $totalcount  # display Sum
# GUI Notification is displayed when this function <option 6> has completed. 
"$vnotify" "Videoinfox is done processing Video File Count " "Total Video Files located in $PWD : $totalcount"
echo
read -r -p " Press enter to continue . . ." 
;;
	

d)
##################################################################################################################################################
###########################  MORE OPTIONS  d  VIDEO DURATION  ####################################################################################
##################################################################################################################################################

if [ -f "videoinfo.Video-Duration" ]  #  if <videoinfo.Video-Durationy> exists goto <then>
  then
#     >>>>>>>>>>>>>>>>>>>>>>>>>> DISPLAY Saved RESULTS >>>>>>>>>>>>>>>>>>>>>>>>>> 
      cat videoinfo.Video-Duration
  else
#     >>>>>>>>>>>>>>>>>>>>>>>>>> CREATE NEW RESULTS >>>>>>>>>>>>>>>>>>>>>>>>>>
#   The Line below gives a total count of all mp4, mkv, avi, & divx Recursively.
alldirfilecount=$(find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -name "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) 2>/dev/null | wc -l)

#  The group of echo's below write a header to file <videoinfo.Video-Duration> 
echo > videoinfo.Video-Duration
echo "$ver                                                                                              VIDEO DURATION" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
echo "This File was Created $(date) by" "$USER" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration  # Every line ending in  ' >> videoinfo.Video-Duration '  is writing that line to text file <videoinfo.Video-Duration>

#  The rest of this function Writes the Results to the Screen and File <videoinfo.Video-Duration>
clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"  
echo
echo " ""$der"" >>> VIDEO DURATION - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo "Working Directory: ""$PWD" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
echo "RECURSIVE DURATION OF VIDEO FILES"
echo "RECURSIVE DURATION OF $alldirfilecount VIDEO FILES" >> videoinfo.Video-Duration
echo
echo "This can take a while if there are a lot of video files to process."
echo "You will get a GUI Notification when this process is complete."
echo
echo -e "\033[5mProbing $alldirfilecount \033[5mVideo Files for Duration\033[0m"  #  file count of find results
echo -e "\n"
echo >> videoinfo.Video-Duration


#  This is where the file <~/.config/videoinfox/videoinfo.duration.tmp> is created to store duration in seconds with the format being  (x.xxxxxx)
#  Video files are found recursively and processed with ffprobe and written to <~/.config/videoinfox/videoinfo.duration.tmp>. 
find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" -o -iname "*.3gp" \) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \; > ~/.config/videoinfox/videoinfo.duration.tmp 2>/dev/null


#  ffprobe outputs video duration in seconds 6 places past the decimal point.
#  bash can't do floating point math.  So  <bc>  is needed first to get sum of  <~/.config/videoinfox/videoinfo.duration.tmp>
#  The  <paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp>  puts a +  between each line of the file and  <bc>  gives you the sum. 
floatingseconds=$(paste -sd+  ~/.config/videoinfox/videoinfo.duration.tmp | bc)


#  The total in seconds is taken from line above and the format needs changed from  (x.xxxxxx) to (x)
#  Below, <awk> is stripping 7 characters in from the right of the sum of  <$floatingseconds>
#  In this case, the decimal point and the 6 trailing numbers are stripped from the string.
totalseconds=$(echo "$floatingseconds" | awk '{ print substr( $0, 1, length($0)-7 ) }')

clear
echo "Working Directory: ""$PWD"  # <pwd>  print current working directory to the screen 
echo
echo "$der"
echo
echo "RECURSIVE DURATION OF VIDEO FILES"
echo
echo "DONE Probing ""$alldirfilecount"" Video Files for Duration"  #  file count of find results
echo
#  Calculation of  <$totalseconds>  into different formats.
secs=$(echo "$totalseconds")
totalminutes=$(($(($totalseconds/60))))  # convert seconds into minutes

echo "Seconds"
echo "Seconds" >> videoinfo.Video-Duration
echo "$totalseconds"  # display total seconds
echo "$totalseconds" >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Minutes"
echo "Minutes" >> videoinfo.Video-Duration
echo $totalminutes  # display total minutes
echo $totalminutes >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Hrs:Mi:Sec"
echo "Hrs:Mi:Sec" >> videoinfo.Video-Duration
printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60))  # calculation to display hours, minutes and seconds
printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60)) >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Days     Hrs:Min:Sec" 
echo "Days     Hrs:Min:Sec" >> videoinfo.Video-Duration
printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) # same as above + Days
printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo
echo -e "\033[5mNEW RESULTS LOADED \033[5m \033[0m"
echo "SAVED RESULTS LOADED FROM FILE: videoinfo.Video-Duration" $(stat -c %y "videoinfo.Video-Duration") >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
#echo
#echo "     q  to quit" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
"$vnotify" "Videoinfox is done processing: Video Duration" "$PWD"  # GUI Notification is displayed when this function has completed.
# The file  <~/.config/videoinfox/videoinfo.duration.tmp>  was created for <ffprobe> to store video duration in seconds of all find results.
# The math was already performed on this file and it is no longer needed.  So it is being removed.  
#rm ~/.config/videoinfox/videoinfo.duration.tmp
fi


function menu5 {
clear
cat videoinfo.Video-Duration
echo
echo "___________________________________________________________________________________________________________________" 
echo
echo " ""$der"" >>> VIDEO DURATION - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo " s - Save     d - Delete"  
echo 
echo -en " Enter Option: "
read -r -n1 option5
echo
}

while true
do
	menu5
	case $option5 in
	
    s) 
    echo
    echo " Results SAVED . . ."
    echo 
    #read -p "Press enter to continue . . ."
    sleep .4
    break;; 
        
    d) 
    rm videoinfo.Video-Duration
    echo
    echo " Results DELETED . . ."
    echo 
    #read -p "Press enter to continue . . ."    
    sleep .4
    break;;

         *)

         esac
         done
         ;;


v)
##################################################################################################################################################
###########################   MORE OPTIONS v  ENTER VIDEO FILE  ##################################################################################
##################################################################################################################################################

clear
echo
echo "Directory: ""$PWD"
echo "Clipboard: ""$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo
echo " ""$ver"" >>> ENTER VIDEO FILE - For Info"
echo "___________________________________________________________________________________________________________________"
echo
echo " Full path needed. No quotations needed for paths or files with spaces. Case Sensative."
echo
read -r -p " Video File: " specifyfile  # waiting fot user input - video file to display
echo

        if [ -z "$specifyfile" ]  # if no input was entered goto  <then>
          then
              echo " Nothing was entered . . ."
              sleep .4
          else  
               if [ -f "$specifyfile" ]  # if file exists goto  <then>
                then
                       echo "$specifyfile"  | xclip -sel clip  # copy valid file to the cilpboard for play
                       pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                       
echo " Video Info: "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip") "Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
                       echo
                       echo " Filename copied to clipboard for play"
                       echo
                       read -r -p " Press enter to continue . . ." 
                else
                       echo " error: No such file or directory"
                       sleep .4
          fi	  
          fi

    echo
    ;;


    esac
    done
    ;;


esac    
done

##################################################################################################################################################
###########################  END MAIN LOOP  ######################################################################################################
##################################################################################################################################################


#  EXIT MESSAGE
rm ~/.config/videoinfox/tmp/* 2>/dev/null

clear
echo -e "\n"
echo
echo "___________________________________________________________________________________________________________________"
echo  
echo " ""$ver"" >>> EXIT"
echo "___________________________________________________________________________________________________________________" 
echo -e "\n"


# Error: target STRING not available is an xclip error


#   FYI :

#   The Line Below performs a Recursive Search and outputs ffprobe's Duration of every find in seconds format (x.xxxxxx).
#   find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname ".avi" -o -iname "*.webm -o -iname "*.divx"\) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \;

#   The Line Below performs a Recursive Search and outputs Video File Count.
#   find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm -o -iname "*.divx" \) | wc -l

#   The Line Below gets the Codec & Resolution from a video file.
#   NOTE : Do NOT include  <  >   around the filename. 
#   ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 <filename>

#   The Line Below gets the Duration from video file and dsiplays in  <Days:Hours:Minutes:Seconds>
#   NOTE :  Save Double Quotes around the filename. 
#   ffmpeg -i "filename" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//
#
