#!/bin/bash

#  file : videoinfox v1.99									         
#  github and reddit: powerhousepro69
#  GNU General Public License v2.0

# This is where Videoinfo's Version Number is set.
ver="Videoinfo x v1.99"
der=$(echo -e "Videoinfo x v1\033[5m.\033m\033[0m\033[5m\033[5m\033[0m99")  # Version Number witth blinking dot


##################################################################################################################################################
#   DEPENDENCIES REQUIRED:
################################################################################################################################################## 

# - xclip needed for autopaste feature.  xclip only works with Xsession
  
# - ffmpeg is used to extrat Duration in <hrs:min:sec> format
# - ffprobe is used to extract Codec, Resolution and Duration in floating seconds format (x.xxxxxx)
# - ffplay is used to play the video that is in the clipboard.                                        
  
# - bc (already installed on most disrtros)  needed to do floating point math.
  
# - notify-send (already installed on most disrtros) needed to display gui notifications.

 
#  Videoinfo runs a dependency check at startup. If any dependencies are Not Found, the script will exit. 
#  Videoinfo will display which dependencies are missing.


##################################################################################################################################################
#              THIS SCRPT HAS BEEN HEAVILY COMMENTED FOR ANYONE INTERESTED IN HOW IT WORKS AND TO MAKE IT EASIER TO EDIT THE CODE.
##################################################################################################################################################


#  -v FOR VERSION NUMBER  Show version number then exit
if [ "$1" = "-v" ]
  then
      echo "$ver"
      exit
  else
      :
fi


#  The below 3 CHECKS run once at startup then into the HOME loop.
#  1. Dependency Check   2. Start From Root Check   3. DIRECTORY CHECK & FILE CREATION

##################################################################################################################################################
#############################  DEPENDENCY CHECK  ################################################################################################# 
##################################################################################################################################################

clear
echo
echo "___________________________________________________________________________________________________________________"
echo  
echo " $ver >>> DEPENDENCY CHECK"
echo "___________________________________________________________________________________________________________________"
echo "___________________________________________________________________________________________________________________"
echo
echo " If a dependency isn't Found:  App isn't installed Or app is installed and not in the path."
echo
echo

####### Check for <notify-send> ########
if ! command -v notify-send &> /dev/null  # if <notify-send> isnt found goto then
then
    echo " notify-send .......... Not Found"
    echo
    d1=1  # Not Found = 1
else
    echo " notify-send .......... Found"
    echo
    d1=0  # Found = 0
fi

####### Check for <bc> ########
if ! command -v bc &> /dev/null  # if <bc> isnt found goto then
then
    echo " bc ................... Not Found"
    echo
    d2=1  # Not Found = 1
else
    echo " bc ................... Found"
    echo
    d2=0  # Found = 0
fi

####### Check for <ffmpeg> ########
if ! command -v ffmpeg &> /dev/null  # if <ffmpeg> isnt found goto then
then
    echo " ffmpeg ............... Not Found"
    echo
    d3=1  # Not Found = 1
else
    echo " ffmpeg ............... Found"
    echo
    d3=0  # Found = 0
fi

####### Check for <ffprobe> ########
if ! command -v ffprobe &> /dev/null  # if <ffprobe> isnt found goto then
then
    echo " ffprobe .............. Not Found"
    echo
    d4=1  # Not Found = 1
else
    echo " ffprobe .............. Found"
    echo
    d4=0  # Found = 0
fi

####### Check for <ffplay> ########
if ! command -v ffplay &> /dev/null  # if <ffplay> isnt found goto then
then
    echo " ffplay ............... Not Found"
    echo
    d5=1  # Not Found = 1
else
    echo " ffplay ............... Found"
    echo
    d5=0  # Found = 0
fi

####### Check for <xclip> ########
if ! command -v xclip &> /dev/null  # if <xclip> isnt found goto then
then
    echo " xclip ................ Not Found"
    echo
    d6=1  # Not Found = 1
else
    echo " xclip ................ Found"
    echo
    d6=0  # Found = 0
fi

##########  Each Dependency:   Found = 0   Not Found = 1  ##########################
#
#   All dependency results are added:  - All dependencies Found = 0
#                                      - One or more dependencies Not Found = Not 0 
####################################################################################
depcount=$(($d1 + $d2 + $d3 + +d4 + $d5 + $d6))


if [ $depcount == 0 ]  # if all dependencies = 0 (All Found) goto then
  then
      echo
      echo " All dependencies are satisfied."  # sript runs
      echo -e "\n"
  else
      echo
      echo -e " One or more dependencies: \033[5mNot Found\033[5m\033[0m"  # script exits
      echo
      echo " When all dependencies are Found, the script will run."
      echo
      echo "=================================================================================================================="  
      echo " $der >>> EXIT"
      echo "==================================================================================================================" 
      echo -e "\n"
      exit
fi


##################################################################################################################################################
###########################  START FROM ROOT CHECK  ############################################################################################## 
##################################################################################################################################################

whatdir=$PWD  #  current working directory
thisdir="/" #  root directory

if [ $whatdir == $thisdir ]  # If the directory the script was run from: / <root> goto then 
  then
      clear
      echo
      echo "=================================================================================================================="  
      echo " $ver >>> Videoinfo x was started in root"
      echo
      echo " Working Directory: "$PWD
      echo "==================================================================================================================" 
      echo      
      cd $HOME
      echo " This script was started in root. Videoinfo will throw ERRORS when run from ROOT"
      echo
      echo " This Script's Working Directory Was Changed to: $PWD"
      echo
      echo " Change to a Parent Directory of your Video Library"
      echo

      # Timeout was disabled because there was no point in seeing this display.  I ended up just neeeding the <cd> execution from the loop.
      
      #sec=3
           #while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
           #echo -ne "     Message Expiring in: $sec\033[0K\r"
           #let "sec=sec-1"
           #sleep 1
           #done              
fi


##################################################################################################################################################
###########################  DIRECTORY CHECK & FILE CREATION ##################################################################################### 
##################################################################################################################################################

# The below check: Does the directory <~/.config/videoinfox> exist ?
# If it doesn't exist, directory is created. Empty files are created to avoid error when running Videoinfo for the first time.

direxist="$HOME/.config/videoinfox"

if [ -d "$direxist" ]  #  if directoty exists goto  <then>
  then
      :  # start main loop
  else
      
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo  
      echo " $ver >>> FIRST RUN - Setup"
      echo
      echo " Directory and file creation"
      echo "___________________________________________________________________________________________________________________"
      echo "___________________________________________________________________________________________________________________"
      echo        
      echo " cd $HOME/.config/videoinfox"        
      echo
      echo " error: No such file or directory"
      echo   
      echo " Created config directory: $HOME/.config/videoinfox  and required files "
      echo
      echo "__________________________________________________________________________________________________________________"
      echo
      echo " NOTE: Do not randomly paste in Videoinfox or ctrl-c the script.  It will cause unwanted code to run producing"  
      echo " undesired results and can corrupt Videoinfox's data integrity and retention."
      echo
      echo " Everywhere the dot is blinking in the version number, don't paste and Videoinfo x should function as intended."
      echo
      echo " "$der
      echo "__________________________________________________________________________________________________________________"
      echo
      echo " ytdlp will be downloaded to: $HOME/.config/videoinfox"
      echo "__________________________________________________________________________________________________________________"
      echo -e "\n" 
      echo " Setup for the first run or if the videoinfox directory gets deleted anytime after the first run."
      echo
  
 
      ###################
      # CREATE DIRECTORY
      ###################
      mkdir ~/.config/videoinfox
      
      ###############
      # CREATE FILES
      ###############
      
      # CREATE FIND RESULT MESSAGE THAT THERE ARE NO STORED FINDS
echo "                                                                                                                 " > ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "There are no stored find results. A find needs to be run to populate this screen with files.                     " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
      
      # SET DEFAULT yt-dlp DOWNLOAD DIRECTORY. It can be changed in the <yt-dlp> menu
      echo $HOME/Downloads > ~/.config/videoinfox/videoinfox.yt-download-dir
            
      # CREATING EMPTY FILES SO NO ERRORS ARE PRODUCED ON FIRST RUN
      echo > ~/.config/videoinfox/videoinfox.findwork2
      echo > ~/.config/videoinfox/videoinfox.findwork3
      echo > ~/.config/videoinfox/videoinfox.lastfindtime    
      echo > ~/.config/videoinfox/videoinfox.lastsearchtotal
      echo > ~/.config/videoinfox/videoinfox.lastsearchtotal2
      echo > ~/.config/videoinfox/videoinfox.playedlist
      echo > ~/.config/videoinfox/videoinfox.keptsearch
      echo > ~/.config/videoinfox/videoinfox.dir-at-exit
      echo > ~/.config/videoinfox/videoinfox.tv-dir
      echo > ~/.config/videoinfox/videoinfox.movies-dir
      echo > ~/.config/videoinfox/videoinfox.parent-dir
      echo > ~/.config/videoinfox/videoinfox.lastdownload
      echo > ~/.config/videoinfox/videoinfo.lastfindstring
      echo > ~/.config/videoinfox/videoinfo.lastfinddir
      echo > ~/.config/videoinfox/videoinfo.lastsearchtotal



      echo " " | xclip -sel clip  # clearing clipboard just for the first run   
   
      echo

           sec=30
           while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
                                
                echo -ne " $ver starting in: $sec\033[0K\r"
                let "sec=sec-1"
                sleep 1
              
           done                  

wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O ~/.config/videoinfox/yt-dlp-fetched >/dev/null  # download <yt-dlp> from github
chmod a+rx ~/.config/videoinfox/yt-dlp-fetched  # set <yt-dlp-fetched> execute bit
cp ~/.config/videoinfox/yt-dlp-fetched ~/.config/videoinfox/yt-dlp
~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version


fi


#xmodmap -e 'keycode 55=v' #  on  --- remove me 
#xmodmap -e 'keycode 55='  #  off --- remove me


##################################################################################################################################################
###########################  CRREATE HELP FILE  ################################################################################################## 
##################################################################################################################################################

echo > ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo  >> ~/.config/videoinfox/videoinfo.help
echo " $ver >>> HELP" >> ~/.config/videoinfox/videoinfo.help
echo  >> ~/.config/videoinfox/videoinfo.help
echo " Up & Down Arrows or Mouse wheel - scroll                                                             Home - top" >> ~/.config/videoinfox/videoinfo.help
echo " q - quit                                                                                             End - bottom" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Find videos to play or get info on: Change to a parent directory of your video library. Select find then" >> ~/.config/videoinfox/videoinfo.help
echo " find again.  Search for  *  That will show all video files under that directory" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Everywhere you see  Clipboard:  you can press enter to update the display of whats in the clipboard." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Whatever directory Videoinfox is in on exit, will be restored on next start." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Get codec, resolution and duration of videos one directory deep.  Recursive file count. Added and shown by type." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Yt-dlp integration to make downloading and watching videos fast and easy." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Settings Menu <set> to set default directories.  Also, update Videoinfox and Yt-dlp" >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " NOTE: Do not randomly paste in Videoinfox. It will cause unwanted code to run producing undesired results." >> ~/.config/videoinfox/videoinfo.help         
echo " Everywhere the dot is blinking in the version number, don't paste and Videoinfo x will function as intended." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Ctrl-c and randomly pasting can both cause improper Videoinfox file writes." >> ~/.config/videoinfox/videoinfo.help
echo " To maintain data integrity and retention, don't  Ctrl-c or randomly past"
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Every video played is autosaved to a played list." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Any duplicates added to the playlist or the played list will be autoremoved." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " The add playlist screen is generated from the find results.  From the playlist screen, Select <a>" >> ~/.config/videoinfox/videoinfo.help
echo " to get the find results to add videos to to the playlist.  Highlight whatever you want to add to the playlist." >> ~/.config/videoinfox/videoinfo.help
echo " Copy what you highlight(s) to the clipboard and select <a> to add your slection(s) from the clipboard."  >>~/.config/videoinfox/videoinfo.help      
echo " Make sure you grab the whole line including the comma.  Rinse and repeat until done." >>~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " This is my first big shell script.  It all started with 4 lines to get video codec, resolution and duration." >> ~/.config/videoinfox/videoinfo.help
echo " Then I thought, it would be cool if I added a find feature.  Next it was, I wanted to be able to store the find" >> ~/.config/videoinfox/videoinfo.help
echo " results for instant access at a later date.  Everytime I completed a new feature, it was onto the next feature." >> ~/.config/videoinfox/videoinfo.help
echo " It was a run away train.  As it grew with features, it eventually became a passion to produce a relevant script" >> ~/.config/videoinfox/videoinfo.help
echo " that would find videos, play and get info on those videos.  Download videos (download feature thanks to YT-DLP)" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Videoinfox Features:" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " - Navigation was designed to be robust and efficient. One keypress for all menu selections." >> ~/.config/videoinfox/videoinfo.help
echo " - Copy a filename to the clipboard and press <p> to play." >> ~/.config/videoinfox/videoinfo.help
echo " - Play clipboard: <HOME> <PLAYLIST> <PLAYED LIST> <FIND> <YT-DLP>" >> ~/.config/videoinfox/videoinfo.help
echo " - File types searched for:   .webm  .mp4  .mkv  .avi  .divx" >> ~/.config/videoinfox/videoinfo.help
echo " - Play videos and get video info from every screen that has a play feature." >> ~/.config/videoinfox/videoinfo.help
echo " - Keep track of everything played <PLAYED LIST>" >> ~/.config/videoinfox/videoinfo.help
echo " - Save a list of videos from find result(s) <PLAYLIST>" >> ~/.config/videoinfox/videoinfo.help
echo " - Remove duplicates from the playlist and played video." >> ~/.config/videoinfox/videoinfo.help
echo " - Press  <enter>  anywhere you see  <Clipboard:>  to update display." >> ~/.config/videoinfox/videoinfo.help
echo " - Enter a file with full path to play and get info. <Enter Video File>" >> ~/.config/videoinfox/videoinfo.help
echo " - Auto save last find result(s) and autoload until deleted." >> ~/.config/videoinfox/videoinfo.help
echo " - Yt-dlp integration for easy download and play." >> ~/.config/videoinfox/videoinfo.help
echo " - Download video and autoplay <HOME>"  >> ~/.config/videoinfox/videoinfo.help
echo " - Download video and play later. <YT-DLP>" >> ~/.config/videoinfox/videoinfo.help
echo " - When download has completed, auto play, delete when the player is closed. <YT-DLP>" >> ~/.config/videoinfox/videoinfo.help
echo " - Play last download <YT-DLP>" >> ~/.config/videoinfox/videoinfo.help
echo " - Pick type and quality of video before download. <YT-DLP>"  >> ~/.config/videoinfox/videoinfo.help
echo " - Download and update Videoinfox. <SET>" >> ~/.config/videoinfox/videoinfo.help
echo " - Download and update Yt-dlp. <SET>" >> ~/.config/videoinfox/videoinfo.help
echo " - Rapid directory changing by setting default directories. <SET>" >> ~/.config/videoinfox/videoinfo.help
echo " - Change fefault directories in <set> and <find>"
echo " - Save directory state on exit to load on next run." >> ~/.config/videoinfox/videoinfo.help
echo " - Change directory by entering full path. <CHANGE DIRECTORY>" >> ~/.config/videoinfox/videoinfo.help
echo " - Find directory and change to it by copying it to clipboard. <FIND DIRECTORY>" >> ~/.config/videoinfox/videoinfo.help
echo " - List video info one directory deep. Save per directory. <LIST DIRECTORY>" >> ~/.config/videoinfox/videoinfo.help
echo " - Recursive count of videos broken down by video type. <VIDEO COUNT>" >> ~/.config/videoinfox/videoinfo.help
echo " - Recursive duration (days:hrs:min:sec) Save per directory. <VIDEO DURATION>" >> ~/.config/videoinfox/videoinfo.help
echo " - GUI notifications." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " If you encounter any issues, let me know." >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " Thank You for taking the time to try out my shell script.  :-)  Any feedback is appreciated." >> ~/.config/videoinfox/videoinfo.help >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " powerhousepro69 @ Github and Reddit   " >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
echo " If videoinfox is removed, the dircetory  ~/.config/videoinfox  will have to be manually deleted." >> ~/.config/videoinfox/videoinfo.help
echo "___________________________________________________________________________________________________________________" >> ~/.config/videoinfox/videoinfo.help
echo >> ~/.config/videoinfox/videoinfo.help
# help file creation completed

read diratexit < ~/.config/videoinfox/videoinfo.dir-at-exit
cd "$diratexit" 2>/dev/null

#   The Line below is what gets the Codec & Resolution from a video file.
codecres="ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1"

read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null


##################################################################################################################################################
###########################  HOME LOOP START #####################################################################################################
##################################################################################################################################################

function menu {  # HOME

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                        
dirinhome="$PWD" 

#  Load directory from last exit
echo "$dirinhome" > ~/.config/videoinfox/videoinfo.home.dir

clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip  

##################################################################################################################################################
#=================================================================================================================================================
#                           @CHECK TO SEE IF THE CLIPBOARD CONTENTS CONTAIN A URL OR A FILE AND ACT UPON THAT INFORMATION
#=================================================================================================================================================
##################################################################################################################################################

# the following code over explains itself for those that want to learn step by step of how to follow the logic.


# the 2 lines of below code are creating two new variables for the following loop.
# 1st variable <$grabpaste>   <cut> is used to cut all characters after the 4th character from the variable. Only 4 chatacters are needed to look for <http>
# 2nd variable <$grabpaste2>  <cut> is used to cut all characters after the 1st character from the variable. Only 1 character is needed to look for </>  

# for main if loop - to look for <http>
grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character

# for nested if loop - to look for </>
grabpaste2=$(echo "$pasteclip" | cut -c-1)  # cut everything after the 1st character


# the following code checks to see if the clipbooard has a url in it by lookin for <http> from <$grabpaste>  If it is <http>, YT-DLP will get the clipboard
# if it isn't <http>' it continues onto the neested loop to check for </> to see if it appears to be a valid path.

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      read dirsaved < ~/.config/videoinfox/videoinfox.yt-download-dir 2> /dev/null  # reding default download directory into <$dirsaved> to display below
      echo
      echo "There is a url in the clipboard.  The only option on this screen is to Play Clipboard. That option will download"      
      echo "video with YT-DLP to your download directory. The video will be played immediately after the download is complete."
      echo
      echo "Download Directory: $dirsaved"  # dislpay default download directory
      ############################################################################################################################################
      #  Above is the display code and the following section is the action part of the process:  @PLAY CLIPBOARD                               
      #  If PLAY CLIPBOARD IS SELECTED WITH A URL                              TO FOLLOW THIS PROCESS TO THE END:      SEARCH -   @PLAY CLIPBOARD   
      ############################################################################################################################################
 else
   
      if [ "$grabpaste2" = "/" ]  # if the 1 character = </> go then
        then
            :

        else

            if [ "$pasteclip" = " " ]   # if the clipboard is empty goto then
              then 
                  :
                  #pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                  #echo
                  #echo "This is the only screen that can accept both a local file or a url from the clipboard."

              else
                  :
                  #pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
                  #echo
                  #echo " "  # the clipboard has content that doesn't start with </>

            fi
      fi
fi


echo "___________________________________________________________________________________________________________________"
echo
echo " $der >>> HOME                                                       Enter - Update Clipboard Display"
echo "___________________________________________________________________________________________________________________"
echo
echo " 1 - List Directory       4 - Video Count          p - Play Clipboard     f - FIND                       e - Exit"                     
echo " 2 - Change Directory     5 - Video Duration       s - PlayList           y - YT-DLP                     d - Set"
echo " 3 - Find Directory       6 - Enter Video File     v - Played List        x - Clear Clipboard            h - help"             
echo
echo -en " Enter Option: "
read -n1 option
}

  
while [ 1 ]
do
	menu
	case $option in


e)  # EXIT - <HOME> 
echo "$PWD" > ~/.config/videoinfox/videoinfo.dir-at-exit  # SAVE DIRECTORY AT EXIT
clear
echo -e "\n"
echo
echo "___________________________________________________________________________________________________________________"  
echo
echo " $der >>> EXIT"
echo "___________________________________________________________________________________________________________________" 
echo
echo
echo " Directory state SAVED for next run:" "$PWD"
sleep 1.5
break ;;



d)  # SETTINGS - <HOME> 
function menusettings {
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content


# LOAD STORED DIRECTORIES
read dir1 < ~/.config/videoinfox/videoinfo.tv-dir 2> /dev/null
read dir2 < ~/.config/videoinfox/videoinfo.movies-dir 2> /dev/null
read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir 2> /dev/null
read dir4 < ~/.config/videoinfox/videoinfo.parent-dir 2> /dev/null
read dir5 < ~/.config/videoinfox/videoinfo.dir-at-exit 2> /dev/null

clear
echo
echo "Directory:" "$PWD"
echo "Clipboard:" "$pasteclip"
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> SETTINGS                                                   Enter - Update Clipboard Display"
echo "___________________________________________________________________________________________________________________" 
echo
echo " Change Directory:                                                                          q - Quit"
echo
echo " 1 - TV:" "$dir1"
echo "                                                                                            v - Videoinfox update"
echo " 2 - Movies:" "$dir2"
echo "                                                                                            y - Yt-dlp update"
echo " 3 - Download:" "$dirsaved"
echo "                                                                                            d - Set Directories"
echo " 4 - Extra:" "$dir4"
echo
echo " 5 - Last Exit:" "$dir5"
echo


echo -en " Enter Option: "
read -n1 optionsettings
}

while [ 1 ]
do
menusettings
case $optionsettings in

    q)  # QUIT
    break;;
 
    1)  # CD DIRECTORY TO TV    
    cd "$dir1"
    break
    ;;
    
    2)  # CD DIRECTORY TO MOVIES
    cd "$dir2"
    break
    ;;


    3)  # CHANGE DIRECTORY TO DOWNLOADS
    cd "$dirsaved"
    break
    ;;


    4)  # CHANGE DIRECTORY TO EXTRA   
    cd "$dir4"
    break
    ;;


    5)  # CHANGE DIRECTORY TO LAST EXIT
    cd "$dir5"
    break
    ;;

    
    d)  # SET VIDEO DIRECTORIES
    function menusvd {
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    clear
    echo
    echo "Directory: "$PWD
    echo "Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________" 
    echo              
    echo " $der >>> SET DEFAULT VIDEO DIRECTORIES                                                          quit"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " 1 - TV:" "$dir1"
    echo
    echo " 2 - MOVIES:" "$dir2"
    echo
    echo " 3 - DOWNLOAD:" "$dirsaved"
    echo
    echo " 4 - EXTRA:" "$dir4"
    echo
    echo -en " Enter Option: "
    read -n1 optionsvd
    }

    
    while [ 1 ] 
    do
    menusvd
    case $optionsvd in

    q)  # QUIT
    break;;
    

    1)
    # SET TV DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    clear
    echo
    echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
    echo "Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET TV DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.tv-dir
                      read dir1 < ~/.config/videoinfox/videoinfo.tv-dir
                      echo " TV Directory Set to:" "$dir1"                  
                      else
                      echo
                      echo " error:  No such file or directory"                    
                fi
          fi       
          
          #read -p "     Press <ENTER> to Continue" 
          cd "$grabdir" # restore working directory
          sleep 1.5
          break
          ;;


    2)
    # SET MOVIES DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content 
    clear
    echo
    echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
    echo "Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo 
    echo " $ver >>> SET MOVIE DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.movies-dir
                      read dir2 < ~/.config/videoinfox/videoinfo.movies-dir
                      echo " Movie Directory Set to:" "$dir2"                  
                      else
                      echo
                      echo " error:  No such file or directory"                    
                fi
          fi       
          
          #read -p "     Press <ENTER> to Continue" 
          cd "$grabdir" # restore working directory
          sleep 1.5
          break
          ;;
           

    3)
    # SET <yt-dlp> DOWNLOAD DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    clear
    echo
    echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
    echo "Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET YT-DLP DOWNLOAD DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.yt-download-dir
                      read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir
                      echo " Download Directory Set to:" "$dirsaved"                  
                      else
                      echo
                      echo " error:  No such file or directory"                    
                fi
          fi       
          
          #read -p "     Press <ENTER> to Continue" 
          cd "$grabdir" # restore working directory
          sleep 1.5
          break
          ;;


 4)
    # SET PARENT DIRECTORY
    grabdir="$PWD"  # grab working directory 
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
    clear
    echo
    echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
    echo "Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> SET EXTRA DIRECTORY"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " No quotations needed for paths with spaces. Case sensative."
    echo
    read -r -p " Enter Directory: " specifydir2  # waiting fot user input - the directory you want to chang to 
	
	     if [ -z "$specifydir2" ]  # if no input was entered goto  <then> 
            then
                echo
                echo " error: Nothing was entered"
            else
                if [ -d "$specifydir2" ]  #  if directoty exists goto  <then>
                  then
                      echo
                      echo "$specifydir2" > ~/.config/videoinfox/videoinfo.parent-dir
                      read dir4 < ~/.config/videoinfox/videoinfo.parent-dir
                      echo " Parent Directory Set to:" "$dir4"                  
                      else
                      echo
                      echo " error:  No such file or directory"                    
                fi
          fi       
          
          #read -p "     Press <ENTER> to Continue" 
          cd "$grabdir" # restore working directory
          sleep 1.5
          break
          ;;

    
     esac
     done
     ;;

             
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    
    v)  # CHECK FOR VIDEOINFOX UPDATE
    function menuinfox {
    clear
    wget https://raw.githubusercontent.com/powerhousepro69/videoinfox/main/videoinfox -O ~/.config/videoinfox/videoinfox-fetched >/dev/null
    chmod +x ~/.config/videoinfox/videoinfox-fetched    
    clear 
    echo
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $der >>> CHECK VIDEOINFOX UPDATE"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " videoinfox Home: https://github.com/powerhousepro69/videoinfox"
    echo 
    echo " Downloaded From: https://raw.githubusercontent.com/powerhousepro69/videoinfox/main/videoinfox"
    echo
    echo
    echo " Version Check Complete"
    echo
    echo " Downloaded: "$(~/.config/videoinfox/videoinfox-fetched -v)
    echo
    echo " Installed: " "$ver" 
    echo
    echo
    echo " u - Update     d - Don't Update"  
    echo
    echo -en " Enter Option: "
    read -n1 optioninfox
    echo
    }
        
              
         while [ 1 ]
         do
         menuinfox
	    case $optioninfox in


         d)
         #  QUIT
         echo
         echo " Not Updated . . ."
         sleep .6
         break;;
      
         u)
         # UPDATE VIDEOINFOX
         echo
         sudo cp ~/.config/videoinfox/videoinfox-fetched /usr/local/bin/videoinfox 
         echo
         echo " Downnloaded videoinfox copied to: /usr/local/bin"
         echo   
        # echo " UPDATED . . ."
         
         sec=3
              while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
              echo -ne " UPDATED . . . $sec\033[0K\r"
              let " sec=sec-1"
              sleep 1
              done         

         clear
         echo -e "\n"
         echo -e "\n"
         echo "=================================================================================================================="  
         echo " $der >>> EXIT >>> Updated to: $(~/.config/videoinfox/videoinfox-fetched -v)                     Restart to use updated version."
         echo "==================================================================================================================" 
         echo -e "\n"
         echo " Directory state SAVED for next run:" "$PWD"
         sleep 1.5
         
         clear
         echo -e "\n"
         echo -e "\n"
         echo "=================================================================================================================="  
         echo " $der >>> EXIT >>> Updated to: $(~/.config/videoinfox/videoinfox-fetched -v)                     Restart to use updated version."
         echo "==================================================================================================================" 
         echo -e "\n"
         exit 
         ;;

          
         esac
         done
         ;;



#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        
         y)  # CHECK FOR YT-DLP UPDATE
         function chkytdlp {
         clear
wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O ~/.config/videoinfox/yt-dlp-fetched >/dev/null  # download <yt-dlp> from github
         chmod a+rx ~/.config/videoinfox/yt-dlp-fetched  # set <yt-dlp-fetched> execute bit
         clear 
         echo
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " $der >>> CHECK YT-DLP UPDATE"
         echo "___________________________________________________________________________________________________________________"
         echo
         echo " ytdlp Home: https://github.com/yt-dlp/yt-dlp"
         echo
         echo " Downloaded From: https://github.com/yt-dlp/yt-dlp/releases/latest/download"
         echo
         echo
         echo " Version Check Complete"
         echo
         echo " Downloaded:" $(~/.config/videoinfox/yt-dlp-fetched --version)
         echo
         echo " Installed: " $(~/.config/videoinfox/yt-dlp --version)
         echo
         echo
         echo " u - Update     d - Don't Update"  
         echo
         echo -en " Enter Option: "
         read -n1 optionytdlp
         echo
         }
        
              
         while [ 1 ]
         do
         chkytdlp
	    case $optionytdlp in


         d)
         #  QUIT
         echo
         echo " Not Updated . . ."
         sleep .7
         break;;
      
         u)
         cp ~/.config/videoinfox/yt-dlp ~/.config/videoinfox/yt-dlp-old
         cp ~/.config/videoinfox/yt-dlp-fetched ~/.config/videoinfox/yt-dlp
         ~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version
         echo
         echo " UPDATED . . ."
         sleep 1.5
         break;; 
               
         esac
         done
         ;;


esac
done
;;
    



x)  # CLEAR CLIPBOARD - <HOME> 
echo " " | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
;;

	
1)  # LIST DIRECTORY - <HOME> 
##################################################################################################################################################
###########################  HOME OPTION 1  LIST DIRECTORY  ######################################################################################
##################################################################################################################################################



#   The Line below gives a total count of all mp4, mkv, avi, & divx in Current Directory.
currentdirfilecount=$(find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" \) 2>/dev/null | wc -l)
	

if [ -f "videoinfo.List-Directory" ]  #  if file <videoinfo.List-Directory> exists goto <then>
  then
#     >>>>>>>>>>>>>>>>>>>>>>>>>> DISPLAY LAST DIRECTORY LISTING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 

      less videoinfo.List-Directory  # display in <less>
  
  else

#     >>>>>>>>>>>>>>>>>>>>>>>>>> CREATE NEW DIRECTORY LISTING FILE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   

# The group of echo's below write a header to file <videoinfo.List-Directory> 
# echo > videoinfo.List-Directory
echo "$ver                                                                                     LIST DIRECTORY" >> videoinfo.List-Directory
echo >> videoinfo.List-Directory
echo "This File was Created $(date) by" $USER >> videoinfo.List-Directory
echo >> videoinfo.List-Directory  # Every line ending in  ' >> videoinfo.List-Directory '  is writing that line to text file <videoinfo.List-Directory>)
echo "SAVED RESULTS LOADED FROM FILE: videoinfo.List-Directory" >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory
echo "Working Directory: "$PWD >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory 
echo "___________________________________________________________________________________________________________________" >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory 
echo " Up & Down Arrows or Mouse wheel - scroll                                                            Home - top" >> videoinfo.List-Directory
echo " q - quit                                                                                            End - bottom" >> videoinfo.List-Directory
echo "___________________________________________________________________________________________________________________" >> videoinfo.List-Directory       
echo >> videoinfo.List-Directory
echo  >> videoinfo.List-Directory

# Display & Write <videoinfo.List-Directory>  The Results of:  - ffprobe for Codec & Resolution <$codecres>
#                                                              - ffmpeg for Duration in (hrs:min)
for i in *.mp4  # list all <mp4> files in the current directory
do 
  echo $i;  # display <mp4> filename
  echo $i >> videoinfo.List-Directory  
  $codecres "$i"  # display <mp4> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done

for i in *.mkv  # list all <mkv> files in the current directory
do 
  echo $i  # display <mkv> filename
  echo $i >> videoinfo.List-Directory
  $codecres "$i"  # display <mkv> Codec & Resolution$
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo
  echo >> videoinfo.List-Directory
  done

for i in *.avi  # list all <avi> files in the current directory
do 
  echo $i  # display <avi> filename
  echo $i >> videoinfo.List-Directory
  $codecres "$i"  # display <avi> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory  
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done


for i in *.webm  # list all <webm> files in the current directory
do 
  echo $i  # display <avi> filename
  echo $i >> videoinfo.List-Directory
  $codecres "$i"  # display <avi> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory  
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done


for i in *.divx  # list all <divx> files in the current directory
do 
  echo $i  # display <divx> filename
  echo $i >> videoinfo.List-Directory
  $codecres "$i"  # display <divx> Codec & Resolution
  $codecres "$i" >> videoinfo.List-Directory
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # grep out duration, cut everything after "," then remove the ","
  ffmpeg -i "$i" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,// >> videoinfo.List-Directory  # writing the same thing to a file
  echo
  echo >> videoinfo.List-Directory
done
 	
# echo >> videoinfo.List-Directory
echo "Total Video Files:" $currentdirfilecount
echo >> videoinfo.List-Directory
echo "Total Video Files:" $currentdirfilecount >> videoinfo.List-Directory
echo
echo
echo >> videoinfo.List-Directory
echo ">>> Listing is not recursive <<<"
echo ">>> Listing is not recursive <<<" >> videoinfo.List-Directory
echo
echo >> videoinfo.List-Directory
echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen   
echo "Working Directory: "$PWD >> videoinfo.List-Directory
echo


if [ $currentdirfilecount = 0 ]  # if find returned no results goto <then>
  then
      :  # the colon can be used in place of a command to 'Do Nothing'
  else 
      echo "$rer"
      echo
      echo -e "\033[5mProbing $currentdirfilecount \033[5mVideo Files for Duration\033[0m"  #  file count of find results
      echo
      echo "This can take a while if there are a lot of video files to process."
      echo "You will get a GUI Notification when this process is complete."
      echo
     
      #  This is where the file <~/.config/videoinfox/videoinfo.duration.tmp> is created to store duration in seconds with the format being  (x.xxxxxx)
      #  Video files are found in current directory and processed with ffprobe and written to <~/.config/videoinfox/videoinfo.duration.tmp>. 
find . -maxdepth 1 -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" \) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \; > ~/.config/videoinfox/videoinfo.duration.tmp 2>/dev/null

      #  ffprobe outputs video duration in seconds 6 places past the decimal point.
      #  bash can't do floating point math.  So  <bc>  is needed first to get sum of   <~/.config/videoinfox/videoinfo.duration.tmp>
      #  The  <paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp>  puts a +  between each line of the file and  <bc>  gives you the sum. 
      floatingseconds=$(paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp | bc)
         
      #  The total in seconds <$floatingseconds> is taken from line above and the format needs changed from  (x.xxxxxx) to (x)
      #  Below, <awk> is stripping 7 characters in from the right of the sum of  <$floatingseconds>
      #  In this case, the decimal point and the 6 trailing numbers are stripped from the string.
      totalseconds=$(echo $floatingseconds | awk '{ print substr( $0, 1, length($0)-7 ) }')
        
      #  Calculation of  <$totalseconds>  into different formats.
      secs=$(echo $totalseconds)  # $totalseconds variable stored in $secs variable
      totalminutes=$(($(($totalseconds/60))))  # total minutes calculation

      echo >> videoinfo.List-Directory
      echo >> videoinfo.List-Directory
      echo "Seconds"
      echo "Seconds" >> videoinfo.List-Directory
      echo $totalseconds  # display total seconds
      echo $totalseconds >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory 
      echo "Minutes"
      echo "Minutes" >> videoinfo.List-Directory
      echo $totalminutes  # display total minutes
      echo $totalminutes >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo "Hrs:Mi:Sec"
      echo "Hrs:Mi:Sec" >> videoinfo.List-Directory
      printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60))  # calculation to display hours, minutes and seconds
      printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60)) >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo "Days     Hrs:Min:Sec"
      echo "Days     Hrs:Min:Sec" >> videoinfo.List-Directory
      printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60))  # same as above except Days are added
      printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      echo -e "\033[5mNEW RESULTS LOADED \033[5m \033[0m(use Mouse Wheel to Scroll)"
      echo "EXISTING RESULTS LOADED FROM FILE videoinfo.List-Directory " $(stat -c %y "videoinfo.List-Directory") >> videoinfo.List-Directory
      echo >> videoinfo.List-Directory
      echo
      echo >> videoinfo.List-Directory
      notify-send "Videoinfox is done processing: List Directory" "$PWD"  # GUI Notification is displayed when this function <option 1> has completed.
      # The file  <~/.config/videoinfox/videoinfo.duration.tmp>  was created for <ffprobe> to store video duration in seconds of all find results.
      # The math was already performed on this file and it is no longer needed.  So it is being removed.  
      rm ~/.config/videoinfox/videoinfo.duration.tmp
   fi
fi



# Everytime You Save.  The File <videoinfo.List-Directory> is written to the directory that option 1 was run in.
function menu1 {

clear
less videoinfo.List-Directory  # view results from file
echo
echo " Directory: "$PWD
echo "___________________________________________________________________________________________________________________"
echo
echo " $der >>> LIST DIRECTORY"                                                  
echo "___________________________________________________________________________________________________________________"
echo
echo " Save or Delete Directory Listing"
echo
echo " s - Save     d - Delete"  
echo 
echo -en " Enter Option: "
read -n1 option1
echo
}

while [ 1 ]
do
	menu1
	case $option1 in
	
    s) 
    echo
    echo " Results SAVED . . ."
    echo 
    #read -p "Press <ENTER> to Continue"
    sleep .75
    break;; 
        
    d) 
    rm videoinfo.List-Directory
    echo
    echo " Results DELETED . . ."
    echo 
    #read -p "Press <ENTER> to Continue"    
    sleep .75
    break;;
          
        esac
        done
        ;;


2)
##################################################################################################################################################
###########################  HOME OPTION 2  CHANGE DIRECTORY  ####################################################################################
##################################################################################################################################################

##############xmodmap -e 'keycode 55=v'  #  enable v key 

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"
echo
echo " $ver >>> CHANGE DIRECTORY"
echo "___________________________________________________________________________________________________________________"
echo
echo " No quotations needed for paths with spaces. Case sensative."
echo 
read -r -p " Enter Directory: " specifydir  # waiting fot user input - the directory you want to chang to 
	
	if [ -z "$specifydir" ]  # if no input was entered goto  <then> 
          then
               echo
               echo " error: Nothing was entered"
               sleep .75
          else
              if [ -d "$specifydir" ]  #  if directoty exists goto  <then>
                then
                     echo
                     cd "$specifydir"  # change the directory
                     echo " Working Driectory changed to: $PWD"  # <pwd>  print current working directory to the screen
                     sleep 1.5                   
                else
                     echo
                     echo " error:  No such file or directory"
                     sleep 1.5                   
          fi
    fi       
echo
#read -p "     Press <ENTER> to Continue" 
;;
	

3)	 
##################################################################################################################################################
###########################  HOME OPTION 3  FIND DIRECTORY  ######################################################################################
##################################################################################################################################################

pasteclip=$(xclip -o -selection clipboard > /dev/null)  # grab clipboard content
clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"
echo  
echo " $ver >>> FIND DIRECTORY                                                                wildcard * ok"
echo "___________________________________________________________________________________________________________________" 
echo
read -r -p " Directory Name: " dirfind  # waiting fot user input - dierectory that you want to find
findmeadir=$(find . -type d -iname "$dirfind" 2>/dev/null | wc -l)   # number of files found
       
                                                                                   	
	if [ -z "$dirfind" ]  # if no input was entered goto  <then>  
          then
               echo
               echo " error: Nothing was entered"  
               sleep .75  # EXIT THIS LOOP
          else
               
               
               if echo "$dirfind" | grep "/" > /dev/null 2>/dev/null  # if any slashes were entered goto <then>
                 then
                      echo
                      echo " error: No slashes directory name only"
                      sleep .75  # EXIT THIS LOOP  
                 else
                      echo
		             find . -type d -iname "$dirfind" 2>/dev/null  # directory(s) found   
	                  echo
	                  echo " Total Directories Found:" $findmeadir  # number of files found
	  
	              
	             if [ $findmeadir = 0 ]  # if find returned no results goto <then>
	               then
	                   sleep .75
                        :  # the colon can be used in place of a command to 'Do Nothing'  Exit this nested loop
	               else 	                    
                        pastetemp=$(xclip -o -selection clipboard 2>/dev/null)  # perserve clipboard content prioir to runnin this function
                        notify-send "Videoinfox is done processing: Find Directory" "Total Directories Found: $findmeadir" # GUI Notification.
                        echo       
	                   echo " Chang the directory: Copy 1 line (including the dot) to the Clipboard then press <ENTER>"
                        echo     		                
                        echo " Stay in current directory: <ENTER> without copy."
		              read -p " "
		              pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
                        cd "$pasteclip" 2>/dev/null
                        echo " Working Driectory: $PWD"  # <pwd>  print current working directory to the screen 
                        echo $pastetemp | xclip -sel clip 2>/dev/null  #  reload clipboard content prior to running this function
                        pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
                        sleep 1.5            
        fi
        fi
        fi              
echo

#read -p "Press <ENTER> to Continue"              

;;


4)
##################################################################################################################################################
###########################  HOME OPTION  4  VIDEO COUNT  ########################################################################################
##################################################################################################################################################


clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"
echo  
echo " $der >>> VIDEO COUNT - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo " RECURSIVE COUNT OF VIDEO FILES"
echo
mp4count=$(find . -type f \( -iname "*.mp4" \) 2>/dev/null | wc -l)  # total number of <mp4> files found
echo " MP4   = " $mp4count
mkvcount=$(find . -type f \( -iname "*.mkv" \) 2>/dev/null | wc -l)  # total number of <mkv> files found
echo " MKV   = " $mkvcount
avicount=$(find . -type f \( -iname "*.avi" \) 2>/dev/null | wc -l)  # total number of <avi> files found
echo " AVI   = " $avicount
avicount=$(find . -type f \( -iname "*.webm" \) 2>/dev/null | wc -l)  # total number of <webm files found
echo " WEBM  = " $webmcount
divxcount=$(find . -type f \( -iname "*.divx" \) 2>/dev/null | wc -l)  # total number of <divx> files found
echo " DIVX  = " $divxcount
echo "------------------"
totalcount=$(($mp4count + $mkvcount + $avicount + $webmcount + $divxcount))  # calcutation for Sum of All 4 file types
echo " TOTAL = " $totalcount  # display Sum
# GUI Notification is displayed when this function <option 6> has completed. 
notify-send  "Videoinfox is done processing Video File Count " "Total Video Files located in $PWD : $totalcount"
echo
read -p " Press <ENTER> to Continue" 
;;
	

5)
##################################################################################################################################################
###########################  HOME OPTION  5  VIDEO DURATION  #####################################################################################
##################################################################################################################################################

if [ -f "videoinfo.Video-Duration" ]  #  if <videoinfo.Video-Durationy> exists goto <then>
  then
#     >>>>>>>>>>>>>>>>>>>>>>>>>> DISPLAY Saved RESULTS >>>>>>>>>>>>>>>>>>>>>>>>>> 
      cat videoinfo.Video-Duration
  else
#     >>>>>>>>>>>>>>>>>>>>>>>>>> CREATE NEW RESULTS >>>>>>>>>>>>>>>>>>>>>>>>>>
#   The Line below gives a total count of all mp4, mkv, avi, & divx Recursively.
alldirfilecount=$(find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -name "*.webm" -o -iname "*.divx" \) 2>/dev/null | wc -l)

#  The group of echo's below write a header to file <videoinfo.Video-Duration> 
echo > videoinfo.Video-Duration
echo "$ver                                                                                               VIDEO DURATION" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
echo "This File was Created $(date) by" $USER >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration  # Every line ending in  ' >> videoinfo.Video-Duration '  is writing that line to text file <videoinfo.Video-Duration>

#  The rest of this function Writes the Results to the Screen and File <videoinfo.Video-Duration>
clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"  
echo
echo " $der >>> VIDEO DURATION - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo "Working Directory: "$PWD >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
echo "RECURSIVE DURATION OF VIDEO FILES"
echo "RECURSIVE DURATION OF $alldirfilecount VIDEO FILES" >> videoinfo.Video-Duration
echo
echo "This can take a while if there are a lot of video files to process."
echo "You will get a GUI Notification when this process is complete."
echo
echo -e "\033[5mProbing $alldirfilecount \033[5mVideo Files for Duration\033[0m"  #  file count of find results
echo -e "\n"
echo >> videoinfo.Video-Duration


#  This is where the file <~/.config/videoinfox/videoinfo.duration.tmp> is created to store duration in seconds with the format being  (x.xxxxxx)
#  Video files are found recursively and processed with ffprobe and written to <~/.config/videoinfox/videoinfo.duration.tmp>. 
find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "*.divx" \) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \; > ~/.config/videoinfox/videoinfo.duration.tmp 2>/dev/null


#  ffprobe outputs video duration in seconds 6 places past the decimal point.
#  bash can't do floating point math.  So  <bc>  is needed first to get sum of  <~/.config/videoinfox/videoinfo.duration.tmp>
#  The  <paste -sd+ ~/.config/videoinfox/videoinfo.duration.tmp>  puts a +  between each line of the file and  <bc>  gives you the sum. 
floatingseconds=$(paste -sd+  ~/.config/videoinfox/videoinfo.duration.tmp | bc)


#  The total in seconds is taken from line above and the format needs changed from  (x.xxxxxx) to (x)
#  Below, <awk> is stripping 7 characters in from the right of the sum of  <$floatingseconds>
#  In this case, the decimal point and the 6 trailing numbers are stripped from the string.
totalseconds=$(echo $floatingseconds | awk '{ print substr( $0, 1, length($0)-7 ) }')

clear
echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
echo
echo "$der"
echo
echo "RECURSIVE DURATION OF VIDEO FILES"
echo
echo "DONE Probing $alldirfilecount Video Files for Duration"  #  file count of find results
echo
#  Calculation of  <$totalseconds>  into different formats.
secs=$(echo $totalseconds)
totalminutes=$(($(($totalseconds/60))))  # convert seconds into minutes

echo "Seconds"
echo "Seconds" >> videoinfo.Video-Duration
echo $totalseconds  # display total seconds
echo $totalseconds >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Minutes"
echo "Minutes" >> videoinfo.Video-Duration
echo $totalminutes  # display total minutes
echo $totalminutes >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Hrs:Mi:Sec"
echo "Hrs:Mi:Sec" >> videoinfo.Video-Duration
printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60))  # calculation to display hours, minutes and seconds
printf '%d:%d:%d\n' $((secs/3600)) $((secs%3600/60)) $((secs%60)) >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo "Days     Hrs:Min:Sec" 
echo "Days     Hrs:Min:Sec" >> videoinfo.Video-Duration
printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) # same as above + Days
printf '%d        %d:%d:%d\n' $(($secs/86400)) $(($secs%86400/3600)) $(($secs%3600/60)) $(($secs%60)) >> videoinfo.Video-Duration  
echo
echo >> videoinfo.Video-Duration
echo
echo -e "\033[5mNEW RESULTS LOADED \033[5m \033[0m"
echo "SAVED RESULTS LOADED FROM FILE: videoinfo.Video-Duration" $(stat -c %y "videoinfo.Video-Duration") >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
#echo
#echo "     q  to quit" >> videoinfo.Video-Duration
echo >> videoinfo.Video-Duration
notify-send  "Videoinfox is done processing: Video Duration" "$PWD"  # GUI Notification is displayed when this function has completed.
# The file  <~/.config/videoinfox/videoinfo.duration.tmp>  was created for <ffprobe> to store video duration in seconds of all find results.
# The math was already performed on this file and it is no longer needed.  So it is being removed.  
#rm ~/.config/videoinfox/videoinfo.duration.tmp
fi


function menu5 {
clear
cat videoinfo.Video-Duration
#echo
#echo "Directory: "$PWD
#echo "Clipboard: "$pasteclip
#echo
echo
echo "___________________________________________________________________________________________________________________" 
echo
echo " $der >>> VIDEO DURATION - Recursive"
echo "___________________________________________________________________________________________________________________" 
echo
echo " s - Save     d - Delete"  
echo 
echo -en " Enter Option: "
read -n1 option5
echo
}

while [ 1 ]
do
	menu5
	case $option5 in
	
    s) 
    echo
    echo " Results SAVED . . ."
    echo 
    #read -p "Press <ENTER> to Continue"
     .75
    break;; 
        
    d) 
    rm videoinfo.Video-Duration
    echo
    echo " Results DELETED . . ."
    echo 
    #read -p "Press <ENTER> to Continue"    
    sleep .75
    break;;
         esac
         done
         ;;


6)
##################################################################################################################################################
###########################  HOME OPTION 6  ENTER VIDEO FILE  ####################################################################################
##################################################################################################################################################

clear
echo
echo "Directory: "$PWD
echo "Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"
echo
echo " $ver >>> ENTER VIDEO FILE - For Info"
echo "___________________________________________________________________________________________________________________"
echo
echo " Full path needed. No quotations needed for paths or files with spaces. Case Sensative."
echo
read -r -p " Video File: " specifyfile  # waiting fot user input - video file to display
echo

  
 
          if [ -z "$specifyfile" ]  # if no input was entered goto  <then>
          then
              echo " error: Nothing was entered"
              sleep .7
          else  
               if [ -f "$specifyfile" ]  # if file exists goto  <then>
                then
                    #echo
          	        #echo $specifyfile  #  video file with full path is displayed
          	        #echo
echo " Video Info: "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip") "Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
                       echo
                       #echo
                       #${codecres} 2>&1 "${specifyfile}"  # codec and resolution are displayed  
                       #ffmpeg -i "$specifyfile" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//  # duration is diplayed
                       read -p " Press <ENTER> to Continue" 
                else
                       echo " error: No such file or directory"
                       sleep .7
          fi	  
          fi

echo
;;


##################################################################################################################################################
###########################  HOME OPTION  h  HELP  ###############################################################################################
##################################################################################################################################################

########## ctrl + h ########## HELP HOME
h)  
clear
less ~/.config/videoinfox/videoinfo.help  # This help file is recreated on every start
;;

        
##################################################################################################################################################
###########################  HOME OPTION  f  FIND MENU  ##########################################################################################
##################################################################################################################################################

f)
function menuf {

$videofind=0

clear
cat ~/.config/videoinfox/videoinfo.findwork
echo 

#  read last find total file count
read searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal
echo "Total files found: "$searchtotal  # number of files found

# save date and time of last find
echo $(stat -c %y ~/.config/videoinfox/videoinfo.findwork) > ~/.config/videoinfox/videoinfo.lastfindtime

# line below  strip tha last 17 characters from <stat> time of file: ~/.config/videoinfox/videoinfo.lastfindtime
cat ~/.config/videoinfox/videoinfo.lastfindtime | awk '{ print substr( $0, 1, length($0)-17 ) }' | cut -c 4- > ~/.config/videoinfox/videoinfo.time
mv ~/.config/videoinfox/videoinfo.time ~/.config/videoinfox/videoinfo.lastfindtime

echo "Found Date: "$(cat ~/.config/videoinfox/videoinfo.lastfindtime 2>/dev/null) # display last find time
echo "Found in: "$(cat ~/.config/videoinfox/videoinfo.lastfinddir 2>/dev/null) # display last directory that last find was run from
echo "Find Entry: "$(cat ~/.config/videoinfox/videoinfo.lastfindstring 2>/dev/null)  # display last find string that was used
echo
echo "Directory: "$PWD  # <pwd>  print current working directory to the screen

# LOAD STORED DIRECTORIES
read dir1 < ~/.config/videoinfox/videoinfox.tv-dir 2> /dev/null
read dir2 < ~/.config/videoinfox/videoinfox.movies-dir 2> /dev/null
read dirsaved < ~/.config/videoinfox/videoinfox.yt-download-dir 2> /dev/null
read dir4 < ~/.config/videoinfox/videoinfox.parent-dir 2> /dev/null
read dir5 < ~/.config/videoinfox/videoinfox.dir-at-exit 2> /dev/null

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content                          
echo
echo "Copy 1 above Find to the Clipboard then info or play."
echo "___________________________________________________________________________________________________________________"
echo
echo " $der >>> FIND RESULTS                                               Enter - Update Clipboard Display"
echo
echo " Clipboard: "$pasteclip
echo "___________________________________________________________________________________________________________________"
echo
echo " f - Find     p - Play Clipboard     x - Clear Clipboard                    CD: 1 2 3 4 5                 q - Quit"   
echo "              s - PlayList           C - Clear Find Results" 
echo " i - Info     v - Played List                                                                             h - Help"
echo       
echo -en " Enter Option: "
read -n1 optionf
echo
}

     while [ 1 ]
     do
     menuf
     case $optionf in

	
     q)  
     #  QUIT - <Find Menu> 
	break ;;


     1)  # CD DIRECTORY TO TV    
     cd "$dir1"
     ;;
    
     2)  # CD DIRECTORY TO MOVIES
     cd "$dir2"
     ;;


     3)  # CHANGE DIRECTORY TO DOWNLOADS
     cd "$dirsaved"
     ;;


     4)  # CHANGE DIRECTORY TO EXTRA   
     cd "$dir4"
     ;;


     5)  # CHANGE DIRECTORY TO LAST EXIT
     cd "$dir5"
     ;;


     C)  # CLEAR FIND RESULTS
     # CREATE FIND RESULT MESSAGE THAT THERE ARE NO STORED FINDS
     echo " " > ~/.config/videoinfox/videoinfo.lastsearchtotal
     echo " " > ~/.config/videoinfox/videoinfo.lastfindstring
     echo " " > ~/.config/videoinfox/videoinfo.lastfinddir

echo "                                                                                                                 " > ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork
echo "There are no stored find results. A find needs to be run to populate this screen with files.                     " >> ~/.config/videoinfox/videoinfo.findwork
echo "                                                                                                                 " >> ~/.config/videoinfox/videoinfo.findwork     
     ;;


     x) 
     #  CLEAR CLIPBOARD - <Find Menu> 
     echo " " | xclip -sel clip  # copy message in quotes to the clipboard. clearing out the clipboard
     pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     ;;
	

     h)  # TIPS - <Find Menu>
     clear
     echo
     echo "__________________________________________________________________________________________________________________"
     echo
     echo " $der >>> FIND HELP                                                             Using the wildcard *              "
     echo "__________________________________________________________________________________________________________________"
     echo "__________________________________________________________________________________________________________________"
     echo
     echo " The files you search for have to be in the path of the current directory."
     echo
     echo " Using example filename:   The Reunion Show   and what searches would find it."
     echo 
     echo " the*      would find files starting with:  the"     
     echo
     echo " *ion*     would find files with:  ion  anywhere in the file name from the beginning to the end."
     echo
     echo " *show     would find files that ended with:  show"    
     echo "__________________________________________________________________________________________________________________"
     echo
     echo " CD: 1 2 3 4 5  is for changing to a default directorty."     
     echo
     echo " <d> from the home srceen then <d> to setup default directories. Change to Default directories also in <set>"
     echo "__________________________________________________________________________________________________________________"
     echo
     read -p " Press <ENTER> to Continue"     
     ;;


    
     p) 
     #  PLAY - <Find Menu>
     pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     clear
     echo
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " $der >>> Find >>> Play Clipboard"
     echo
     echo " [PLAY]> "$pasteclip" "
     echo "___________________________________________________________________________________________________________________"
     echo
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration     
     echo
     echo
     echo " Video Player Controls:"
     echo                             
     echo " - Fullscreen Toggle: f"
     echo
     echo " - Play/Pause Toggle: space bar"
     echo
     echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
     echo
     echo " - Quit: q"      
     echo -e "\n"
     echo " This screen will exit when the video player is closed."
     echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
     ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
     echo " Video Player Closed"
     ;;

 
     i) 
     #  INFO - <Find Menu>
     pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
     echo
     echo " ""$pasteclip"
     echo    
     echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
     echo
     read -p " Press <ENTER> to Continue" 
     ;;


     v)
     #  VIEW/PLAYED LIST - <Find Menu>   
     function menuv {

##################################################################################################################################################
###########################  START ROUTINE TO SORT AND REMOVE DUPLICATES FROM  <videoinfo.playedlist>            #################################  
###########################  This routine runs when you startup Videoinfo and everytime you return to the HOME.  #################################  
##################################################################################################################################################

# sorting finds and removing duplicates
tail -n +6 ~/.config/videoinfox/videoinfo.playedlist > ~/.config/videoinfox/videoinfo.playedlist.tmp  # grab body minus header from <videoinfo.playedlist>
sort -u ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.tmp2  # sort and remove duplicates
mv ~/.config/videoinfox/videoinfo.playedlist.tmp2 ~/.config/videoinfox/videoinfo.playedlist.tmp  # copying <playedlist.tmp2> to <playedlist.tmp>

# removing all lines from the body that don't begin with  / 
sed -n '/^[/].*/p' ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.slash
mv ~/.config/videoinfox/videoinfo.playedlist.slash ~/.config/videoinfox/videoinfo.playedlist.tmp

# witing temporary header for new Played List 
echo > ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo "PLAYED LIST" >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp

# Pssting New Played List into Newly Created Header 
# PASTE FILE: ~/.config/videoinfox/videoinfo.playedlist.header.tmp  TO FILE:  <~/.config/videoinfox/videoinfo.playedlist.tmp>
# The paste result is FILE:  <~/.config/videoinfox/videoinfo.playedlist.tmp2>
cat ~/.config/videoinfox/videoinfo.playedlist.header.tmp ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.tmp2 

# RENAME FILE: <~/.config/videoinfox/videoinfo.playedlist.tmp2>  TO FILE  <~/.config/videoinfox/videoinfo.playedlist>  (also removes .tmp2)
mv ~/.config/videoinfox/videoinfo.playedlist.tmp2 ~/.config/videoinfox/videoinfo.playedlist

# Cleanup of remaining temporary files
rm ~/.config/videoinfox/videoinfo.playedlist.header.tmp
rm ~/.config/videoinfox/videoinfo.playedlist.tmp
##################################################################################################################################################
#                            END ROUTINE FOR FILE: <videoinfo.playedlist>                                                                        #
##################################################################################################################################################

     clear
     cat ~/.config/videoinfox/videoinfo.playedlist    
     pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     echo
     echo "Copy 1 above video to the Clipboard then Play."
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " $der >>> PLAYED LIST                                                Enter - Update Clipboard Display"
     echo
     echo " Clipboard: "$pasteclip
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " p - Play     D - Delete Played List                                                                      q - Quit"  
     echo
     echo " i - Info"
     echo
     echo -en " Enter Option: "
     read -n1 optionv
     echo
     }

        while [ 1 ]
        do
	    menuv
	    case $optionv in
    
        q)  # QUIT
        break;;

       
        i) 
          #  INFO - SAVED FINDS <Find Menu>
          pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
          echo
          echo " ""$pasteclip"
          echo    
          echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
          echo
          read -p " Press <ENTER> to Continue" 
          ;;
        
        
        p)  # PLAY
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        clear
        echo
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " $der >>> FIND >> PLAYED LIST - Play Clipboard" 
        echo
        echo " [PLAY]> "$pasteclip" "
        echo "___________________________________________________________________________________________________________________"
        echo
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
        echo
        echo
        echo " Video Player Controls:"
        echo                             
        echo " - Fullscreen Toggle: f"
        echo
        echo " - Play/Pause Toggle: space bar"
        echo
        echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
        echo
        echo " - Quit: q"      
        echo -e "\n"
        echo " This screen will exit when the video player is closed."
        echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
        ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
        echo " Played List Closed"
        ;;


        D)  # DELETE PLAYED LIST - <find menu>
        rm ~/.config/videoinfox/videoinfo.playedlist
        # writing header for new Played List because new file wouldn't be created until return to main HOME
        echo > ~/.config/videoinfox/videoinfo.playedlist
        echo "PLAYED LIST" >> ~/.config/videoinfox/videoinfo.playedlist
        echo >> ~/.config/videoinfox/videoinfo.playedlist
        echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.playedlist
        echo >> ~/.config/videoinfox/videoinfo.playedlist      
        echo
        echo " Played List DELETED . . ."
        echo
        #read -p " Press <ENTER> to Continue"    
        sleep .7
        ;;

          esac
          done
          ;; 


          s) ################  VIEW/PLAYED SAVED FINDS - <Find Menu>  ########################## 
        
          function menus {
          clear    
          cat $HOME/.config/videoinfox/videoinfo.keptsearch  # view played list file
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipbiard content
        
          echo
          echo "Select a Video: Copy 1 above video to the clipboard then Play."
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> PLAYLIST                                                   Enter - Update Clipboard Display"
          echo
          echo " Clipboard: "$pasteclip
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " p - Play Clipboard     a - Add     D - Delete Playlist                                                   q - Quit"  
          echo
          echo " i - Info "
          echo
          echo -en " Enter Option: "
          read -n1 options
          echo
          }

                    
          while [ 1 ]
          do
          menus
	     case $options in


          q)
          #  QUIT - <Find Menu>
          clear
          break;;
 

           i) 
          #  INFO - SAVED FINDS <Find Menu>
          pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
          echo
          echo " ""$pasteclip"
          echo    
          echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
          echo
          read -p " Press <ENTER> to Continue" 
          ;;

         
          p) 
          #  PLAY - <Find Menu>
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
          echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
          clear
          echo
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> FIND >>> PLAYLIST - Play Clipboard" 
          echo
          echo " [PLAY]> "$pasteclip" "
          echo "___________________________________________________________________________________________________________________"        
          echo
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
          echo
          echo
          echo " Video Player Controls:"
          echo                             
          echo " - Fullscreen Toggle: f"
          echo
          echo " - Play/Pause Toggle: space bar"
          echo
          echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
          echo
          echo " - Quit: q"      
          echo -e "\n"
          echo " This screen will exit when the video player is closed."
          echo
          ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
          echo "     Played List Closed"
          ;;


         a)  ################  ADD TO SAVED FINDS - <Find Menu>  ################
        
          #  When grabbing more than 1 line from the Clipboard. All the results paste in as 1 line with a space in between each result.
          #  <sed> puts each result on its own line with a comma at the end of each line.
          sed "s/$/,/g" ~/.config/videoinfox/videoinfo.findwork > ~/.config/videoinfox/videoinfo.findwork2
          cat ~/.config/videoinfox/videoinfo.findwork2
          echo " " | xclip -sel clip  # clearing the clipboard before entering add to playlist

          
          function menua {
          clear
          pasteclip=$(xclip -o -selection clipboard >/dev/null)  # grab clipboard content
          cat ~/.config/videoinfox/videoinfo.findwork2
          echo
          echo "Save multiple finds results from: $(cat ~/.config/videoinfox/videoinfo.lastfindtime)"
          echo
          echo "Copy 1 or more above lines to the Clipboard. Then Add to Playlist"                               
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> ADD TO PLAYLIST                                                 Quit to go back to Playlist"   
          echo "___________________________________________________________________________________________________________________"
          echo       
          echo " a - Add to Playlist                                                                                      q - quit"  
          echo
          echo -en " Enter Option: "
          read -n1 optiona
          echo
          }
 

          while [ 1 ]
          do
	      menua                                        
	      case $optiona in


          a)  # add finds to saved finds     
          
          echo > ~/.config/videoinfox/videoinfo.tmp  # creating temporary file for the final outputfile: <~videoinfo.keptsearch> 
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
          echo $pasteclip >> ~/.config/videoinfox/videoinfo.tmp  # pasting your clipboard coppy to file: <videoinfo.tmp>
cat ~/.config/videoinfox/videoinfo.tmp | tr , "\n" | sort > ~/.config/videoinfox/videoinfo.tmp2  # sort from one line to multiple line & remove comma
          
          sed -i '/./,$!d' ~/.config/videoinfox/videoinfo.tmp2 # remove empty lines at the top of the file: <videoinfo.tmp2> and write changes
          sed -i 's/^ *//' ~/.config/videoinfox/videoinfo.tmp2 # remove 1st white space at beginng of every populated line

          cat ~/.config/videoinfox/videoinfo.tmp2 >> ~/.config/videoinfox/videoinfo.keptsearch
          rm ~/.config/videoinfox/videoinfo.tmp
          rm ~/.config/videoinfox/videoinfo.tmp2
 
          echo " " | xclip -sel clip  # clearing the clipboard
          echo
          echo " Clpboard content added to playlist"
          echo
          echo " Clipboard Cleared"
          sleep .7
          
##################################################################################################################################################
###########################  START ROUTINE TO SORT AND REMOVE DUPLICATES FROM  <videoinfo.keptsearch>            #################################  
###########################                                                                                      #################################
##################################################################################################################################################

# removing duplicates
tail -n +6 ~/.config/videoinfox/videoinfo.keptsearch > ~/.config/videoinfox/videoinfo.keptsearch.tmp  # grab body minus header from <videoinfo.keptsearch>
# sort -u ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.tmp2  # sort and remove duplicates
cat -n ~/.config/videoinfox/videoinfo.keptsearch.tmp | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfo.keptsearch.tmp2  # remove duplicates
mv ~/.config/videoinfox/videoinfo.keptsearch.tmp2 ~/.config/videoinfox/videoinfo.keptsearch.tmp  # copying <keptsearch.tmp2> to <keptsearch.tmp>

# removing all lines from the body that don't begin with  /  
sed -n '/^[/].*/p' ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.slash
cp ~/.config/videoinfox/videoinfo.keptsearch.slash ~/.config/videoinfox/videoinfo.keptsearch.tmp

# witing temporary header for new Played List 
echo > ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo "PLAYLIST" >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp

# Pssting New Played List into Newly Created Header 
# PASTE FILE: ~/.config/videoinfox/videoinfo.keptsearch.header.tmp  TO FILE:  <~/.config/videoinfox/videoinfo.keptsearch.tmp>
# The paste result is FILE:  <~/.config/videoinfox/videoinfo.keptsearch.tmp2>
cat ~/.config/videoinfox/videoinfo.keptsearch.header.tmp ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.tmp2 

# RENAME FILE: <~/.config/videoinfox/videoinfo.keptsearch.tmp2>  TO FILE  <~/.config/videoinfox/videoinfo.keptsearch>  (also removes .tmp2)
mv ~/.config/videoinfox/videoinfo.keptsearch.tmp2 ~/.config/videoinfox/videoinfo.keptsearch

# Cleanup of remaining temporary files
rm ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
rm ~/.config/videoinfox/videoinfo.keptsearch.tmp
#####################################################################################################################################################
#                            END ROUTINE FOR FILE: <videoinfo.keptsearch>                                                                           #
#####################################################################################################################################################

          ;;          
            


          q) 
          echo
          break;;

               esac
               done
               ;;


          D)  ################  DELETE SAVED FINDS  ##############################
     
           # Writing header for new Saved Search because new file wouldn't be created until return to main HOME         
           rm ~/.config/videoinfox/videoinfo.keptsearch         
           echo > ~/.config/videoinfox/videoinfo.keptsearch
           echo "PLAYlIST" >> ~/.config/videoinfox/videoinfo.keptsearch
           echo >> ~/.config/videoinfox/videoinfo.keptsearch
           echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.keptsearch
           echo >> ~/.config/videoinfox/videoinfo.keptsearch
           echo
           echo " Playlist DELETED . . . "
           # read -p " Press <ENTER> to Continue"
           sleep .7      
           ;;   
              esac
              done
              ;; 
        
    
##################################################################################################################################################
    f)  ################  FIND ROUTINE - <Find Menu>  ############################################################################################
##################################################################################################################################################

    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

    clear
    echo "Working Directory: "$PWD  # <pwd>  print current working directory to the screen 
    echo "Clipboard Content: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $ver >>> Find Video File - Recursive                                                   wildcard * ok"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " Find a video file to Play and/or get Info on.  No file extensions." 
    echo
    read -r -p " File Name: " videofind  # waiting fot user input - video file that you want to find

    searchtotal=$(find "$PWD" -type f \( -iname "$videofind.mp4" -o -iname "$videofind.mkv" -o -iname "$videofind.avi" -o -iname "$videofind.webm" -o -iname "$videofind.divx" \) 2>/dev/null | wc -l)    
                                                                                                  	
    if [ -z "$videofind" ]  # if no input was entered goto  <then>  
          then
               echo
               echo " error: Nothing was entered."
               echo
               sleep .7        
          else
                
              if echo "$videofind" | grep "/" > /dev/null  # if any slashehes were entered goto <then>
                then
                    echo
                    echo " error: No directories only filenames."
                    echo
                    sleep .7 
                else
                                
                     if [ $searchtotal = 0 ]  # if find returned no results goto <then>
      
                       then
                           cp ~/.config/videoinfox/videoinfo.findwork3 ~/.config/videoinfox/videoinfo.findwork
                           cp ~/.config/videoinfox/videoinfo.lastsearchtotal2  ~/.config/videoinfox/videoinfo.lastsearchtotal
                           echo
                           echo " No files found"
                           echo
                           sleep .7 
                          
                       else
                           echo "$videofind" > ~/.config/videoinfox/videoinfo.lastfindstring   # save last find string used
                           # save find results
find "$PWD" -type f \( -iname "$videofind.mp4" -o -iname "$videofind.mkv" -o -iname "$videofind.avi" -o -iname "$videofind.webm" -o -iname "$videofind.divx" \) > ~/.config/videoinfox/videoinfo.findwork
                           echo "$PWD" > ~/.config/videoinfox/videoinfo.lastfinddir  # save last directory that last find was run in 
                           # write last search total file count
                           echo $searchtotal > ~/.config/videoinfox/videoinfo.lastsearchtotal
                           # read last search total file count
                           read searchtotal < ~/.config/videoinfox/videoinfo.lastsearchtotal    
                           cp ~/.config/videoinfox/videoinfo.findwork ~/.config/videoinfox/videoinfo.findwork3
                           cp ~/.config/videoinfox/videoinfo.lastsearchtotal ~/.config/videoinfox/videoinfo.lastsearchtotal2                 
                           echo
                           echo " Total files found: " $searchtotal  # number of files found
                           notify-send  "Videoinfox is done processing: Find Video(s)" "$PWD: $searchtotal Video Files"
                           sleep 1.5
    fi
    fi              
    fi
    ;;


# END FIND MENU LOOP   
*)
esac
done
;;


p)
##################################################################################################################################################
###########################  HOME  p  @PLAY CLIPBOARD  ###########################################################################################
###########################  Home is the only screen that that can accept Video Files and URL Links from the Clipboard   #########################
##################################################################################################################################################

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      #  DOWNLOAD AND PLAY FILE if <$grabpaste> ONLY IF IT =  http        
   
      #  DOWNLOAD LINK AND PLAY FILE #   play last download routine grabbed from <YT-DLP MENU>
      grabdir="$PWD"  # storing directory to restore at the end of this function
        
      #  DOWNLOAD LINK AND PLAY
      pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
      clear
      #~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s.%(id)s.%(ext)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload
      ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload 
      ~/.config/videoinfox/yt-dlp -F "$pasteclip"
              
      echo
      echo "Find what video quality and format you want. (Code on far left)"
      read -p "Enter that Code and Press <ENTER> : " svrcode
      echo
      ~/.config/videoinfox/yt-dlp -f "$svrcode" "$pasteclip"
      echo
      notify-send "Videoinfox messsage: YT-DLP is done . . ." "$pasteclip"
      sleep 3.3

      # PLAY DOWNLOADED FILE
      read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
      cd "$dirsaved"  # change to download directory

      read lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download video file

      ytdlplast=$(find "$PWD" -type f \( -iname "$lastdownload*" \))
      #echo "ytdlplast" > ~/.config/videoinfox/videoinfo.zzz

      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " $der >>> Play Last Download"
      echo
      echo " [PLAY]> "$ytdlplast""
      echo "___________________________________________________________________________________________________________________"         
      echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will exit when the video player is closed."
      echo
      echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List File  
      ffplay -fs &> /dev/null "$ytdlplast"  
      cd "$grabdir"  # restore dir prior to entering yt-dlp menu


  else
      
      #  PLAY FILE if <$grabpaste> WAS ANYTHING BUT <HTTP> 
      clear
      echo
      echo "___________________________________________________________________________________________________________________"
      echo
      echo " $der >>> HOME >>> PLAY CLIPBOARD" 
      echo
      echo " [PLAY]> "$pasteclip" "
      echo "___________________________________________________________________________________________________________________"
      echo

      echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
      echo
      echo
      echo " Video Player Controls:"
      echo                             
      echo " - Fullscreen Toggle: f"
      echo
      echo " - Play/Pause Toggle: space bar"
      echo
      echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
      echo
      echo " - Quit: q"      
      echo -e "\n"
      echo " This screen will exit when the video player is closed."
      echo
      #read -p " Press <ENTER> to Continue"
      
      echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
      ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
      echo " Played List Closed"
     
  fi
  ;;  


v)
##################################################################################################################################################
###########################  HOME OPTION  v  VIEW/PLAY PLAYED LIST  ##############################################################################
##################################################################################################################################################
   
    function menuv0 {
    pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

##################################################################################################################################################
###########################  START ROUTINE TO SORT AND REMOVE DUPLICATES FROM  <videoinfo.playedlist>            #################################  
###########################  This routine runs when you startup Videoinfo and everytime you return to the HOME.  #################################  
##################################################################################################################################################

# sorting finds and removing duplicates
tail -n +6 ~/.config/videoinfox/videoinfo.playedlist > ~/.config/videoinfox/videoinfo.playedlist.tmp  # grab body minus header from <videoinfo.playedlist>
sort -u ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.tmp2  # sort and remove duplicates
mv ~/.config/videoinfox/videoinfo.playedlist.tmp2 ~/.config/videoinfox/videoinfo.playedlist.tmp  # copying <playedlist.tmp2> to <playedlist.tmp>

# removing all lines from the body that don't begin with  /  
sed -n '/^[/].*/p' ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.slash
mv ~/.config/videoinfox/videoinfo.playedlist.slash ~/.config/videoinfox/videoinfo.playedlist.tmp

# witing temporary header for new Played List 
echo > ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo "PLAYED LIST" >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp
echo >> ~/.config/videoinfox/videoinfo.playedlist.header.tmp

# Pssting New Played List into Newly Created Header 
# PASTE FILE: ~/.config/videoinfox/videoinfo.playedlist.header.tmp  TO FILE:  <~/.config/videoinfox/videoinfo.playedlist.tmp>
# The paste result is FILE:  <~/.config/videoinfox/videoinfo.playedlist.tmp2>
cat ~/.config/videoinfox/videoinfo.playedlist.header.tmp ~/.config/videoinfox/videoinfo.playedlist.tmp > ~/.config/videoinfox/videoinfo.playedlist.tmp2 

# RENAME FILE: <~/.config/videoinfox/videoinfo.playedlist.tmp2>  TO FILE  <~/.config/videoinfox/videoinfo.playedlist>  (also removes .tmp2)
mv ~/.config/videoinfox/videoinfo.playedlist.tmp2 ~/.config/videoinfox/videoinfo.playedlist

# Cleanup of remaining temporary files
rm ~/.config/videoinfox/videoinfo.playedlist.header.tmp
rm ~/.config/videoinfox/videoinfo.playedlist.tmp
##################################################################################################################################################
#                            END ROUTINE FOR FILE: <videoinfo.playedlist>                                                                        #
##################################################################################################################################################

    clear  
    cat ~/.config/videoinfox/videoinfo.playedlist  
    echo  
    echo "Copy 1 above video to the Clipboard then Play."
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " $der >>> PLAYED LIST                                                Enter - Update Clipboard Display"
    echo
    echo " Clipboard: "$pasteclip
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " p - Play     D - Delete Played List                                                                      q - Quit"  
    echo
    echo " i - Info"
    echo
    echo -en " Enter Option: "
    read -n1 optionv0
    echo
    }


        while [ 1 ]
        do
	    menuv0
	    case $optionv0 in
    
        q)  # QUIT
        break;;

        i) 
        #  INFO
        pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
        echo
        echo " ""$pasteclip"
        echo    
        echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
        echo
              read -p " Press <ENTER> to Continue" 
              ;;    


        p)  # PLAY
        pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
        clear
        echo
        echo "___________________________________________________________________________________________________________________"
        echo
        echo " $der >>> HOME >>> PLAYED LIST" 
        echo
        echo " [PLAY]> "$pasteclip" "
        echo "___________________________________________________________________________________________________________________"
        echo
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
        echo
        echo
        echo " Video Player Controls:"
        echo                             
        echo " - Fullscreen Toggle: f"
        echo
        echo " - Play/Pause Toggle: space bar"
        echo
        echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
        echo
        echo " - Quit: q"      
        echo -e "\n"
        echo " This screen will exit when the video player is closed."
        echo
        echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
        ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
        echo " Played List Closed"
        ;;


        D)  # DELETE PLAYED LIST
        rm ~/.config/videoinfox/videoinfo.playedlist
        # writing header for new Played List because new file wouldn't be created until return to main HOME
        echo > ~/.config/videoinfox/videoinfo.playedlist
        echo "PLAYED LIST" >> ~/.config/videoinfox/videoinfo.playedlist
        echo >> ~/.config/videoinfox/videoinfo.playedlist
        echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.playedlist
        echo >> ~/.config/videoinfox/videoinfo.playedlist
        echo
        echo " Played List DELETED . . ."
        echo
        #read -p " Press <ENTER> to Continue"    
        sleep .7
        ;;

          esac
          done
          ;; 


##################################################################################################################################################
###########################  HOME OPTION  s  VIEW/PLAY SAVED FINDS  ##############################################################################
##################################################################################################################################################


s) ################  VIEW/PLAYED SAVED FINDS - <HOME>  ########################## 

          function menus {          
          
          clear
          cat $HOME/.config/videoinfox/videoinfo.keptsearch  # view played list file
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content    
          echo
          echo "Select a Video: Copy 1 above video to the clipboard then Play."
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> PLAYLIST                                                   Enter - Update Clipboard Display"
          echo
          echo " Clipboard: "$pasteclip
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " p - Play Clipboard     a - Add     D - Delete Playlist                                                   q - Quit"  
          echo
          echo " i - Info"
          echo
          echo -en " Enter Option: "
          read -n1 options
          echo
          }


          while [ 1 ]
          do
          menus
	     case $options in


          q)
          #  QUIT - <HOME>
          clear
          break;;
 

          p) 
          #  PLAY CLIPBOARD - <HOME>
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
          echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to Played List file
          clear
          echo
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> HOME >>> PLAYLIST - Play Video" 
          echo
          echo " [PLAY]> "$pasteclip" "
          echo "___________________________________________________________________________________________________________________"
          echo
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
          echo
          echo
          echo " Video Player Controls:"
          echo                             
          echo " - Fullscreen Toggle: f"
          echo
          echo " - Play/Pause Toggle: space bar"
          echo
          echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
          echo
          echo " - Quit: q"      
          echo -e "\n"
          echo " This screen will exit when the video player is closed."
          echo
          ffplay -fs "$pasteclip" 2>/dev/null  # play video in clipboard
          echo "     Played List Closed"
          ;;


          i) 
          #  INFO - SAVED FINDS <HOME>
          pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
          echo
          echo " ""$pasteclip"
          echo    
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
          echo
          read -p " Press <ENTER> to Continue" 
          ;;


          a)  ################  ADD TO SAVED FINDS - <HOME>  ################
        
          #  When grabbing more than 1 line from the Clipboard. All the results paste in as 1 line with a space in between each result.
          #  <sed> puts each result on its own line with a comma at the end of each line.
          sed "s/$/,/g" ~/.config/videoinfox/videoinfo.findwork > ~/.config/videoinfox/videoinfo.findwork2
          cat ~/.config/videoinfox/videoinfo.findwork2
          echo " " | xclip -sel clip  # clearing the clipboard before enterind add to playlist

          function menua {
          clear
          pasteclip=$(xclip -o -selection clipboard >/dev/null)  # grab clipboard content
          cat ~/.config/videoinfox/videoinfo.findwork2
          echo
          echo "Save Multiple finds from: $(cat ~/.config/videoinfox/videoinfo.lastfindtime)"
          echo   
          echo "Copy 1 or more above lines to the Clipboard. Then Add to Playlist"
          echo "___________________________________________________________________________________________________________________"
          echo
          echo " $der >>> ADD TO PLAYLIST                                              Quit to go back to Playlist"   
          echo "___________________________________________________________________________________________________________________"
          echo       
          echo " a - Add to Playlist                                                                                      q - quit"  
          echo
          echo -en " Enter Option: "
          read -n1 optiona
          echo
          }
 

          while [ 1 ]
          do
	     menua                                        
	     case $optiona in


          a)  # add finds to saved finds  
          
          echo > ~/.config/videoinfox/videoinfo.tmp  # creating temporary file for the final outputfile: <~videoinfo.keptsearch> 
          pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
          echo $pasteclip >> ~/.config/videoinfox/videoinfo.tmp  # pasting your clipboard coppy to file: <videoinfo.tmp>
cat ~/.config/videoinfox/videoinfo.tmp | tr , "\n" | sort > ~/.config/videoinfox/videoinfo.tmp2  # sort from one line to multiple line & remove comma
          
          sed -i '/./,$!d' ~/.config/videoinfox/videoinfo.tmp2 # remove empty lines at the top of the file: <videoinfo.tmp2> and write changes
          sed -i 's/^ *//' ~/.config/videoinfox/videoinfo.tmp2 # remove 1st white space at beginng of every populated line

          cat ~/.config/videoinfox/videoinfo.tmp2 >> ~/.config/videoinfox/videoinfo.keptsearch
          rm ~/.config/videoinfox/videoinfo.tmp
          rm ~/.config/videoinfox/videoinfo.tmp2
 
          echo " " | xclip -sel clip  # clearing the clipboard
          echo
          echo " Clpboard content added to playlist"
          echo
          echo " Clipboard Cleared"
          sleep .7
          
##################################################################################################################################################
###########################  START ROUTINE TO SORT AND REMOVE DUPLICATES FROM  <videoinfo.keptsearch>            #################################  
###########################                                                                                      #################################
##################################################################################################################################################

# removing duplicates
tail -n +6 ~/.config/videoinfox/videoinfo.keptsearch > ~/.config/videoinfox/videoinfo.keptsearch.tmp  # grab body minus header from <videoinfo.keptsearch>
# sort -u ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.tmp2  # sort and remove duplicates
cat -n ~/.config/videoinfox/videoinfo.keptsearch.tmp | sort -uk2 | sort -n | cut -f2- > ~/.config/videoinfox/videoinfo.keptsearch.tmp2  # remove duplicates
mv ~/.config/videoinfox/videoinfo.keptsearch.tmp2 ~/.config/videoinfox/videoinfo.keptsearch.tmp  # copying <keptsearch.tmp2> to <keptsearch.tmp>

# removing all lines from the body that don't begin with  /  
sed -n '/^[/].*/p' ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.slash
cp ~/.config/videoinfox/videoinfo.keptsearch.slash ~/.config/videoinfox/videoinfo.keptsearch.tmp

# witing temporary header for new Played List 
echo > ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo "PLAYLIST" >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
echo >> ~/.config/videoinfox/videoinfo.keptsearch.header.tmp

# Pssting New Played List into Newly Created Header 
# PASTE FILE: ~/.config/videoinfox/videoinfo.keptsearch.header.tmp  TO FILE:  <~/.config/videoinfox/videoinfo.keptsearch.tmp>
# The paste result is FILE:  <~/.config/videoinfox/videoinfo.keptsearch.tmp2>
cat ~/.config/videoinfox/videoinfo.keptsearch.header.tmp ~/.config/videoinfox/videoinfo.keptsearch.tmp > ~/.config/videoinfox/videoinfo.keptsearch.tmp2 

# RENAME FILE: <~/.config/videoinfox/videoinfo.keptsearch.tmp2>  TO FILE  <~/.config/videoinfox/videoinfo.keptsearch>  (also removes .tmp2)
mv ~/.config/videoinfox/videoinfo.keptsearch.tmp2 ~/.config/videoinfox/videoinfo.keptsearch

# Cleanup of remaining temporary files
rm ~/.config/videoinfox/videoinfo.keptsearch.header.tmp
rm ~/.config/videoinfox/videoinfo.keptsearch.tmp
#####################################################################################################################################################
#                            END ROUTINE FOR FILE: <videoinfo.keptsearch>                                                                           #
#####################################################################################################################################################

          ;;          

            

          q) 
          echo
          break;;

               esac
               done
               ;;


          D)  ################  DELETE SAVED FINDS  ##############################
     
           # Writing header for new Saved Search because new file wouldn't be created until return to main HOME         
           rm ~/.config/videoinfox/videoinfo.keptsearch         
           echo > ~/.config/videoinfox/videoinfo.keptsearch
           echo "PLAYLIST" >> ~/.config/videoinfox/videoinfo.keptsearch
           echo >> ~/.config/videoinfox/videoinfo.keptsearch
           echo "This File was Created: $(date) by" $USER >> ~/.config/videoinfox/videoinfo.keptsearch
           echo >> ~/.config/videoinfox/videoinfo.keptsearch
           echo
           echo " Playlist DELETED . . . "
           echo
           # read -p " Press <ENTER> to Continue"
           sleep .7      
           ;; 

              esac
              done
              ;; 


##################################################################################################################################################
###########################  HOME OPTION  y  Yt-dlp Menu  ########################################################################################
##################################################################################################################################################

y)       

grabdir="$PWD"  # grab working directory
pasteclip3=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content to restore to before this function was run


if ! command -v ~/.config/videoinfox/yt-dlp &> /dev/null  # if <yt-dlp> isnt found goto then

then
    clear
    wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O ~/.config/videoinfox/yt-dlp &> /dev/null # download <yt-dlp> from github
    chmod a+rx ~/.config/videoinfox/yt-dlp  # set <yt-dlp> execute bit
    ~/.config/videoinfox/yt-dlp --version > ~/.config/videoinfox/videoinfo.yt-dlp.version
    #  the file: <yt-dlp> can be copied to </usr/local/bin> to be in your path"
    clear
    echo
    echo "___________________________________________________________________________________________________________________"
    echo  
    echo " $ver >>> Downloaded: yt-dlp"
    echo "___________________________________________________________________________________________________________________"
    echo
    echo " ytdlp Home: https://github.com/yt-dlp/yt-dlp"
    echo
    echo " Downloaded From: https://github.com/yt-dlp/yt-dlp/releases/latest/download"
    echo
    echo
    echo " Version:" $(~/.config/videoinfox/yt-dlp --version)
    echo
    echo " Location: $HOME/.config/videoinfox"
    echo
    echo
    echo " Select YT-DLP again to see options"   
    echo 
    read -p " Press <ENTER> to Continue"



else  # IF YT-DLP IS FOUOND

read ytdlpver < ~/.config/videoinfox/videoinfo.yt-dlp.version

function menuy {


read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir
cd "$dirsaved"

pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content

clear
echo
echo "Directory: $PWD"
echo "Clipboard:" "$pasteclip"
echo
echo "Download Directory:" "$dirsaved"

grabpaste=$(echo "$pasteclip" | cut -c-4)   # cut everything after the 4th character
# itf the clipboard contents don't sart with <hppt> show message below
if [ "$grabpaste" = "http" ]  # if the 4 characters = <http> go then
  then
      :
  else 
  echo
  echo "This screen only accepts urls from the clipboard."
fi

# echo "This screen only accepts urls from the clipboard."
echo "___________________________________________________________________________________________________________________"
echo
echo " $der >>> YT-DLP MENU           yt-dlp Version: $ytdlpver           Enter - Update Clipboard Display"
echo "___________________________________________________________________________________________________________________"
echo
echo " d - Download Video         p - Play Video (download, watch, delete)                                      q - Quit"
echo " v - View Downloads"
echo " l - Play Last Download"
echo
echo -en " Enter Option: "                             
read -n1 optiony
}


     while [ 1 ]
     do
     menuy
	case $optiony in


     q)  # QUIT
     clear
     break;;


     v)  # VIEW DOWNLOADS
          
     pasteclip2=$(xclip -o -selection clipboard)  # grab clipboard content to save clipboard state
     
     echo " " | xclip -sel clip  # clearing the clipboard
          
     function menuyt {  # LIST ALL VIDEO FILES RECURSIVELY IN THE DEFAULT DOWNLOAD DIRECTORY 

# below was the method i used for this functions before switching to find   
# echo " " > ~/.config/videoinfox/videoinfo.viewdownloads
# ls "$PWD/"*.mp4 >> ~/.config/videoinfox/videoinfo.viewdownloads
# ls "$PWD/"*.mkv >> ~/.config/videoinfox/videoinfo.viewdownloads
# ls "$PWD/"*.avi >> ~/.config/videoinfox/videoinfo.
# ls "$PWD/"*.webm >> ~/.config/videoinfox/videoinfo.viewdownloads
# ls "$PWD/"*.divx >> ~/.config/videoinfox/videoinfo.viewdownloads
# sed -i '/ls: cannot access/d' ~/.config/videoinfox/videoinfo.viewdownloads  # removing file type(s) not found errors (remove beinnging of line pattern)

# Find video files.
find "$PWD" -type f \( -iname "*.mp4" -o -iname ".mkv" -o -iname "*.avi" -o -iname "*.webm" -o -iname "$videofind.divx" \) > ~/.config/videoinfox/videoinfo.view-downloads

#tac ~/.config/videoinfox/videoinfo.viewdownloads >  ~/.config/videoinfox/videoinfo.viewdownloads.tmp
#mv ~/.config/videoinfox/videoinfo.viewdownloads.tmp ~/.config/videoinfox/videoinfo.viewdownloads


     clear
     cat ~/.config/videoinfox/videoinfo.view-downloads
     pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
     echo
     echo "Copy 1 above video to the clipboard then Play."
     echo    
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " $der >>> VIEW DOWNLOADS                                             Enter - Update Clipboard Display"
     echo
     echo " Clipboard:" "$pasteclip"
     echo "___________________________________________________________________________________________________________________"
     echo
     echo " p - Play                                                                                                 q - Quit"  
     echo
     echo " i - Info"
     echo
     echo -en " Enter Option: "
     read -n1 optionyt
     echo
     }
        
                  
              while [ 1 ]
              do
              menuyt
	         case $optionyt in


              q)
              #  QUIT
              break;;
     

              i) 
              #  INFO
              pasteclip=$(xclip -o -selection clipboard 2>/dev/null)  # grab clipboard content
              echo
              echo " ""$pasteclip"
              echo    
              echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration
              echo
              read -p " Press <ENTER> to Continue" 
              ;;


              p)  # PLAY DOWNLOAD DIRECTORY
              clear
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " $der >>>  YT-DLP MENU >>> VIEW DOWNLOADS - Play Video"
              echo
              echo " [PLAY]> "$pasteclip" "
              echo "___________________________________________________________________________________________________________________"
              echo

echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$pasteclip")  " Duration:" $(ffmpeg -i "$pasteclip" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration      
              echo
              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will exit when the video player is closed."
              echo
              echo $pasteclip >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to file
              ffplay -fs &> /dev/null "$pasteclip"
              echo
              ;; 
                esac
                done  
                
              echo "$pasteclip2" | xclip -sel clip  #  load clipboard state before entering this function
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              ;;


              p)  # PLAY VIDEO THEN DELETE 
              clear
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " $der >>> YT-DLP MENU >>> Play Video (download, watch, delete)"
              echo
              echo " [PLAY]> $pasteclip"
              echo "___________________________________________________________________________________________________________________"         
              echo
              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will exit when the video player is closed."
              echo
     
              ~/.config/videoinfox/yt-dlp $pasteclip -o $dirsaved/download.tmp  # downloading temporary video
              notify-send "Videoinfox messsage: YT-DLP is done . . ." "$pasteclip"  
              
              ffplay -fs &> /dev/null $dirsaved/download.tmp*  # play temporary video
              rm $dirsaved/download.tmp*  # on player close, delete temporary video
              ;; 


              l)  # play last download
              grabdir="$PWD"  # storing directory to restore at the end of this function
               
              read dirsaved < ~/.config/videoinfox/videoinfo.yt-download-dir  # reading download directory 
              cd "$dirsaved"  # change to download directory

              read lastdownload < ~/.config/videoinfox/videoinfo.lastdownload  # reading last download video file

              ytdlplast=$(find "$PWD" -type f \( -iname "$lastdownload*" \))


              clear
              echo
              echo "___________________________________________________________________________________________________________________"
              echo
              echo " $der >>> Play Last Download"
              echo
              echo " [PLAY]> "$ytdlplast""
              echo "___________________________________________________________________________________________________________________"         
              echo
              
echo " "$(ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 "$ytdlplast")  " Duration:" $(ffmpeg -i "$ytdlplast" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//)  # codec, width, height and duration

              echo
              echo " Video Player Controls:"
              echo                             
              echo " - Fullscreen Toggle: f"
              echo
              echo " - Play/Pause Toggle: space bar"
              echo
              echo " - Back/Fwd: Left/Right Arrows (tap or hold down)"
              echo
              echo " - Quit: q"      
              echo -e "\n"
              echo " This screen will exit when the video player is closed."
              echo
           
              echo "$ytdlplast" >> ~/.config/videoinfox/videoinfo.playedlist  # write clipboard content to file  
              ffplay -fs &> /dev/null "$ytdlplast"  
              cd "$grabdir"  # restore dir prior to entering yt-dlp menu
              ;;  


              d)  # DOWNLOAD LINK
              pasteclip=$(xclip -o -selection clipboard 2> /dev/null)  # grab clipboard content
              echo
              echo
              
              # <yt-dlp> gets the filename before downloading and writes it to a file
              ~/.config/videoinfox/yt-dlp --get-filename -o "%(title)s" "$pasteclip" > ~/.config/videoinfox/videoinfo.lastdownload
 
              # <yt-dlp> giving options for quality and file type to download
              ~/.config/videoinfox/yt-dlp -F "$pasteclip"
              
              echo
              echo
              echo "Find what video quality and format you want. (Code on far left)"
              read -p "Enter that Code and Press <ENTER> : " svrcode
              echo
              ~/.config/videoinfox/yt-dlp -f "$svrcode" "$pasteclip"
              echo
              #echo "YT-DLP Done . . ."
              notify-send "Videoinfox messsage: YT-DLP is done . . ." "$pasteclip"
              
              sec=3
          
              while [ $sec -ge 0 ]; do  #  This pauses the execution.  It displays and counts down the seconds set in <$sec>
                                
                   echo -ne ""YT-DLP Done . . . " $sec\033[0K\r"
                   let "sec=sec-1"
                   sleep 1
              done      
              ;; 


 esac
     done

    
fi

# echo "$pasteclip3" | xclip -sel clip  #  load clipboard state before entering this function
cd "$grabdir"  # restore dir prior to entering yt-dlp menu
;;   # grabdir="$PWD"


##################################################################################################################################################
###########################  END MAIN LOOP  ######################################################################################################
##################################################################################################################################################

	*)
	clear
	#echo "Invalid selection";;
	esac
    #echo    
    #read -p "     <ENTER>  to continue . . . . ."
done


#  EXIT MESSAGE
clear
echo -e "\n"
echo
echo "___________________________________________________________________________________________________________________"
echo  
echo " $ver >>> EXIT"
echo "___________________________________________________________________________________________________________________" 
echo -e "\n"



# Error: target STRING not available is an xclip error


#   FYI :

#   The Line Below performs a Recursive Search and outputs ffprobe's Duration of every find in seconds format (x.xxxxxx).
#   find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname ".avi" -o -iname "*.divx"\) -exec ffprobe -show_entries format=duration -v quiet -of csv="p=0" {} \;

#   The Line Below performs a Recursive Search and outputs Video File Count.
#   find . -type f \( -iname "*.mp4" -o -iname "*.mkv" -o -iname "*.avi" -o -iname "*.divx" \) | wc -l

#   The Line Below gets the Codec & Resolution from a video file.
#   NOTE : Do NOT include  <  >   around the filename. 
#   ffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 -select_streams v:0 -show_entries stream=width,height -of default=nw=1 <filename>

#   The Line Below gets the Duration from video file and dsiplays in  <Days:Hours:Minutes:Seconds>
#   NOTE :  Save Double Quotes around the filename. 
#   ffmpeg -i "filename" 2>&1 | grep Duration | cut -d ' ' -f 4 | sed s/,//
#
